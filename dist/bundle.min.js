!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("crypto"),require("buffer"),require("fs"),require("path"),require("util"),require("events"),require("stream"),require("http"),require("url"),require("https"),require("zlib")):"function"==typeof define&&define.amd?define(["crypto","buffer","fs","path","util","events","stream","http","url","https","zlib"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).nearContractParser=t(e.require$$0$2,e.require$$0$3,e.require$$0$4,e.require$$1$1,e.require$$2$2,e.require$$0$5,e.Stream$1,e.http,e.Url,e.https,e.zlib)}(this,function(require$$0$2,require$$0$3,require$$0$4,require$$1$1,require$$2$2,require$$0$5,Stream$1,http,Url,https,zlib){"use strict";function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var require$$0__default=_interopDefaultLegacy(require$$0$2),require$$0__default$1=_interopDefaultLegacy(require$$0$3),require$$0__default$2=_interopDefaultLegacy(require$$0$4),require$$1__default=_interopDefaultLegacy(require$$1$1),require$$2__default=_interopDefaultLegacy(require$$2$2),require$$0__default$3=_interopDefaultLegacy(require$$0$5),Stream__default=_interopDefaultLegacy(Stream$1),http__default=_interopDefaultLegacy(http),Url__default=_interopDefaultLegacy(Url),https__default=_interopDefaultLegacy(https),zlib__default=_interopDefaultLegacy(zlib),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(r){if(r.__esModule)return r;var n=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(r).forEach(function(e){var t=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(n,e,t.get?t:{enumerable:!0,get:function(){return r[e]}})}),n}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var lib$2={},key_stores={},keystore={};Object.defineProperty(keystore,"__esModule",{value:!0}),keystore.KeyStore=void 0;class KeyStore{}keystore.KeyStore=KeyStore;var in_memory_key_store={},key_pair={},naclFast={exports:{}},serialize$1=(!function(e){function L(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function o(e,t,r,n,o){for(var i=0,a=0;a<o;a++)i|=e[t+a]^r[n+a];return(1&i-1>>>8)-1}function K(e,t,r,n){return o(e,t,r,n,16)}function u(e,t,r,n){return o(e,t,r,n,32)}function h(e,t,r,n){for(var o,i=255&(n=n)[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,l=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,t=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,p=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,m=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,y=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,g=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,r=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,n=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=i,b=a,v=s,w=c,E=u,A=l,S=h,M=d,T=f,I=t,k=p,R=m,x=y,C=g,N=r,P=n,O=0;O<20;O+=2)_^=(o=(x^=(o=(T^=(o=(E^=(o=_+x|0)<<7|o>>>25)+_|0)<<9|o>>>23)+E|0)<<13|o>>>19)+T|0)<<18|o>>>14,A^=(o=(b^=(o=(C^=(o=(I^=(o=A+b|0)<<7|o>>>25)+A|0)<<9|o>>>23)+I|0)<<13|o>>>19)+C|0)<<18|o>>>14,k^=(o=(S^=(o=(v^=(o=(N^=(o=k+S|0)<<7|o>>>25)+k|0)<<9|o>>>23)+N|0)<<13|o>>>19)+v|0)<<18|o>>>14,P^=(o=(R^=(o=(M^=(o=(w^=(o=P+R|0)<<7|o>>>25)+P|0)<<9|o>>>23)+w|0)<<13|o>>>19)+M|0)<<18|o>>>14,_^=(o=(w^=(o=(v^=(o=(b^=(o=_+w|0)<<7|o>>>25)+_|0)<<9|o>>>23)+b|0)<<13|o>>>19)+v|0)<<18|o>>>14,A^=(o=(E^=(o=(M^=(o=(S^=(o=A+E|0)<<7|o>>>25)+A|0)<<9|o>>>23)+S|0)<<13|o>>>19)+M|0)<<18|o>>>14,k^=(o=(I^=(o=(T^=(o=(R^=(o=k+I|0)<<7|o>>>25)+k|0)<<9|o>>>23)+R|0)<<13|o>>>19)+T|0)<<18|o>>>14,P^=(o=(N^=(o=(C^=(o=(x^=(o=P+N|0)<<7|o>>>25)+P|0)<<9|o>>>23)+x|0)<<13|o>>>19)+C|0)<<18|o>>>14;b=b+a|0,v=v+s|0,w=w+c|0,E=E+u|0,A=A+l|0,S=S+h|0,M=M+d|0,T=T+f|0,I=I+t|0,k=k+p|0,R=R+m|0,x=x+y|0,C=C+g|0,N=N+r|0,P=P+n|0,e[0]=(_=_+i|0)>>>0&255,e[1]=_>>>8&255,e[2]=_>>>16&255,e[3]=_>>>24&255,e[4]=b>>>0&255,e[5]=b>>>8&255,e[6]=b>>>16&255,e[7]=b>>>24&255,e[8]=v>>>0&255,e[9]=v>>>8&255,e[10]=v>>>16&255,e[11]=v>>>24&255,e[12]=w>>>0&255,e[13]=w>>>8&255,e[14]=w>>>16&255,e[15]=w>>>24&255,e[16]=E>>>0&255,e[17]=E>>>8&255,e[18]=E>>>16&255,e[19]=E>>>24&255,e[20]=A>>>0&255,e[21]=A>>>8&255,e[22]=A>>>16&255,e[23]=A>>>24&255,e[24]=S>>>0&255,e[25]=S>>>8&255,e[26]=S>>>16&255,e[27]=S>>>24&255,e[28]=M>>>0&255,e[29]=M>>>8&255,e[30]=M>>>16&255,e[31]=M>>>24&255,e[32]=T>>>0&255,e[33]=T>>>8&255,e[34]=T>>>16&255,e[35]=T>>>24&255,e[36]=I>>>0&255,e[37]=I>>>8&255,e[38]=I>>>16&255,e[39]=I>>>24&255,e[40]=k>>>0&255,e[41]=k>>>8&255,e[42]=k>>>16&255,e[43]=k>>>24&255,e[44]=R>>>0&255,e[45]=R>>>8&255,e[46]=R>>>16&255,e[47]=R>>>24&255,e[48]=x>>>0&255,e[49]=x>>>8&255,e[50]=x>>>16&255,e[51]=x>>>24&255,e[52]=C>>>0&255,e[53]=C>>>8&255,e[54]=C>>>16&255,e[55]=C>>>24&255,e[56]=N>>>0&255,e[57]=N>>>8&255,e[58]=N>>>16&255,e[59]=N>>>24&255,e[60]=P>>>0&255,e[61]=P>>>8&255,e[62]=P>>>16&255,e[63]=P>>>24&255}function l(e,t,r,n){for(var o,i=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,l=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,m=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,y=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,g=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,_=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,v=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,w=0;w<20;w+=2)i^=(o=(g^=(o=(f^=(o=(u^=(o=i+g|0)<<7|o>>>25)+i|0)<<9|o>>>23)+u|0)<<13|o>>>19)+f|0)<<18|o>>>14,l^=(o=(a^=(o=(_^=(o=(p^=(o=l+a|0)<<7|o>>>25)+l|0)<<9|o>>>23)+p|0)<<13|o>>>19)+_|0)<<18|o>>>14,m^=(o=(h^=(o=(s^=(o=(b^=(o=m+h|0)<<7|o>>>25)+m|0)<<9|o>>>23)+b|0)<<13|o>>>19)+s|0)<<18|o>>>14,v^=(o=(y^=(o=(d^=(o=(c^=(o=v+y|0)<<7|o>>>25)+v|0)<<9|o>>>23)+c|0)<<13|o>>>19)+d|0)<<18|o>>>14,i^=(o=(c^=(o=(s^=(o=(a^=(o=i+c|0)<<7|o>>>25)+i|0)<<9|o>>>23)+a|0)<<13|o>>>19)+s|0)<<18|o>>>14,l^=(o=(u^=(o=(d^=(o=(h^=(o=l+u|0)<<7|o>>>25)+l|0)<<9|o>>>23)+h|0)<<13|o>>>19)+d|0)<<18|o>>>14,m^=(o=(p^=(o=(f^=(o=(y^=(o=m+p|0)<<7|o>>>25)+m|0)<<9|o>>>23)+y|0)<<13|o>>>19)+f|0)<<18|o>>>14,v^=(o=(b^=(o=(_^=(o=(g^=(o=v+b|0)<<7|o>>>25)+v|0)<<9|o>>>23)+g|0)<<13|o>>>19)+_|0)<<18|o>>>14;e[0]=i>>>0&255,e[1]=i>>>8&255,e[2]=i>>>16&255,e[3]=i>>>24&255,e[4]=l>>>0&255,e[5]=l>>>8&255,e[6]=l>>>16&255,e[7]=l>>>24&255,e[8]=m>>>0&255,e[9]=m>>>8&255,e[10]=m>>>16&255,e[11]=m>>>24&255,e[12]=v>>>0&255,e[13]=v>>>8&255,e[14]=v>>>16&255,e[15]=v>>>24&255,e[16]=h>>>0&255,e[17]=h>>>8&255,e[18]=h>>>16&255,e[19]=h>>>24&255,e[20]=d>>>0&255,e[21]=d>>>8&255,e[22]=d>>>16&255,e[23]=d>>>24&255,e[24]=f>>>0&255,e[25]=f>>>8&255,e[26]=f>>>16&255,e[27]=f>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}function F(e,t,r,n,o,i,a){for(var s,c=new Uint8Array(16),u=new Uint8Array(64),l=0;l<16;l++)c[l]=0;for(l=0;l<8;l++)c[l]=i[l];for(;64<=o;){for(h(u,c,a,$),l=0;l<64;l++)e[t+l]=r[n+l]^u[l];for(s=1,l=8;l<16;l++)s=s+(255&c[l])|0,c[l]=255&s,s>>>=8;o-=64,t+=64,n+=64}if(0<o)for(h(u,c,a,$),l=0;l<o;l++)e[t+l]=r[n+l]^u[l];return 0}function D(e,t,r,n,o){for(var i,a=new Uint8Array(16),s=new Uint8Array(64),c=0;c<16;c++)a[c]=0;for(c=0;c<8;c++)a[c]=n[c];for(;64<=r;){for(h(s,a,o,$),c=0;c<64;c++)e[t+c]=s[c];for(i=1,c=8;c<16;c++)i=i+(255&a[c])|0,a[c]=255&i,i>>>=8;r-=64,t+=64}if(0<r)for(h(s,a,o,$),c=0;c<r;c++)e[t+c]=s[c];return 0}function H(e,t,r,n,o){for(var i=new Uint8Array(32),a=(l(i,n,o,$),new Uint8Array(8)),s=0;s<8;s++)a[s]=n[s+16];return D(e,t,r,a,i)}function s(e,t,r,n,o,i,a){for(var s=new Uint8Array(32),c=(l(s,i,a,$),new Uint8Array(8)),u=0;u<8;u++)c[u]=i[u+16];return F(e,t,r,n,o,c,s)}function c(e,t,r,n,o,i){i=new B(i);return i.update(r,n,o),i.finish(e,t),0}function q(e,t,r,n,o,i){var a=new Uint8Array(16);return c(a,0,r,n,o,i),K(e,t,a,0)}function a(e,t,r,n,o){var i;if(r<32)return-1;for(s(e,0,t,0,r,n,o),c(e,16,e,32,r-32,e),i=0;i<16;i++)e[i]=0;return 0}function d(e,t,r,n,o){var i,a=new Uint8Array(32);if(r<32)return-1;if(H(a,0,32,n,o),0!==q(t,16,t,32,r-32,a))return-1;for(s(e,0,t,0,r,n,o),i=0;i<32;i++)e[i]=0;return 0}function f(e,t){for(var r=0;r<16;r++)e[r]=0|t[r]}function p(e){for(var t,r=1,n=0;n<16;n++)t=e[n]+r+65535,r=Math.floor(t/65536),e[n]=t-65536*r;e[0]+=r-1+37*(r-1)}function m(e,t,r){for(var n,o=~(r-1),i=0;i<16;i++)n=o&(e[i]^t[i]),e[i]^=n,t[i]^=n}function y(e,t){for(var r,n,o=C(),i=C(),a=0;a<16;a++)i[a]=t[a];for(p(i),p(i),p(i),r=0;r<2;r++){for(o[0]=i[0]-65517,a=1;a<15;a++)o[a]=i[a]-65535-(o[a-1]>>16&1),o[a-1]&=65535;o[15]=i[15]-32767-(o[14]>>16&1),n=o[15]>>16&1,o[14]&=65535,m(i,o,1-n)}for(a=0;a<16;a++)e[2*a]=255&i[a],e[2*a+1]=i[a]>>8}function G(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return y(r,e),y(n,t),u(r,0,n,0)}function z(e){var t=new Uint8Array(32);return y(t,e),1&t[0]}function g(e,t){for(var r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function _(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function b(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function v(e,t,r){var B=0,j=0,U=0,L=0,n=0,o=0,i=0,a=0,s=0,c=0,u=0,l=0,h=0,d=0,f=0,p=0,m=0,y=0,g=0,_=0,b=0,K=0,F=0,D=0,H=0,q=0,G=0,z=0,W=0,X=0,J=0,v=r[0],w=r[1],E=r[2],A=r[3],S=r[4],M=r[5],T=r[6],I=r[7],k=r[8],R=r[9],x=r[10],C=r[11],N=r[12],P=r[13],O=r[14],r=r[15],$=t[0];B+=$*v,U+=$*E,L+=$*A,n+=$*S,o+=$*M,i+=$*T,a+=$*I,s+=$*k,c+=$*R,u+=$*x,l+=$*C,h+=$*N,d+=$*P,f+=$*O,p+=$*r,j=0+$*w+($=t[1])*v,L+=$*E,n+=$*A,o+=$*S,i+=$*M,a+=$*T,s+=$*I,c+=$*k,u+=$*R,l+=$*x,h+=$*C,d+=$*N,f+=$*P,p+=$*O,m+=$*r,U=U+$*w+($=t[2])*v,n+=$*E,o+=$*A,i+=$*S,a+=$*M,s+=$*T,c+=$*I,u+=$*k,l+=$*R,h+=$*x,d+=$*C,f+=$*N,p+=$*P,m+=$*O,y+=$*r,L=L+$*w+($=t[3])*v,o+=$*E,i+=$*A,a+=$*S,s+=$*M,c+=$*T,u+=$*I,l+=$*k,h+=$*R,d+=$*x,f+=$*C,p+=$*N,m+=$*P,y+=$*O,g+=$*r,n=n+$*w+($=t[4])*v,i+=$*E,a+=$*A,s+=$*S,c+=$*M,u+=$*T,l+=$*I,h+=$*k,d+=$*R,f+=$*x,p+=$*C,m+=$*N,y+=$*P,g+=$*O,_+=$*r,o=o+$*w+($=t[5])*v,a+=$*E,s+=$*A,c+=$*S,u+=$*M,l+=$*T,h+=$*I,d+=$*k,f+=$*R,p+=$*x,m+=$*C,y+=$*N,g+=$*P,_+=$*O,b+=$*r,i=i+$*w+($=t[6])*v,s+=$*E,c+=$*A,u+=$*S,l+=$*M,h+=$*T,d+=$*I,f+=$*k,p+=$*R,m+=$*x,y+=$*C,g+=$*N,_+=$*P,b+=$*O,K+=$*r,a=a+$*w+($=t[7])*v,c+=$*E,u+=$*A,l+=$*S,h+=$*M,d+=$*T,f+=$*I,p+=$*k,m+=$*R,y+=$*x,g+=$*C,_+=$*N,b+=$*P,K+=$*O,F+=$*r,s=s+$*w+($=t[8])*v,u+=$*E,l+=$*A,h+=$*S,d+=$*M,f+=$*T,p+=$*I,m+=$*k,y+=$*R,g+=$*x,_+=$*C,b+=$*N,K+=$*P,F+=$*O,D+=$*r,c=c+$*w+($=t[9])*v,l+=$*E,h+=$*A,d+=$*S,f+=$*M,p+=$*T,m+=$*I,y+=$*k,g+=$*R,_+=$*x,b+=$*C,K+=$*N,F+=$*P,D+=$*O,H+=$*r,u=u+$*w+($=t[10])*v,h+=$*E,d+=$*A,f+=$*S,p+=$*M,m+=$*T,y+=$*I,g+=$*k,_+=$*R,b+=$*x,K+=$*C,F+=$*N,D+=$*P,H+=$*O,q+=$*r,l=l+$*w+($=t[11])*v,d+=$*E,f+=$*A,p+=$*S,m+=$*M,y+=$*T,g+=$*I,_+=$*k,b+=$*R,K+=$*x,F+=$*C,D+=$*N,H+=$*P,q+=$*O,G+=$*r,h=h+$*w+($=t[12])*v,f+=$*E,p+=$*A,m+=$*S,y+=$*M,g+=$*T,_+=$*I,b+=$*k,K+=$*R,F+=$*x,D+=$*C,H+=$*N,q+=$*P,G+=$*O,z+=$*r,d=d+$*w+($=t[13])*v,p+=$*E,m+=$*A,y+=$*S,g+=$*M,_+=$*T,b+=$*I,K+=$*k,F+=$*R,D+=$*x,H+=$*C,q+=$*N,G+=$*P,z+=$*O,W+=$*r,f=f+$*w+($=t[14])*v,m+=$*E,y+=$*A,g+=$*S,_+=$*M,b+=$*T,K+=$*I,F+=$*k,D+=$*R,H+=$*x,q+=$*C,G+=$*N,z+=$*P,W+=$*O,X+=$*r,p=p+$*w+($=t[15])*v,j+=38*(y+=$*E),U+=38*(g+=$*A),L+=38*(_+=$*S),n+=38*(b+=$*M),o+=38*(K+=$*T),i+=38*(F+=$*I),a+=38*(D+=$*k),s+=38*(H+=$*R),c+=38*(q+=$*x),u+=38*(G+=$*C),l+=38*(z+=$*N),h+=38*(W+=$*P),d+=38*(X+=$*O),f+=38*(J+=$*r),B=($=1+(B+=38*(m+=$*w))+65535)-65536*(t=Math.floor($/65536)),j=($=j+t+65535)-65536*(t=Math.floor($/65536)),U=($=U+t+65535)-65536*(t=Math.floor($/65536)),L=($=L+t+65535)-65536*(t=Math.floor($/65536)),n=($=n+t+65535)-65536*(t=Math.floor($/65536)),o=($=o+t+65535)-65536*(t=Math.floor($/65536)),i=($=i+t+65535)-65536*(t=Math.floor($/65536)),a=($=a+t+65535)-65536*(t=Math.floor($/65536)),s=($=s+t+65535)-65536*(t=Math.floor($/65536)),c=($=c+t+65535)-65536*(t=Math.floor($/65536)),u=($=u+t+65535)-65536*(t=Math.floor($/65536)),l=($=l+t+65535)-65536*(t=Math.floor($/65536)),h=($=h+t+65535)-65536*(t=Math.floor($/65536)),d=($=d+t+65535)-65536*(t=Math.floor($/65536)),f=($=f+t+65535)-65536*(t=Math.floor($/65536)),p=($=p+t+65535)-65536*(t=Math.floor($/65536)),B+=t-1+37*(t-1),B=($=1+B+65535)-65536*(t=Math.floor($/65536)),j=($=j+t+65535)-65536*(t=Math.floor($/65536)),U=($=U+t+65535)-65536*(t=Math.floor($/65536)),L=($=L+t+65535)-65536*(t=Math.floor($/65536)),n=($=n+t+65535)-65536*(t=Math.floor($/65536)),o=($=o+t+65535)-65536*(t=Math.floor($/65536)),i=($=i+t+65535)-65536*(t=Math.floor($/65536)),a=($=a+t+65535)-65536*(t=Math.floor($/65536)),s=($=s+t+65535)-65536*(t=Math.floor($/65536)),c=($=c+t+65535)-65536*(t=Math.floor($/65536)),u=($=u+t+65535)-65536*(t=Math.floor($/65536)),l=($=l+t+65535)-65536*(t=Math.floor($/65536)),h=($=h+t+65535)-65536*(t=Math.floor($/65536)),d=($=d+t+65535)-65536*(t=Math.floor($/65536)),f=($=f+t+65535)-65536*(t=Math.floor($/65536)),p=($=p+t+65535)-65536*(t=Math.floor($/65536)),e[0]=B+=t-1+37*(t-1),e[1]=j,e[2]=U,e[3]=L,e[4]=n,e[5]=o,e[6]=i,e[7]=a,e[8]=s,e[9]=c,e[10]=u,e[11]=l,e[12]=h,e[13]=d,e[14]=f,e[15]=p}function w(e,t){v(e,t,t)}function W(e,t){for(var r=C(),n=0;n<16;n++)r[n]=t[n];for(n=253;0<=n;n--)w(r,r),2!==n&&4!==n&&v(r,r,t);for(n=0;n<16;n++)e[n]=r[n]}function X(e,t){for(var r=C(),n=0;n<16;n++)r[n]=t[n];for(n=250;0<=n;n--)w(r,r),1!==n&&v(r,r,t);for(n=0;n<16;n++)e[n]=r[n]}function i(e,t,r){for(var n,o=new Uint8Array(32),i=new Float64Array(80),a=C(),s=C(),c=C(),u=C(),l=C(),h=C(),d=0;d<31;d++)o[d]=t[d];for(o[31]=127&t[31]|64,o[0]&=248,g(i,r),d=0;d<16;d++)s[d]=i[d],u[d]=a[d]=c[d]=0;for(a[0]=u[0]=1,d=254;0<=d;--d)m(a,s,n=o[d>>>3]>>>(7&d)&1),m(c,u,n),_(l,a,c),b(a,a,c),_(c,s,u),b(s,s,u),w(u,l),w(h,a),v(a,c,a),v(c,s,l),_(l,a,c),b(a,a,c),w(s,a),b(c,u,h),v(a,c,ie),_(a,a,u),v(c,c,a),v(a,u,h),v(u,s,i),w(s,l),m(a,s,n),m(c,u,n);for(d=0;d<16;d++)i[d+16]=a[d],i[d+32]=c[d],i[d+48]=s[d],i[d+64]=u[d];var r=i.subarray(32),f=i.subarray(16);return W(r,r),v(f,f,r),y(e,f),0}function r(e,t){return i(e,t,oe)}function n(e,t){return N(t,32),r(e,t)}function E(e,t,r){var n=new Uint8Array(32);return i(n,r,t),l(e,ne,n,$)}function J(e,t,r,n){for(var o,i,a,s,B,j,U,L,K,F,D,H,q,G,z,W,c,u,l,h,d,f,p,m,y,g,_=new Int32Array(16),b=new Int32Array(16),v=e[0],w=e[1],E=e[2],A=e[3],S=e[4],M=e[5],T=e[6],I=e[7],k=t[0],R=t[1],x=t[2],C=t[3],N=t[4],P=t[5],O=t[6],$=t[7],X=0;128<=n;){for(l=0;l<16;l++)_[l]=r[(h=8*l+X)+0]<<24|r[h+1]<<16|r[h+2]<<8|r[h+3],b[l]=r[h+4]<<24|r[h+5]<<16|r[h+6]<<8|r[h+7];for(l=0;l<80;l++)if(o=v,i=w,a=E,s=A,K=k,F=R,D=x,H=C,p=65535&(f=$),m=f>>>16,y=65535&(d=I),g=d>>>16,m+=(f=((q=N)>>>14|(B=S)<<18)^(N>>>18|S<<14)^(S>>>9|N<<23))>>>16,g+=(d=(S>>>14|N<<18)^(S>>>18|N<<14)^(N>>>9|S<<23))>>>16,p=p+(65535&f)+(65535&(f=N&(G=P)^~N&(z=O))),m+=f>>>16,y=y+(65535&d)+(65535&(d=S&(j=M)^~S&(U=T))),g+=d>>>16,d=fe[2*l],p+=65535&(f=fe[2*l+1]),m+=f>>>16,g+=d>>>16,y=(y+=65535&d)+(65535&(d=_[l%16]))+((m=m+((f=b[l%16])>>>16)+((p+=65535&f)>>>16))>>>16),p=65535&(f=u=65535&p|m<<16),m=f>>>16,y=65535&(d=c=65535&y|(g=g+(d>>>16)+(y>>>16))<<16),g=d>>>16,p+=65535&(f=(k>>>28|v<<4)^(v>>>2|k<<30)^(v>>>7|k<<25)),g+=(d=(v>>>28|k<<4)^(k>>>2|v<<30)^(k>>>7|v<<25))>>>16,L=65535&(y=(y+=65535&d)+(65535&(d=v&w^v&E^w&E))+((m=(m+=f>>>16)+((f=k&R^k&x^R&x)>>>16)+((p+=65535&f)>>>16))>>>16))|(g=g+(d>>>16)+(y>>>16))<<16,W=65535&p|m<<16,p=65535&(f=H),g=(d=s)>>>16,w=o,E=i,A=a,S=65535&(y=(y=65535&d)+(65535&(d=c))+((m=(m=f>>>16)+((f=u)>>>16)+((p+=65535&f)>>>16))>>>16))|(g=g+(d>>>16)+(y>>>16))<<16,M=B,T=j,I=U,v=L,R=K,x=F,C=D,N=65535&p|m<<16,P=q,O=G,$=z,k=W,l%16==15)for(h=0;h<16;h++)d=_[h],p=65535&(f=b[h]),m=f>>>16,y=65535&d,g=d>>>16,d=_[(h+9)%16],p+=65535&(f=b[(h+9)%16]),m+=f>>>16,y+=65535&d,g+=d>>>16,c=_[(h+1)%16],p+=65535&(f=((u=b[(h+1)%16])>>>1|c<<31)^(u>>>8|c<<24)^(u>>>7|c<<25)),m+=f>>>16,y+=65535&(d=(c>>>1|u<<31)^(c>>>8|u<<24)^c>>>7),g=(g+=d>>>16)+((d=((c=_[(h+14)%16])>>>19|(u=b[(h+14)%16])<<13)^(u>>>29|c<<3)^c>>>6)>>>16)+((y=y+(65535&d)+((m=m+((f=(u>>>19|c<<13)^(c>>>29|u<<3)^(u>>>6|c<<26))>>>16)+((p+=65535&f)>>>16))>>>16))>>>16),_[h]=65535&y|g<<16,b[h]=65535&p|m<<16;p=65535&(f=k),y=65535&(d=v),g=(g=d>>>16)+((d=e[0])>>>16)+((y=y+(65535&d)+((m=(m=f>>>16)+((f=t[0])>>>16)+((p+=65535&f)>>>16))>>>16))>>>16),e[0]=v=65535&y|g<<16,t[0]=k=65535&p|m<<16,p=65535&(f=R),y=65535&(d=w),g=(g=d>>>16)+((d=e[1])>>>16)+((y=y+(65535&d)+((m=(m=f>>>16)+((f=t[1])>>>16)+((p+=65535&f)>>>16))>>>16))>>>16),e[1]=w=65535&y|g<<16,t[1]=R=65535&p|m<<16,p=65535&(f=x),y=65535&(d=E),g=(g=d>>>16)+((d=e[2])>>>16)+((y=y+(65535&d)+((m=(m=f>>>16)+((f=t[2])>>>16)+((p+=65535&f)>>>16))>>>16))>>>16),e[2]=E=65535&y|g<<16,t[2]=x=65535&p|m<<16,p=65535&(f=C),y=65535&(d=A),g=(g=d>>>16)+((d=e[3])>>>16)+((y=y+(65535&d)+((m=(m=f>>>16)+((f=t[3])>>>16)+((p+=65535&f)>>>16))>>>16))>>>16),e[3]=A=65535&y|g<<16,t[3]=C=65535&p|m<<16,p=65535&(f=N),y=65535&(d=S),g=(g=d>>>16)+((d=e[4])>>>16)+((y=y+(65535&d)+((m=(m=f>>>16)+((f=t[4])>>>16)+((p+=65535&f)>>>16))>>>16))>>>16),e[4]=S=65535&y|g<<16,t[4]=N=65535&p|m<<16,p=65535&(f=P),y=65535&(d=M),g=(g=d>>>16)+((d=e[5])>>>16)+((y=y+(65535&d)+((m=(m=f>>>16)+((f=t[5])>>>16)+((p+=65535&f)>>>16))>>>16))>>>16),e[5]=M=65535&y|g<<16,t[5]=P=65535&p|m<<16,p=65535&(f=O),y=65535&(d=T),g=(g=d>>>16)+((d=e[6])>>>16)+((y=y+(65535&d)+((m=(m=f>>>16)+((f=t[6])>>>16)+((p+=65535&f)>>>16))>>>16))>>>16),e[6]=T=65535&y|g<<16,t[6]=O=65535&p|m<<16,p=65535&(f=$),y=65535&(d=I),g=(g=d>>>16)+((d=e[7])>>>16)+((y=y+(65535&d)+((m=(m=f>>>16)+((f=t[7])>>>16)+((p+=65535&f)>>>16))>>>16))>>>16),e[7]=I=65535&y|g<<16,t[7]=$=65535&p|m<<16,X+=128,n-=128}}function A(e,t,r){var n,o=new Int32Array(8),i=new Int32Array(8),a=new Uint8Array(256),s=r;for(o[0]=1779033703,o[1]=3144134277,o[2]=1013904242,o[3]=2773480762,o[4]=1359893119,o[5]=2600822924,o[6]=528734635,o[7]=1541459225,i[0]=4089235720,i[1]=2227873595,i[2]=4271175723,i[3]=1595750129,i[4]=2917565137,i[5]=725511199,i[6]=4215389547,i[7]=327033209,J(o,i,t,r),r%=128,n=0;n<r;n++)a[n]=t[s-r+n];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,L(a,r-8,s/536870912|0,s<<3),J(o,i,a,r),n=0;n<8;n++)L(e,8*n,o[n],i[n]);return 0}function S(e,t){var r=C(),n=C(),o=C(),i=C(),a=C(),s=C(),c=C(),u=C(),l=C();b(r,e[1],e[0]),b(l,t[1],t[0]),v(r,r,l),_(n,e[0],e[1]),_(l,t[0],t[1]),v(n,n,l),v(o,e[3],t[3]),v(o,o,se),v(i,e[2],t[2]),_(i,i,i),b(a,n,r),b(s,i,o),_(c,i,o),_(u,n,r),v(e[0],a,s),v(e[1],u,c),v(e[2],c,s),v(e[3],a,u)}function V(e,t,r){for(var n=0;n<4;n++)m(e[n],t[n],r)}function M(e,t){var r=C(),n=C(),o=C();W(o,t[2]),v(r,t[0],o),v(n,t[1],o),y(e,n),e[31]^=z(r)<<7}function T(e,t,r){var n,o;for(f(e[0],P),f(e[1],O),f(e[2],O),f(e[3],P),o=255;0<=o;--o)V(e,t,n=r[o/8|0]>>(7&o)&1),S(t,e),S(e,e),V(e,t,n)}function I(e,t){var r=[C(),C(),C(),C()];f(r[0],ce),f(r[1],ue),f(r[2],O),v(r[3],ce,ue),T(e,r,t)}function k(e,t,r){var n,o=new Uint8Array(64),i=[C(),C(),C(),C()];for(r||N(t,32),A(o,t,32),o[0]&=248,o[31]&=127,o[31]|=64,I(i,o),M(e,i),n=0;n<32;n++)t[n+32]=e[n];return 0}function Y(e,t){for(var r,n,o,i=63;32<=i;--i){for(r=0,n=i-32,o=i-12;n<o;++n)t[n]+=r-16*t[i]*j[n-(i-32)],r=Math.floor((t[n]+128)/256),t[n]-=256*r;t[n]+=r,t[i]=0}for(n=r=0;n<32;n++)t[n]+=r-(t[31]>>4)*j[n],r=t[n]>>8,t[n]&=255;for(n=0;n<32;n++)t[n]-=r*j[n];for(i=0;i<32;i++)t[i+1]+=t[i]>>8,e[i]=255&t[i]}function Z(e){for(var t=new Float64Array(64),r=0;r<64;r++)t[r]=e[r];for(r=0;r<64;r++)e[r]=0;Y(e,t)}function Q(e,t,r,n){for(var o,i=new Uint8Array(64),a=new Uint8Array(64),s=new Uint8Array(64),c=new Float64Array(64),u=[C(),C(),C(),C()],l=(A(i,n,32),i[0]&=248,i[31]&=127,i[31]|=64,r+64),h=0;h<r;h++)e[64+h]=t[h];for(h=0;h<32;h++)e[32+h]=i[32+h];for(A(s,e.subarray(32),r+32),Z(s),I(u,s),M(e,u),h=32;h<64;h++)e[h]=n[h];for(A(a,e,r+64),Z(a),h=0;h<64;h++)c[h]=0;for(h=0;h<32;h++)c[h]=s[h];for(h=0;h<32;h++)for(o=0;o<32;o++)c[h+o]+=a[h]*i[o];return Y(e.subarray(32),c),l}function ee(e,t,r,n){var o,i=new Uint8Array(32),a=new Uint8Array(64),s=[C(),C(),C(),C()],c=[C(),C(),C(),C()];if(r<64)return-1;if(function(e,t){var r=C(),n=C(),o=C(),i=C(),a=C(),s=C(),c=C();if(f(e[2],O),g(e[1],t),w(o,e[1]),v(i,o,ae),b(o,o,e[2]),_(i,e[2],i),w(a,i),w(s,a),v(c,s,a),v(r,c,o),v(r,r,i),X(r,r),v(r,r,o),v(r,r,i),v(r,r,i),v(e[0],r,i),w(n,e[0]),v(n,n,i),G(n,o)&&v(e[0],e[0],le),w(n,e[0]),v(n,n,i),G(n,o))return 1;z(e[0])===t[31]>>7&&b(e[0],P,e[0]),v(e[3],e[0],e[1])}(c,n))return-1;for(o=0;o<r;o++)e[o]=t[o];for(o=0;o<32;o++)e[o+32]=n[o];if(A(a,e,r),Z(a),T(s,c,a),I(c,t.subarray(32)),S(s,c),M(i,s),r-=64,u(t,0,i,0)){for(o=0;o<r;o++)e[o]=0;return-1}for(o=0;o<r;o++)e[o]=t[o+64];return r}function te(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function R(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function re(e){for(var t=0;t<e.length;t++)e[t]=0}var x,C,N,ne,oe,P,O,ie,ae,se,ce,ue,le,$,B,he,de,fe,j,U;x=e.exports||(self.nacl=self.nacl||{}),C=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},N=function(){throw new Error("no PRNG")},ne=new Uint8Array(16),(oe=new Uint8Array(32))[0]=9,P=C(),O=C([1]),ie=C([56129,1]),ae=C([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),se=C([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),ce=C([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),ue=C([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),le=C([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]),$=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]),(B=function(e){var t,r;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,t=255&e[this.fin=0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),t=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|t<<6),r=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(t>>>7|r<<9),t=255&e[8]|(255&e[9])<<8,this.r[4]=255&(r>>>4|t<<12),this.r[5]=t>>>1&8190,r=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(t>>>14|r<<2),t=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(r>>>11|t<<5),r=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(t>>>8|r<<8),this.r[9]=r>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8}).prototype.blocks=function(e,t,r){for(var n,o,i,a,s,c,u,l,h,d,f,p=this.fin?0:2048,m=this.h[0],y=this.h[1],g=this.h[2],_=this.h[3],b=this.h[4],v=this.h[5],w=this.h[6],E=this.h[7],A=this.h[8],S=this.h[9],M=this.r[0],T=this.r[1],I=this.r[2],k=this.r[3],R=this.r[4],x=this.r[5],C=this.r[6],N=this.r[7],P=this.r[8],O=this.r[9];16<=r;)o=n=0,n=(o=(o=(o+=(m+=8191&(i=255&e[t+0]|(255&e[t+1])<<8))*M)+(y+=8191&(i>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*O)+(g+=8191&(i>>>10|(i=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*P))+(_+=8191&(i>>>7|(i=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*N)+(b+=8191&(i>>>4|(i=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*C))>>>13,i=n+=(o=(o=(o=(o&8191)+(v+=i>>>1&8191)*(5*x))+(w+=8191&(i>>>14|(i=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*R)+(E+=8191&(i>>>11|(i=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*k))+(A+=8191&(i>>>8|(i=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*I)+(S+=i>>>5|p)*(5*T))>>>13,n=(i=(i=(i+=m*T)+y*M+g*(5*O))+_*(5*P)+b*(5*N))>>>13,a=n+=(i=(i=(i=(i&8191)+v*(5*C))+w*(5*x)+E*(5*R))+A*(5*k)+S*(5*I))>>>13,n=(a=(a=(a+=m*I)+y*T+g*M)+_*(5*O)+b*(5*P))>>>13,s=n+=(a=(a=(a=(a&8191)+v*(5*N))+w*(5*C)+E*(5*x))+A*(5*R)+S*(5*k))>>>13,n=(s=(s=(s+=m*k)+y*I+g*T)+_*M+b*(5*O))>>>13,c=n+=(s=(s=(s=(s&8191)+v*(5*P))+w*(5*N)+E*(5*C))+A*(5*x)+S*(5*R))>>>13,n=(c=(c=(c+=m*R)+y*k+g*I)+_*T+b*M)>>>13,u=n+=(c=(c=(c=(c&8191)+v*(5*O))+w*(5*P)+E*(5*N))+A*(5*C)+S*(5*x))>>>13,n=(u=(u=(u+=m*x)+y*R+g*k)+_*I+b*T)>>>13,l=n+=(u=(u=(u=(u&8191)+v*M)+w*(5*O)+E*(5*P))+A*(5*N)+S*(5*C))>>>13,n=(l=(l=(l+=m*C)+y*x+g*R)+_*k+b*I)>>>13,h=n+=(l=(l=(l=(l&8191)+v*T)+w*M+E*(5*O))+A*(5*P)+S*(5*N))>>>13,n=(h=(h=(h+=m*N)+y*C+g*x)+_*R+b*k)>>>13,d=n+=(h=(h=(h=(h&8191)+v*I)+w*T+E*M)+A*(5*O)+S*(5*P))>>>13,n=(d=(d=(d+=m*P)+y*N+g*C)+_*x+b*R)>>>13,f=n+=(d=(d=(d=(d&8191)+v*k)+w*I+E*T)+A*M+S*(5*O))>>>13,n=(f=(f=(f+=m*O)+y*P+g*N)+_*C+b*x)>>>13,m=o=8191&(n=(n=((n+=(f=(f=(f=(f&8191)+v*R)+w*k+E*I)+A*T+S*M)>>>13)<<2)+n|0)+(o&=8191)|0),y=i=(i&8191)+(n>>>=13),g=a&=8191,_=s&=8191,b=c&=8191,v=u&=8191,w=l&=8191,E=h&=8191,A=d&=8191,S=f&=8191,t+=16,r-=16;this.h[0]=m,this.h[1]=y,this.h[2]=g,this.h[3]=_,this.h[4]=b,this.h[5]=v,this.h[6]=w,this.h[7]=E,this.h[8]=A,this.h[9]=S},B.prototype.finish=function(e,t){var r,n,o,i,a=new Uint16Array(10);if(this.leftover){for(i=this.leftover,this.buffer[i++]=1;i<16;i++)this.buffer[i]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,i=2;i<10;i++)this.h[i]+=r,r=this.h[i]>>>13,this.h[i]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,a[0]=this.h[0]+5,r=a[0]>>>13,a[0]&=8191,i=1;i<10;i++)a[i]=this.h[i]+r,r=a[i]>>>13,a[i]&=8191;for(a[9]-=8192,n=(1^r)-1,i=0;i<10;i++)a[i]&=n;for(n=~n,i=0;i<10;i++)this.h[i]=this.h[i]&n|a[i];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),o=this.h[0]+this.pad[0],this.h[0]=65535&o,i=1;i<8;i++)o=(this.h[i]+this.pad[i]|0)+(o>>>16)|0,this.h[i]=65535&o;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},B.prototype.update=function(e,t,r){var n,o;if(this.leftover){for(r<(o=16-this.leftover)&&(o=r),n=0;n<o;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=o,t+=o,this.leftover+=o,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(16<=r&&(this.blocks(e,t,o=r-r%16),t+=o,r-=o),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}},he=a,de=d,fe=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],j=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),x.lowlevel={crypto_core_hsalsa20:l,crypto_stream_xor:s,crypto_stream:H,crypto_stream_salsa20_xor:F,crypto_stream_salsa20:D,crypto_onetimeauth:c,crypto_onetimeauth_verify:q,crypto_verify_16:K,crypto_verify_32:u,crypto_secretbox:a,crypto_secretbox_open:d,crypto_scalarmult:i,crypto_scalarmult_base:r,crypto_box_beforenm:E,crypto_box_afternm:he,crypto_box:function(e,t,r,n,o,i){var a=new Uint8Array(32);return E(a,o,i),he(e,t,r,n,a)},crypto_box_open:function(e,t,r,n,o,i){var a=new Uint8Array(32);return E(a,o,i),de(e,t,r,n,a)},crypto_box_keypair:n,crypto_hash:A,crypto_sign:Q,crypto_sign_keypair:k,crypto_sign_open:ee,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:C,D:ae,L:j,pack25519:y,unpack25519:g,M:v,A:_,S:w,Z:b,pow2523:X,add:S,set25519:f,modL:Y,scalarmult:T,scalarbase:I},x.randomBytes=function(e){var t=new Uint8Array(e);return N(t,e),t},x.secretbox=function(e,t,r){R(e,t,r),te(r,t);for(var n=new Uint8Array(32+e.length),o=new Uint8Array(n.length),i=0;i<e.length;i++)n[i+32]=e[i];return a(o,n,n.length,t,r),o.subarray(16)},x.secretbox.open=function(e,t,r){R(e,t,r),te(r,t);for(var n=new Uint8Array(16+e.length),o=new Uint8Array(n.length),i=0;i<e.length;i++)n[i+16]=e[i];return n.length<32||0!==d(o,n,n.length,t,r)?null:o.subarray(32)},x.secretbox.keyLength=32,x.secretbox.nonceLength=24,x.secretbox.overheadLength=16,x.scalarMult=function(e,t){if(R(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return i(r,e,t),r},x.scalarMult.base=function(e){if(R(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return r(t,e),t},x.scalarMult.scalarLength=32,x.scalarMult.groupElementLength=32,x.box=function(e,t,r,n){r=x.box.before(r,n);return x.secretbox(e,t,r)},x.box.before=function(e,t){R(e,t);var r=t;if(32!==e.length)throw new Error("bad public key size");if(32!==r.length)throw new Error("bad secret key size");r=new Uint8Array(32);return E(r,e,t),r},x.box.after=x.secretbox,x.box.open=function(e,t,r,n){r=x.box.before(r,n);return x.secretbox.open(e,t,r)},x.box.open.after=x.secretbox.open,x.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return n(e,t),{publicKey:e,secretKey:t}},x.box.keyPair.fromSecretKey=function(e){if(R(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return r(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},x.box.publicKeyLength=32,x.box.secretKeyLength=32,x.box.sharedKeyLength=32,x.box.nonceLength=24,x.box.overheadLength=x.secretbox.overheadLength,x.sign=function(e,t){if(R(e,t),64!==t.length)throw new Error("bad secret key size");var r=new Uint8Array(64+e.length);return Q(r,e,e.length,t),r},x.sign.open=function(e,t){if(R(e,t),32!==t.length)throw new Error("bad public key size");var r=new Uint8Array(e.length),e=ee(r,e,e.length,t);if(e<0)return null;for(var n=new Uint8Array(e),o=0;o<n.length;o++)n[o]=r[o];return n},x.sign.detached=function(e,t){for(var r=x.sign(e,t),n=new Uint8Array(64),o=0;o<n.length;o++)n[o]=r[o];return n},x.sign.detached.verify=function(e,t,r){if(R(e,t,r),64!==t.length)throw new Error("bad signature size");if(32!==r.length)throw new Error("bad public key size");for(var n=new Uint8Array(64+e.length),o=new Uint8Array(64+e.length),i=0;i<64;i++)n[i]=t[i];for(i=0;i<e.length;i++)n[i+64]=e[i];return 0<=ee(o,n,n.length,r)},x.sign.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(64);return k(e,t),{publicKey:e,secretKey:t}},x.sign.keyPair.fromSecretKey=function(e){if(R(e),64!==e.length)throw new Error("bad secret key size");for(var t=new Uint8Array(32),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},x.sign.keyPair.fromSeed=function(e){if(R(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(32),r=new Uint8Array(64),n=0;n<32;n++)r[n]=e[n];return k(t,r,!0),{publicKey:t,secretKey:r}},x.sign.publicKeyLength=32,x.sign.secretKeyLength=64,x.sign.seedLength=32,x.sign.signatureLength=64,x.hash=function(e){R(e);var t=new Uint8Array(64);return A(t,e,e.length),t},x.hash.hashLength=64,x.verify=function(e,t){return R(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===o(e,0,t,0,e.length))},x.setPRNG=function(e){N=e},(U="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&U.getRandomValues?x.setPRNG(function(e,t){for(var r=new Uint8Array(t),n=0;n<t;n+=65536)U.getRandomValues(r.subarray(n,n+Math.min(t-n,65536)));for(n=0;n<t;n++)e[n]=r[n];re(r)}):void 0!==commonjsRequire&&(U=require$$0__default.default)&&U.randomBytes&&x.setPRNG(function(e,t){for(var r=U.randomBytes(t),n=0;n<t;n++)e[n]=r[n];re(r)})}(naclFast),{}),lib$1={},bn={exports:{}},safeBuffer=(!function(e){var r,t=commonjsGlobal;function m(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;function r(){}r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function y(e,t,r){if(y.isBN(e))return e;this.negative=0,this.words=null,this.length=0,(this.red=null)!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}"object"==typeof e?e.exports=y:t.BN=y,(y.BN=y).wordSize=26;try{r=("undefined"!=typeof window&&void 0!==window.Buffer?window:require("buffer")).Buffer}catch(e){}function o(e,t){t=e.charCodeAt(t);return 48<=t&&t<=57?t-48:65<=t&&t<=70?t-55:97<=t&&t<=102?t-87:void m(!1,"Invalid character in "+e)}function s(e,t,r){var n=o(e,r);return t<=r-1&&(n|=o(e,r-1)<<4),n}function h(e,t,r,n){for(var o=0,i=0,a=Math.min(e.length,r),s=t;s<a;s++){var c=e.charCodeAt(s)-48;o*=n,i=49<=c?c-49+10:17<=c?c-17+10:c,m(0<=c&&i<n,"Invalid character"),o+=i}return o}function i(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(y.isBN=function(e){return e instanceof y||null!==e&&"object"==typeof e&&e.constructor.wordSize===y.wordSize&&Array.isArray(e.words)},y.max=function(e,t){return 0<e.cmp(t)?e:t},y.min=function(e,t){return e.cmp(t)<0?e:t},y.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);m((t="hex"===t?16:t)===(0|t)&&2<=t&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(n++,this.negative=1),n<e.length&&(16===t?this._parseHex(e,n,r):(this._parseBase(e,t,n),"le"===r&&this._initArray(this.toArray(),t,r)))},y.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(m(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},y.prototype._initArray=function(e,t,r){if(m("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var n,o,i=0;i<this.length;i++)this.words[i]=0;var a=0;if("be"===r)for(i=e.length-1,n=0;0<=i;i-=3)o=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[n]|=o<<a&67108863,this.words[n+1]=o>>>26-a&67108863,26<=(a+=24)&&(a-=26,n++);else if("le"===r)for(n=i=0;i<e.length;i+=3)o=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[n]|=o<<a&67108863,this.words[n+1]=o>>>26-a&67108863,26<=(a+=24)&&(a-=26,n++);return this._strip()},y.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var o,i=0,a=0;if("be"===r)for(n=e.length-1;t<=n;n-=2)o=s(e,t,n)<<i,this.words[a]|=67108863&o,18<=i?(i-=18,this.words[a+=1]|=o>>>26):i+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)o=s(e,t,n)<<i,this.words[a]|=67108863&o,18<=i?(i-=18,this.words[a+=1]|=o>>>26):i+=8;this._strip()},y.prototype._parseBase=function(e,t,r){this.words=[0];for(var n=0,o=this.length=1;o<=67108863;o*=t)n++;for(var o=o/t|0,i=e.length-r,a=i%--n,s=Math.min(i,i-a)+r,c=0,u=r;u<s;u+=n)c=h(e,u,u+n,t),this.imuln(o),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!=a){for(var l=1,c=h(e,u,e.length,t),u=0;u<a;u++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this._strip()},y.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},y.prototype._move=function(e){i(e,this)},y.prototype.clone=function(){var e=new y(null);return this.copy(e),e},y.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},y.prototype._strip=function(){for(;1<this.length&&0===this.words[this.length-1];)this.length--;return this._normSign()},y.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{y.prototype[Symbol.for("nodejs.util.inspect.custom")]=a}catch(e){y.prototype.inspect=a}else y.prototype.inspect=a;function a(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function c(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0,n=(r.length=n)-1|0,o=(a=(0|e.words[0])*(0|t.words[0]))/67108864|0;r.words[0]=67108863&a;for(var i=1;i<n;i++){for(var a,s=o>>>26,c=67108863&o,u=Math.min(i,t.length-1),l=Math.max(0,i-e.length+1);l<=u;l++)s+=(a=(0|e.words[i-l|0])*(0|t.words[l])+c)/67108864|0,c=67108863&a;r.words[i]=0|c,o=0|s}return 0!==o?r.words[i]=0|o:r.length--,r._strip()}y.prototype.toString=function(e,t){if(t=0|t||1,16===(e=e||10)||"hex"===e){s="";for(var r=0,n=0,o=0;o<this.length;o++){var i=this.words[o],a=(16777215&(i<<r|n)).toString(16),s=0!==(n=i>>>24-r&16777215)||o!==this.length-1?d[6-a.length]+a+s:a+s;26<=(r+=2)&&(r-=26,o--)}for(0!==n&&(s=n.toString(16)+s);s.length%t!=0;)s="0"+s;return s=0!==this.negative?"-"+s:s}if(e===(0|e)&&2<=e&&e<=36){var c=f[e],u=p[e];for(s="",(l=this.clone()).negative=0;!l.isZero();){var l,h=l.modrn(u).toString(e);s=(l=l.idivn(u)).isZero()?h+s:d[c-h.length]+h+s}for(this.isZero()&&(s="0"+s);s.length%t!=0;)s="0"+s;return s=0!==this.negative?"-"+s:s}m(!1,"Base should be between 2 and 36")},y.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:2<this.length&&m(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},y.prototype.toJSON=function(){return this.toString(16,2)},r&&(y.prototype.toBuffer=function(e,t){return this.toArrayLike(r,e,t)}),y.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},y.prototype.toArrayLike=function(e,t,r){this._strip();var n=this.byteLength(),r=r||Math.max(1,n),e=(m(n<=r,"byte array longer than desired length"),m(0<r,"Requested array length <= 0"),r=r,(e=e).allocUnsafe?e.allocUnsafe(r):new e(r));return this["_toArrayLike"+("le"===t?"LE":"BE")](e,n),e},y.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,o=0,i=0;o<this.length;o++){var a=this.words[o]<<i|n;e[r++]=255&a,r<e.length&&(e[r++]=a>>8&255),r<e.length&&(e[r++]=a>>16&255),6===i?(r<e.length&&(e[r++]=a>>24&255),i=n=0):(n=a>>>24,i+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},y.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,o=0,i=0;o<this.length;o++){var a=this.words[o]<<i|n;e[r--]=255&a,0<=r&&(e[r--]=a>>8&255),0<=r&&(e[r--]=a>>16&255),6===i?(0<=r&&(e[r--]=a>>24&255),i=n=0):(n=a>>>24,i+=2)}if(0<=r)for(e[r--]=n;0<=r;)e[r--]=0},Math.clz32?y.prototype._countBits=function(e){return 32-Math.clz32(e)}:y.prototype._countBits=function(e){var t=0;return 4096<=e&&(t+=13,e>>>=13),64<=e&&(t+=7,e>>>=7),8<=e&&(t+=4,e>>>=4),2<=e&&(t+=2,e>>>=2),t+e},y.prototype._zeroBits=function(e){if(0===e)return 26;var t=0;return 0==(8191&e)&&(t+=13,e>>>=13),0==(127&e)&&(t+=7,e>>>=7),0==(15&e)&&(t+=4,e>>>=4),0==(3&e)&&(t+=2,e>>>=2),0==(1&e)&&t++,t},y.prototype.bitLength=function(){var e=this.words[this.length-1],e=this._countBits(e);return 26*(this.length-1)+e},y.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},y.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},y.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},y.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},y.prototype.isNeg=function(){return 0!==this.negative},y.prototype.neg=function(){return this.clone().ineg()},y.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},y.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},y.prototype.ior=function(e){return m(0==(this.negative|e.negative)),this.iuor(e)},y.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},y.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},y.prototype.iuand=function(e){for(var t=this.length>e.length?e:this,r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},y.prototype.iand=function(e){return m(0==(this.negative|e.negative)),this.iuand(e)},y.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},y.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},y.prototype.iuxor=function(e){for(var t,r=this.length>e.length?(t=this,e):(t=e,this),n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},y.prototype.ixor=function(e){return m(0==(this.negative|e.negative)),this.iuxor(e)},y.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},y.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},y.prototype.inotn=function(e){m("number"==typeof e&&0<=e);var t=0|Math.ceil(e/26),e=e%26;this._expand(t),0<e&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return 0<e&&(this.words[r]=~this.words[r]&67108863>>26-e),this._strip()},y.prototype.notn=function(e){return this.clone().inotn(e)},y.prototype.setn=function(e,t){m("number"==typeof e&&0<=e);var r=e/26|0,e=e%26;return this._expand(1+r),this.words[r]=t?this.words[r]|1<<e:this.words[r]&~(1<<e),this._strip()},y.prototype.iadd=function(e){var t,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();for(var n=this.length>e.length?(r=this,e):(r=e,this),o=0,i=0;i<n.length;i++)t=(0|r.words[i])+(0|n.words[i])+o,this.words[i]=67108863&t,o=t>>>26;for(;0!==o&&i<r.length;i++)t=(0|r.words[i])+o,this.words[i]=67108863&t,o=t>>>26;if(this.length=r.length,0!==o)this.words[this.length]=o,this.length++;else if(r!==this)for(;i<r.length;i++)this.words[i]=r.words[i];return this},y.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},y.prototype.isub=function(e){var t;if(0!==e.negative)return e.negative=0,t=this.iadd(e),e.negative=1,t._normSign();if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;for(var o=0<n?(r=this,e):(r=e,this),i=0,a=0;a<o.length;a++)i=(t=(0|r.words[a])-(0|o.words[a])+i)>>26,this.words[a]=67108863&t;for(;0!==i&&a<r.length;a++)i=(t=(0|r.words[a])+i)>>26,this.words[a]=67108863&t;if(0===i&&a<r.length&&r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this.length=Math.max(this.length,a),r!==this&&(this.negative=1),this._strip()},y.prototype.sub=function(e){return this.clone().isub(e)};var u=function(e,B,j){var t,r=e.words,n=B.words,o=j.words,i=0|r[0],a=8191&i,i=i>>>13,s=0|r[1],c=8191&s,s=s>>>13,u=0|r[2],l=8191&u,u=u>>>13,h=0|r[3],d=8191&h,h=h>>>13,f=0|r[4],p=8191&f,f=f>>>13,m=0|r[5],y=8191&m,m=m>>>13,g=0|r[6],_=8191&g,g=g>>>13,b=0|r[7],v=8191&b,b=b>>>13,w=0|r[8],U=8191&w,w=w>>>13,r=0|r[9],L=8191&r,r=r>>>13,E=0|n[0],A=8191&E,E=E>>>13,S=0|n[1],M=8191&S,S=S>>>13,T=0|n[2],I=8191&T,T=T>>>13,k=0|n[3],K=8191&k,k=k>>>13,R=0|n[4],F=8191&R,R=R>>>13,x=0|n[5],D=8191&x,x=x>>>13,C=0|n[6],H=8191&C,C=C>>>13,N=0|n[7],q=8191&N,N=N>>>13,P=0|n[8],G=8191&P,P=P>>>13,n=0|n[9],z=8191&n,n=n>>>13,B=(j.negative=e.negative^B.negative,j.length=19,(0+Math.imul(a,A)|0)+((8191&(e=Math.imul(a,E)+Math.imul(i,A)|0))<<13)|0),O=(Math.imul(i,E)+(e>>>13)|0)+(B>>>26)|0;B&=67108863,t=Math.imul(c,A),e=Math.imul(c,E)+Math.imul(s,A)|0,$=Math.imul(s,E);var $,W=(O+(t+Math.imul(a,M)|0)|0)+((8191&(e=(e+Math.imul(a,S)|0)+Math.imul(i,M)|0))<<13)|0,X=(O=(($+Math.imul(i,S)|0)+(e>>>13)|0)+(W>>>26)|0,W&=67108863,t=Math.imul(l,A),e=Math.imul(l,E)+Math.imul(u,A)|0,$=Math.imul(u,E),t=t+Math.imul(c,M)|0,e=(e+Math.imul(c,S)|0)+Math.imul(s,M)|0,$=$+Math.imul(s,S)|0,(O+(t+Math.imul(a,I)|0)|0)+((8191&(e=(e+Math.imul(a,T)|0)+Math.imul(i,I)|0))<<13)|0),J=(O=(($+Math.imul(i,T)|0)+(e>>>13)|0)+(X>>>26)|0,X&=67108863,t=Math.imul(d,A),e=Math.imul(d,E)+Math.imul(h,A)|0,$=Math.imul(h,E),t=t+Math.imul(l,M)|0,e=(e+Math.imul(l,S)|0)+Math.imul(u,M)|0,$=$+Math.imul(u,S)|0,t=t+Math.imul(c,I)|0,e=(e+Math.imul(c,T)|0)+Math.imul(s,I)|0,$=$+Math.imul(s,T)|0,(O+(t+Math.imul(a,K)|0)|0)+((8191&(e=(e+Math.imul(a,k)|0)+Math.imul(i,K)|0))<<13)|0),V=(O=(($+Math.imul(i,k)|0)+(e>>>13)|0)+(J>>>26)|0,J&=67108863,t=Math.imul(p,A),e=Math.imul(p,E)+Math.imul(f,A)|0,$=Math.imul(f,E),t=t+Math.imul(d,M)|0,e=(e+Math.imul(d,S)|0)+Math.imul(h,M)|0,$=$+Math.imul(h,S)|0,t=t+Math.imul(l,I)|0,e=(e+Math.imul(l,T)|0)+Math.imul(u,I)|0,$=$+Math.imul(u,T)|0,t=t+Math.imul(c,K)|0,e=(e+Math.imul(c,k)|0)+Math.imul(s,K)|0,$=$+Math.imul(s,k)|0,(O+(t+Math.imul(a,F)|0)|0)+((8191&(e=(e+Math.imul(a,R)|0)+Math.imul(i,F)|0))<<13)|0),Y=(O=(($+Math.imul(i,R)|0)+(e>>>13)|0)+(V>>>26)|0,V&=67108863,t=Math.imul(y,A),e=Math.imul(y,E)+Math.imul(m,A)|0,$=Math.imul(m,E),t=t+Math.imul(p,M)|0,e=(e+Math.imul(p,S)|0)+Math.imul(f,M)|0,$=$+Math.imul(f,S)|0,t=t+Math.imul(d,I)|0,e=(e+Math.imul(d,T)|0)+Math.imul(h,I)|0,$=$+Math.imul(h,T)|0,t=t+Math.imul(l,K)|0,e=(e+Math.imul(l,k)|0)+Math.imul(u,K)|0,$=$+Math.imul(u,k)|0,t=t+Math.imul(c,F)|0,e=(e+Math.imul(c,R)|0)+Math.imul(s,F)|0,$=$+Math.imul(s,R)|0,(O+(t+Math.imul(a,D)|0)|0)+((8191&(e=(e+Math.imul(a,x)|0)+Math.imul(i,D)|0))<<13)|0),Z=(O=(($+Math.imul(i,x)|0)+(e>>>13)|0)+(Y>>>26)|0,Y&=67108863,t=Math.imul(_,A),e=Math.imul(_,E)+Math.imul(g,A)|0,$=Math.imul(g,E),t=t+Math.imul(y,M)|0,e=(e+Math.imul(y,S)|0)+Math.imul(m,M)|0,$=$+Math.imul(m,S)|0,t=t+Math.imul(p,I)|0,e=(e+Math.imul(p,T)|0)+Math.imul(f,I)|0,$=$+Math.imul(f,T)|0,t=t+Math.imul(d,K)|0,e=(e+Math.imul(d,k)|0)+Math.imul(h,K)|0,$=$+Math.imul(h,k)|0,t=t+Math.imul(l,F)|0,e=(e+Math.imul(l,R)|0)+Math.imul(u,F)|0,$=$+Math.imul(u,R)|0,t=t+Math.imul(c,D)|0,e=(e+Math.imul(c,x)|0)+Math.imul(s,D)|0,$=$+Math.imul(s,x)|0,(O+(t+Math.imul(a,H)|0)|0)+((8191&(e=(e+Math.imul(a,C)|0)+Math.imul(i,H)|0))<<13)|0),Q=(O=(($+Math.imul(i,C)|0)+(e>>>13)|0)+(Z>>>26)|0,Z&=67108863,t=Math.imul(v,A),e=Math.imul(v,E)+Math.imul(b,A)|0,$=Math.imul(b,E),t=t+Math.imul(_,M)|0,e=(e+Math.imul(_,S)|0)+Math.imul(g,M)|0,$=$+Math.imul(g,S)|0,t=t+Math.imul(y,I)|0,e=(e+Math.imul(y,T)|0)+Math.imul(m,I)|0,$=$+Math.imul(m,T)|0,t=t+Math.imul(p,K)|0,e=(e+Math.imul(p,k)|0)+Math.imul(f,K)|0,$=$+Math.imul(f,k)|0,t=t+Math.imul(d,F)|0,e=(e+Math.imul(d,R)|0)+Math.imul(h,F)|0,$=$+Math.imul(h,R)|0,t=t+Math.imul(l,D)|0,e=(e+Math.imul(l,x)|0)+Math.imul(u,D)|0,$=$+Math.imul(u,x)|0,t=t+Math.imul(c,H)|0,e=(e+Math.imul(c,C)|0)+Math.imul(s,H)|0,$=$+Math.imul(s,C)|0,(O+(t+Math.imul(a,q)|0)|0)+((8191&(e=(e+Math.imul(a,N)|0)+Math.imul(i,q)|0))<<13)|0),ee=(O=(($+Math.imul(i,N)|0)+(e>>>13)|0)+(Q>>>26)|0,Q&=67108863,t=Math.imul(U,A),e=Math.imul(U,E)+Math.imul(w,A)|0,$=Math.imul(w,E),t=t+Math.imul(v,M)|0,e=(e+Math.imul(v,S)|0)+Math.imul(b,M)|0,$=$+Math.imul(b,S)|0,t=t+Math.imul(_,I)|0,e=(e+Math.imul(_,T)|0)+Math.imul(g,I)|0,$=$+Math.imul(g,T)|0,t=t+Math.imul(y,K)|0,e=(e+Math.imul(y,k)|0)+Math.imul(m,K)|0,$=$+Math.imul(m,k)|0,t=t+Math.imul(p,F)|0,e=(e+Math.imul(p,R)|0)+Math.imul(f,F)|0,$=$+Math.imul(f,R)|0,t=t+Math.imul(d,D)|0,e=(e+Math.imul(d,x)|0)+Math.imul(h,D)|0,$=$+Math.imul(h,x)|0,t=t+Math.imul(l,H)|0,e=(e+Math.imul(l,C)|0)+Math.imul(u,H)|0,$=$+Math.imul(u,C)|0,t=t+Math.imul(c,q)|0,e=(e+Math.imul(c,N)|0)+Math.imul(s,q)|0,$=$+Math.imul(s,N)|0,(O+(t+Math.imul(a,G)|0)|0)+((8191&(e=(e+Math.imul(a,P)|0)+Math.imul(i,G)|0))<<13)|0),A=(O=(($+Math.imul(i,P)|0)+(e>>>13)|0)+(ee>>>26)|0,ee&=67108863,t=Math.imul(L,A),e=Math.imul(L,E)+Math.imul(r,A)|0,$=Math.imul(r,E),t=t+Math.imul(U,M)|0,e=(e+Math.imul(U,S)|0)+Math.imul(w,M)|0,$=$+Math.imul(w,S)|0,t=t+Math.imul(v,I)|0,e=(e+Math.imul(v,T)|0)+Math.imul(b,I)|0,$=$+Math.imul(b,T)|0,t=t+Math.imul(_,K)|0,e=(e+Math.imul(_,k)|0)+Math.imul(g,K)|0,$=$+Math.imul(g,k)|0,t=t+Math.imul(y,F)|0,e=(e+Math.imul(y,R)|0)+Math.imul(m,F)|0,$=$+Math.imul(m,R)|0,t=t+Math.imul(p,D)|0,e=(e+Math.imul(p,x)|0)+Math.imul(f,D)|0,$=$+Math.imul(f,x)|0,t=t+Math.imul(d,H)|0,e=(e+Math.imul(d,C)|0)+Math.imul(h,H)|0,$=$+Math.imul(h,C)|0,t=t+Math.imul(l,q)|0,e=(e+Math.imul(l,N)|0)+Math.imul(u,q)|0,$=$+Math.imul(u,N)|0,t=t+Math.imul(c,G)|0,e=(e+Math.imul(c,P)|0)+Math.imul(s,G)|0,$=$+Math.imul(s,P)|0,(O+(t+Math.imul(a,z)|0)|0)+((8191&(e=(e+Math.imul(a,n)|0)+Math.imul(i,z)|0))<<13)|0),E=(O=(($+Math.imul(i,n)|0)+(e>>>13)|0)+(A>>>26)|0,A&=67108863,t=Math.imul(L,M),e=Math.imul(L,S)+Math.imul(r,M)|0,$=Math.imul(r,S),t=t+Math.imul(U,I)|0,e=(e+Math.imul(U,T)|0)+Math.imul(w,I)|0,$=$+Math.imul(w,T)|0,t=t+Math.imul(v,K)|0,e=(e+Math.imul(v,k)|0)+Math.imul(b,K)|0,$=$+Math.imul(b,k)|0,t=t+Math.imul(_,F)|0,e=(e+Math.imul(_,R)|0)+Math.imul(g,F)|0,$=$+Math.imul(g,R)|0,t=t+Math.imul(y,D)|0,e=(e+Math.imul(y,x)|0)+Math.imul(m,D)|0,$=$+Math.imul(m,x)|0,t=t+Math.imul(p,H)|0,e=(e+Math.imul(p,C)|0)+Math.imul(f,H)|0,$=$+Math.imul(f,C)|0,t=t+Math.imul(d,q)|0,e=(e+Math.imul(d,N)|0)+Math.imul(h,q)|0,$=$+Math.imul(h,N)|0,t=t+Math.imul(l,G)|0,e=(e+Math.imul(l,P)|0)+Math.imul(u,G)|0,$=$+Math.imul(u,P)|0,(O+(t+Math.imul(c,z)|0)|0)+((8191&(e=(e+Math.imul(c,n)|0)+Math.imul(s,z)|0))<<13)|0),a=(O=(($+Math.imul(s,n)|0)+(e>>>13)|0)+(E>>>26)|0,E&=67108863,t=Math.imul(L,I),e=Math.imul(L,T)+Math.imul(r,I)|0,$=Math.imul(r,T),t=t+Math.imul(U,K)|0,e=(e+Math.imul(U,k)|0)+Math.imul(w,K)|0,$=$+Math.imul(w,k)|0,t=t+Math.imul(v,F)|0,e=(e+Math.imul(v,R)|0)+Math.imul(b,F)|0,$=$+Math.imul(b,R)|0,t=t+Math.imul(_,D)|0,e=(e+Math.imul(_,x)|0)+Math.imul(g,D)|0,$=$+Math.imul(g,x)|0,t=t+Math.imul(y,H)|0,e=(e+Math.imul(y,C)|0)+Math.imul(m,H)|0,$=$+Math.imul(m,C)|0,t=t+Math.imul(p,q)|0,e=(e+Math.imul(p,N)|0)+Math.imul(f,q)|0,$=$+Math.imul(f,N)|0,t=t+Math.imul(d,G)|0,e=(e+Math.imul(d,P)|0)+Math.imul(h,G)|0,$=$+Math.imul(h,P)|0,(O+(t+Math.imul(l,z)|0)|0)+((8191&(e=(e+Math.imul(l,n)|0)+Math.imul(u,z)|0))<<13)|0),i=(O=(($+Math.imul(u,n)|0)+(e>>>13)|0)+(a>>>26)|0,a&=67108863,t=Math.imul(L,K),e=Math.imul(L,k)+Math.imul(r,K)|0,$=Math.imul(r,k),t=t+Math.imul(U,F)|0,e=(e+Math.imul(U,R)|0)+Math.imul(w,F)|0,$=$+Math.imul(w,R)|0,t=t+Math.imul(v,D)|0,e=(e+Math.imul(v,x)|0)+Math.imul(b,D)|0,$=$+Math.imul(b,x)|0,t=t+Math.imul(_,H)|0,e=(e+Math.imul(_,C)|0)+Math.imul(g,H)|0,$=$+Math.imul(g,C)|0,t=t+Math.imul(y,q)|0,e=(e+Math.imul(y,N)|0)+Math.imul(m,q)|0,$=$+Math.imul(m,N)|0,t=t+Math.imul(p,G)|0,e=(e+Math.imul(p,P)|0)+Math.imul(f,G)|0,$=$+Math.imul(f,P)|0,(O+(t+Math.imul(d,z)|0)|0)+((8191&(e=(e+Math.imul(d,n)|0)+Math.imul(h,z)|0))<<13)|0),M=(O=(($+Math.imul(h,n)|0)+(e>>>13)|0)+(i>>>26)|0,i&=67108863,t=Math.imul(L,F),e=Math.imul(L,R)+Math.imul(r,F)|0,$=Math.imul(r,R),t=t+Math.imul(U,D)|0,e=(e+Math.imul(U,x)|0)+Math.imul(w,D)|0,$=$+Math.imul(w,x)|0,t=t+Math.imul(v,H)|0,e=(e+Math.imul(v,C)|0)+Math.imul(b,H)|0,$=$+Math.imul(b,C)|0,t=t+Math.imul(_,q)|0,e=(e+Math.imul(_,N)|0)+Math.imul(g,q)|0,$=$+Math.imul(g,N)|0,t=t+Math.imul(y,G)|0,e=(e+Math.imul(y,P)|0)+Math.imul(m,G)|0,$=$+Math.imul(m,P)|0,(O+(t+Math.imul(p,z)|0)|0)+((8191&(e=(e+Math.imul(p,n)|0)+Math.imul(f,z)|0))<<13)|0),S=(O=(($+Math.imul(f,n)|0)+(e>>>13)|0)+(M>>>26)|0,M&=67108863,t=Math.imul(L,D),e=Math.imul(L,x)+Math.imul(r,D)|0,$=Math.imul(r,x),t=t+Math.imul(U,H)|0,e=(e+Math.imul(U,C)|0)+Math.imul(w,H)|0,$=$+Math.imul(w,C)|0,t=t+Math.imul(v,q)|0,e=(e+Math.imul(v,N)|0)+Math.imul(b,q)|0,$=$+Math.imul(b,N)|0,t=t+Math.imul(_,G)|0,e=(e+Math.imul(_,P)|0)+Math.imul(g,G)|0,$=$+Math.imul(g,P)|0,(O+(t+Math.imul(y,z)|0)|0)+((8191&(e=(e+Math.imul(y,n)|0)+Math.imul(m,z)|0))<<13)|0),c=(O=(($+Math.imul(m,n)|0)+(e>>>13)|0)+(S>>>26)|0,S&=67108863,t=Math.imul(L,H),e=Math.imul(L,C)+Math.imul(r,H)|0,$=Math.imul(r,C),t=t+Math.imul(U,q)|0,e=(e+Math.imul(U,N)|0)+Math.imul(w,q)|0,$=$+Math.imul(w,N)|0,t=t+Math.imul(v,G)|0,e=(e+Math.imul(v,P)|0)+Math.imul(b,G)|0,$=$+Math.imul(b,P)|0,(O+(t+Math.imul(_,z)|0)|0)+((8191&(e=(e+Math.imul(_,n)|0)+Math.imul(g,z)|0))<<13)|0),s=(O=(($+Math.imul(g,n)|0)+(e>>>13)|0)+(c>>>26)|0,c&=67108863,t=Math.imul(L,q),e=Math.imul(L,N)+Math.imul(r,q)|0,$=Math.imul(r,N),t=t+Math.imul(U,G)|0,e=(e+Math.imul(U,P)|0)+Math.imul(w,G)|0,$=$+Math.imul(w,P)|0,(O+(t+Math.imul(v,z)|0)|0)+((8191&(e=(e+Math.imul(v,n)|0)+Math.imul(b,z)|0))<<13)|0),I=(O=(($+Math.imul(b,n)|0)+(e>>>13)|0)+(s>>>26)|0,s&=67108863,t=Math.imul(L,G),e=Math.imul(L,P)+Math.imul(r,G)|0,$=Math.imul(r,P),(O+(t+Math.imul(U,z)|0)|0)+((8191&(e=(e+Math.imul(U,n)|0)+Math.imul(w,z)|0))<<13)|0),T=(O=(($+Math.imul(w,n)|0)+(e>>>13)|0)+(I>>>26)|0,I&=67108863,(O+Math.imul(L,z)|0)+((8191&(e=Math.imul(L,n)+Math.imul(r,z)|0))<<13)|0);return O=(Math.imul(r,n)+(e>>>13)|0)+(T>>>26)|0,T&=67108863,o[0]=B,o[1]=W,o[2]=X,o[3]=J,o[4]=V,o[5]=Y,o[6]=Z,o[7]=Q,o[8]=ee,o[9]=A,o[10]=E,o[11]=a,o[12]=i,o[13]=M,o[14]=S,o[15]=c,o[16]=s,o[17]=I,o[18]=T,0!=O&&(o[19]=O,j.length++),j};function l(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,o=0,i=0;i<r.length-1;i++){for(var a=o,o=0,s=67108863&n,c=Math.min(i,t.length-1),u=Math.max(0,i-e.length+1);u<=c;u++){var l,h=(0|e.words[i-u])*(0|t.words[u]),s=67108863&(l=(67108863&h)+s|0);o+=(a=(a=a+(h/67108864|0)|0)+(l>>>26)|0)>>>26,a&=67108863}r.words[i]=s,n=a,a=o}return 0!==n?r.words[i]=n:r.length--,r._strip()}function g(e,t,r){return l(e,t,r)}Math.imul||(u=c),y.prototype.mulTo=function(e,t){var r=this.length+e.length,r=(10===this.length&&10===e.length?u:r<63?c:r<1024?l:g)(this,e,t);return r},y.prototype.mul=function(e){var t=new y(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},y.prototype.mulf=function(e){var t=new y(null);return t.words=new Array(this.length+e.length),g(this,e,t)},y.prototype.imul=function(e){return this.clone().mulTo(e,this)},y.prototype.imuln=function(e){for(var t=e<0,r=(m("number"==typeof(e=t?-e:e)),m(e<67108864),0),n=0;n<this.length;n++){var o=(0|this.words[n])*e,i=(67108863&o)+(67108863&r),r=(r>>=26)+(o/67108864|0)+(i>>>26);this.words[n]=67108863&i}return 0!==r&&(this.words[n]=r,this.length++),t?this.ineg():this},y.prototype.muln=function(e){return this.clone().imuln(e)},y.prototype.sqr=function(){return this.mul(this)},y.prototype.isqr=function(){return this.imul(this.clone())},y.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++)t[r]=e.words[r/26|0]>>>r%26&1;return t}(e);if(0===t.length)return new y(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var o=r.sqr();n<t.length;n++,o=o.sqr())0!==t[n]&&(r=r.mul(o));return r},y.prototype.iushln=function(e){m("number"==typeof e&&0<=e);var t=e%26,r=(e-t)/26,n=67108863>>>26-t<<26-t;if(0!=t){for(var o=0,i=0;i<this.length;i++){var a=this.words[i]&n,s=(0|this.words[i])-a<<t;this.words[i]=s|o,o=a>>>26-t}o&&(this.words[i]=o,this.length++)}if(0!=r){for(i=this.length-1;0<=i;i--)this.words[i+r]=this.words[i];for(i=0;i<r;i++)this.words[i]=0;this.length+=r}return this._strip()},y.prototype.ishln=function(e){return m(0===this.negative),this.iushln(e)},y.prototype.iushrn=function(e,t,r){m("number"==typeof e&&0<=e),n=t?(t-t%26)/26:0;var n,o=e%26,i=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,s=r;if(n-=i,n=Math.max(0,n),s){for(var c=0;c<i;c++)s.words[c]=this.words[c];s.length=i}if(0!==i)if(this.length>i)for(this.length-=i,c=0;c<this.length;c++)this.words[c]=this.words[c+i];else this.words[0]=0,this.length=1;for(var u=0,c=this.length-1;0<=c&&(0!==u||n<=c);c--){var l=0|this.words[c];this.words[c]=u<<26-o|l>>>o,u=l&a}return s&&0!==u&&(s.words[s.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},y.prototype.ishrn=function(e,t,r){return m(0===this.negative),this.iushrn(e,t,r)},y.prototype.shln=function(e){return this.clone().ishln(e)},y.prototype.ushln=function(e){return this.clone().iushln(e)},y.prototype.shrn=function(e){return this.clone().ishrn(e)},y.prototype.ushrn=function(e){return this.clone().iushrn(e)},y.prototype.testn=function(e){m("number"==typeof e&&0<=e);var t=e%26,e=(e-t)/26;return!(this.length<=e)&&!!(this.words[e]&1<<t)},y.prototype.imaskn=function(e){m("number"==typeof e&&0<=e);var t=e%26,e=(e-t)/26;return m(0===this.negative,"imaskn works only with positive numbers"),this.length<=e?this:(0!=t&&e++,this.length=Math.min(e,this.length),0!=t&&(this.words[this.length-1]&=67108863^67108863>>>t<<t),this._strip())},y.prototype.maskn=function(e){return this.clone().imaskn(e)},y.prototype.iaddn=function(e){return m("number"==typeof e),m(e<67108864),e<0?this.isubn(-e):0!==this.negative?(1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(e),this.negative=1),this):this._iaddn(e)},y.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&67108864<=this.words[t];t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},y.prototype.isubn=function(e){if(m("number"==typeof e),m(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,--this.words[t+1];return this._strip()},y.prototype.addn=function(e){return this.clone().iaddn(e)},y.prototype.subn=function(e){return this.clone().isubn(e)},y.prototype.iabs=function(){return this.negative=0,this},y.prototype.abs=function(){return this.clone().iabs()},y.prototype._ishlnsubmul=function(e,t,r){for(var n=e.length+r,o=(this._expand(n),0),i=0;i<e.length;i++){var a=(0|this.words[i+r])+o,s=(0|e.words[i])*t,o=((a-=67108863&s)>>26)-(s/67108864|0);this.words[i+r]=67108863&a}for(;i<this.length-r;i++)o=(a=(0|this.words[i+r])+o)>>26,this.words[i+r]=67108863&a;if(0===o)return this._strip();for(m(-1===o),i=o=0;i<this.length;i++)o=(a=-(0|this.words[i])+o)>>26,this.words[i]=67108863&a;return this.negative=1,this._strip()},y.prototype._wordDiv=function(e,t){this.length,e.length;var r,n=this.clone(),o=e,i=0|o.words[o.length-1],a=(0!=(e=26-this._countBits(i))&&(o=o.ushln(e),n.iushln(e),i=0|o.words[o.length-1]),n.length-o.length);if("mod"!==t){(r=new y(null)).length=1+a,r.words=new Array(r.length);for(var s=0;s<r.length;s++)r.words[s]=0}var c=n.clone()._ishlnsubmul(o,1,a);0===c.negative&&(n=c,r&&(r.words[a]=1));for(var u=a-1;0<=u;u--){var l=67108864*(0|n.words[o.length+u])+(0|n.words[o.length+u-1]),l=Math.min(l/i|0,67108863);for(n._ishlnsubmul(o,l,u);0!==n.negative;)l--,n.negative=0,n._ishlnsubmul(o,1,u),n.isZero()||(n.negative^=1);r&&(r.words[u]=l)}return r&&r._strip(),n._strip(),"div"!==t&&0!=e&&n.iushrn(e),{div:r||null,mod:n}},y.prototype.divmod=function(e,t,r){return m(!e.isZero()),this.isZero()?{div:new y(0),mod:new y(0)}:0!==this.negative&&0===e.negative?(i=this.neg().divmod(e,t),"mod"!==t&&(n=i.div.neg()),"div"!==t&&(o=i.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:n,mod:o}):0===this.negative&&0!==e.negative?(i=this.divmod(e.neg(),t),{div:n="mod"!==t?i.div.neg():n,mod:i.mod}):0!=(this.negative&e.negative)?(i=this.neg().divmod(e.neg(),t),"div"!==t&&(o=i.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:i.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new y(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new y(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new y(this.modrn(e.words[0]))}:this._wordDiv(e,t);var n,o,i},y.prototype.div=function(e){return this.divmod(e,"div",!1).div},y.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},y.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},y.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),e=e.andln(1),r=r.cmp(n);return r<0||1===e&&0===r?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},y.prototype.modrn=function(e){for(var t=e<0,r=(m((e=t?-e:e)<=67108863),(1<<26)%e),n=0,o=this.length-1;0<=o;o--)n=(r*n+(0|this.words[o]))%e;return t?-n:n},y.prototype.modn=function(e){return this.modrn(e)},y.prototype.idivn=function(e){for(var t=e<0,r=(m((e=t?-e:e)<=67108863),0),n=this.length-1;0<=n;n--){var o=(0|this.words[n])+67108864*r;this.words[n]=o/e|0,r=o%e}return this._strip(),t?this.ineg():this},y.prototype.divn=function(e){return this.clone().idivn(e)},y.prototype.egcd=function(e){m(0===e.negative),m(!e.isZero());for(var t=this,r=e.clone(),t=0!==t.negative?t.umod(e):t.clone(),n=new y(1),o=new y(0),i=new y(0),a=new y(1),s=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++s;for(var c=r.clone(),u=t.clone();!t.isZero();){for(var l=0,h=1;0==(t.words[0]&h)&&l<26;++l,h<<=1);if(0<l)for(t.iushrn(l);0<l--;)(n.isOdd()||o.isOdd())&&(n.iadd(c),o.isub(u)),n.iushrn(1),o.iushrn(1);for(var d=0,f=1;0==(r.words[0]&f)&&d<26;++d,f<<=1);if(0<d)for(r.iushrn(d);0<d--;)(i.isOdd()||a.isOdd())&&(i.iadd(c),a.isub(u)),i.iushrn(1),a.iushrn(1);0<=t.cmp(r)?(t.isub(r),n.isub(i),o.isub(a)):(r.isub(t),i.isub(n),a.isub(o))}return{a:i,b:a,gcd:r.iushln(s)}},y.prototype._invmp=function(e){m(0===e.negative),m(!e.isZero());for(var t,r=this,n=e.clone(),r=0!==r.negative?r.umod(e):r.clone(),o=new y(1),i=new y(0),a=n.clone();0<r.cmpn(1)&&0<n.cmpn(1);){for(var s=0,c=1;0==(r.words[0]&c)&&s<26;++s,c<<=1);if(0<s)for(r.iushrn(s);0<s--;)o.isOdd()&&o.iadd(a),o.iushrn(1);for(var u=0,l=1;0==(n.words[0]&l)&&u<26;++u,l<<=1);if(0<u)for(n.iushrn(u);0<u--;)i.isOdd()&&i.iadd(a),i.iushrn(1);0<=r.cmp(n)?(r.isub(n),o.isub(i)):(n.isub(r),i.isub(o))}return(t=0===r.cmpn(1)?o:i).cmpn(0)<0&&t.iadd(e),t},y.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0;for(var n=r.negative=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var o=t.cmp(r);if(o<0)var i=t,t=r,r=i;else if(0===o||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},y.prototype.invm=function(e){return this.egcd(e).a.umod(e)},y.prototype.isEven=function(){return 0==(1&this.words[0])},y.prototype.isOdd=function(){return 1==(1&this.words[0])},y.prototype.andln=function(e){return this.words[0]&e},y.prototype.bincn=function(e){m("number"==typeof e);var t=e%26,e=(e-t)/26,t=1<<t;if(this.length<=e)return this._expand(1+e),this.words[e]|=t,this;for(var r=t,n=e;0!==r&&n<this.length;n++){var o=0|this.words[n],r=(o+=r)>>>26;o&=67108863,this.words[n]=o}return 0!==r&&(this.words[n]=r,this.length++),this},y.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},y.prototype.cmpn=function(e){var t=e<0;return 0===this.negative||t?0===this.negative&&t?1:(this._strip(),t=1<this.length?1:(m((e=t?-e:e)<=67108863,"Number is too big"),(t=0|this.words[0])===e?0:t<e?-1:1),0!==this.negative?0|-t:t):-1},y.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;e=this.ucmp(e);return 0!==this.negative?0|-e:e},y.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;0<=r;r--){var n=0|this.words[r],o=0|e.words[r];if(n!=o){n<o?t=-1:o<n&&(t=1);break}}return t},y.prototype.gtn=function(e){return 1===this.cmpn(e)},y.prototype.gt=function(e){return 1===this.cmp(e)},y.prototype.gten=function(e){return 0<=this.cmpn(e)},y.prototype.gte=function(e){return 0<=this.cmp(e)},y.prototype.ltn=function(e){return-1===this.cmpn(e)},y.prototype.lt=function(e){return-1===this.cmp(e)},y.prototype.lten=function(e){return this.cmpn(e)<=0},y.prototype.lte=function(e){return this.cmp(e)<=0},y.prototype.eqn=function(e){return 0===this.cmpn(e)},y.prototype.eq=function(e){return 0===this.cmp(e)},y.red=function(e){return new S(e)},y.prototype.toRed=function(e){return m(!this.red,"Already a number in reduction context"),m(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},y.prototype.fromRed=function(){return m(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},y.prototype._forceRed=function(e){return this.red=e,this},y.prototype.forceRed=function(e){return m(!this.red,"Already a number in reduction context"),this._forceRed(e)},y.prototype.redAdd=function(e){return m(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},y.prototype.redIAdd=function(e){return m(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},y.prototype.redSub=function(e){return m(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},y.prototype.redISub=function(e){return m(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},y.prototype.redShl=function(e){return m(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},y.prototype.redMul=function(e){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},y.prototype.redIMul=function(e){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},y.prototype.redSqr=function(){return m(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},y.prototype.redISqr=function(){return m(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},y.prototype.redSqrt=function(){return m(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},y.prototype.redInvm=function(){return m(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},y.prototype.redNeg=function(){return m(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},y.prototype.redPow=function(e){return m(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var _={k256:null,p224:null,p192:null,p25519:null};function b(e,t){this.name=e,this.p=new y(t,16),this.n=this.p.bitLength(),this.k=new y(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function w(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function E(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){var t;"string"==typeof e?(t=y._prime(e),this.m=t.p,this.prime=t):(m(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null)}function M(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new y(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var e=new y(null);return e.words=new Array(Math.ceil(this.n/13)),e},b.prototype.ireduce=function(e){for(var t,r=e;this.split(r,this.tmp),(t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength())>this.n;);e=t<this.n?-1:r.ucmp(this.p);return 0===e?(r.words[0]=0,r.length=1):0<e?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},b.prototype.split=function(e,t){e.iushrn(this.n,0,t)},b.prototype.imulK=function(e){return e.imul(this.k)},n(v,b),v.prototype.split=function(e,t){for(var r=Math.min(e.length,9),n=0;n<r;n++)t.words[n]=e.words[n];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=4194303&o,n=10;n<e.length;n++){var i=0|e.words[n];e.words[n-10]=(4194303&i)<<4|o>>>22,o=i}0===(e.words[n-10]=o>>>=22)&&10<e.length?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(w,b),n(E,b),n(A,b),A.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,o=67108863&n;n>>>=26,e.words[r]=o,t=n}return 0!==t&&(e.words[e.length++]=t),e},y._prime=function(e){if(_[e])return _[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new w;else if("p192"===e)t=new E;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new A}return _[e]=t},S.prototype._verify1=function(e){m(0===e.negative,"red works only with positives"),m(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){m(0==(e.negative|t.negative),"red works only with positives"),m(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(i(e,e.umod(this.m)._forceRed(this)),e)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);e=e.add(t);return 0<=e.cmp(this.m)&&e.isub(this.m),e._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);e=e.iadd(t);return 0<=e.cmp(this.m)&&e.isub(this.m),e},S.prototype.sub=function(e,t){this._verify2(e,t);e=e.sub(t);return e.cmpn(0)<0&&e.iadd(this.m),e._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);e=e.isub(t);return e.cmpn(0)<0&&e.iadd(this.m),e},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(m(t%2==1),3===t)return t=this.m.add(new y(1)).iushrn(2),this.pow(e,t);for(var r=this.m.subn(1),n=0;!r.isZero()&&0===r.andln(1);)n++,r.iushrn(1);m(!r.isZero());for(var o=new y(1).toRed(this),i=o.redNeg(),a=this.m.subn(1).iushrn(1),s=new y(2*(s=this.m.bitLength())*s).toRed(this);0!==this.pow(s,a).cmp(i);)s.redIAdd(i);for(var c=this.pow(s,r),u=this.pow(e,r.addn(1).iushrn(1)),l=this.pow(e,r),h=n;0!==l.cmp(o);){for(var d=l,f=0;0!==d.cmp(o);f++)d=d.redSqr();m(f<h);var p=this.pow(c,new y(1).iushln(h-f-1)),u=u.redMul(p),c=p.redSqr(),l=l.redMul(c),h=f}return u},S.prototype.invm=function(e){e=e._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},S.prototype.pow=function(e,t){if(t.isZero())return new y(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new y(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var o=r[0],i=0,a=0,s=t.bitLength()%26;for(0===s&&(s=26),n=t.length-1;0<=n;n--){for(var c=t.words[n],u=s-1;0<=u;u--){var l=c>>u&1;o!==r[0]&&(o=this.sqr(o)),0==l&&0===i?a=0:(i=i<<1|l,(4===++a||0===n&&0===u)&&(o=this.mul(o,r[i]),i=a=0))}s=26}return o},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){e=e.clone();return e.red=null,e},y.mont=function(e){return new M(e)},n(M,S),M.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},M.prototype.convertFrom=function(e){e=this.imod(e.mul(this.rinv));return e.red=null,e},M.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;e=e.imul(t),t=e.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=e.isub(t).iushrn(this.shift),t=e;return 0<=e.cmp(this.m)?t=e.isub(this.m):e.cmpn(0)<0&&(t=e.iadd(this.m)),t._forceRed(this)},M.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new y(0)._forceRed(this);e=e.mul(t),t=e.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=e.isub(t).iushrn(this.shift),t=e;return 0<=e.cmp(this.m)?t=e.isub(this.m):e.cmpn(0)<0&&(t=e.iadd(this.m)),t._forceRed(this)},M.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(bn),{exports:{}}),_Buffer=(!function(e,t){var r=require$$0__default$1.default,n=r.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function i(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=i),i.prototype=Object.create(n.prototype),o(n,i),i.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},i.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=n(e);return void 0!==t?"string"==typeof r?e.fill(t,r):e.fill(t):e.fill(0),e},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(safeBuffer,safeBuffer.exports),safeBuffer.exports.Buffer);function base(d){if(255<=d.length)throw new TypeError("Alphabet too long");for(var f=new Uint8Array(256),e=0;e<f.length;e++)f[e]=255;for(var t=0;t<d.length;t++){var r=d.charAt(t),n=r.charCodeAt(0);if(255!==f[n])throw new TypeError(r+" is ambiguous");f[n]=t}var p=d.length,m=d.charAt(0),y=Math.log(p)/Math.log(256),g=Math.log(256)/Math.log(p);function o(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return _Buffer.alloc(0);var t=0;if(" "!==e[t]){for(var r=0,n=0;e[t]===m;)r++,t++;for(var o=(e.length-t)*y+1>>>0,i=new Uint8Array(o);e[t];){var a=f[e.charCodeAt(t)];if(255===a)return;for(var s=0,c=o-1;(0!==a||s<n)&&-1!==c;c--,s++)a+=p*i[c]>>>0,i[c]=a%256>>>0,a=a/256>>>0;if(0!==a)throw new Error("Non-zero carry");n=s,t++}if(" "!==e[t]){for(var u=o-n;u!==o&&0===i[u];)u++;for(var l=_Buffer.allocUnsafe(r+(o-u)),h=(l.fill(0,0,r),r);u!==o;)l[h++]=i[u++];return l}}}return{encode:function(e){if((Array.isArray(e)||e instanceof Uint8Array)&&(e=_Buffer.from(e)),!_Buffer.isBuffer(e))throw new TypeError("Expected Buffer");if(0===e.length)return"";for(var t=0,r=0,n=0,o=e.length;n!==o&&0===e[n];)n++,t++;for(var i=(o-n)*g+1>>>0,a=new Uint8Array(i);n!==o;){for(var s=e[n],c=0,u=i-1;(0!==s||c<r)&&-1!==u;u--,c++)s+=256*a[u]>>>0,a[u]=s%p>>>0,s=s/p>>>0;if(0!==s)throw new Error("Non-zero carry");r=c,n++}for(var l=i-r;l!==i&&0===a[l];)l++;for(var h=m.repeat(t);l<i;++l)h+=d.charAt(a[l]);return h},decodeUnsafe:o,decode:function(e){if(e=o(e))return e;throw new Error("Non-base"+p+" character")}}}var src=base,basex=src,ALPHABET="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",bs58=basex(ALPHABET);function inRange(e,t,r){return t<=e&&e<=r}function ToDictionary(e){if(void 0===e)return{};if(e===Object(e))return e;throw TypeError("Could not convert argument to dictionary")}function stringToCodePoints(e){for(var t=String(e),r=t.length,n=0,o=[];n<r;){var i,a=t.charCodeAt(n);a<55296||57343<a?o.push(a):56320<=a&&a<=57343?o.push(65533):55296<=a&&a<=56319&&(n!==r-1&&56320<=(i=e.charCodeAt(n+1))&&i<=57343?(o.push(65536+((1023&a)<<10)+(1023&i)),n+=1):o.push(65533)),n+=1}return o}function codePointsToString(e){for(var t="",r=0;r<e.length;++r){var n=e[r];n<=65535?t+=String.fromCharCode(n):(n-=65536,t+=String.fromCharCode(55296+(n>>10),56320+(1023&n)))}return t}var end_of_stream=-1;function Stream(e){this.tokens=[].slice.call(e)}Stream.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():end_of_stream},prepend:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(e)},push:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.push(t.shift());else this.tokens.push(e)}};var finished=-1;function decoderError(e,t){if(e)throw TypeError("Decoder error");return t||65533}var DEFAULT_ENCODING="utf-8";function TextDecoder$1(e,t){if(!(this instanceof TextDecoder$1))return new TextDecoder$1(e,t);if((e=void 0!==e?String(e).toLowerCase():DEFAULT_ENCODING)!==DEFAULT_ENCODING)throw new Error("Encoding not supported. Only utf-8 is supported");t=ToDictionary(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(t.fatal),this._ignoreBOM=Boolean(t.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}function TextEncoder(e,t){if(!(this instanceof TextEncoder))return new TextEncoder(e,t);if((e=void 0!==e?String(e).toLowerCase():DEFAULT_ENCODING)!==DEFAULT_ENCODING)throw new Error("Encoding not supported. Only utf-8 is supported");t=ToDictionary(t),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(t.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}function UTF8Decoder(e){var r=e.fatal,n=0,o=0,i=0,a=128,s=191;this.handler=function(e,t){if(t===end_of_stream&&0!==i)return i=0,decoderError(r);if(t===end_of_stream)return finished;if(0===i){if(inRange(t,0,127))return t;if(inRange(t,194,223))i=1,n=t-192;else if(inRange(t,224,239))224===t&&(a=160),237===t&&(s=159),i=2,n=t-224;else{if(!inRange(t,240,244))return decoderError(r);240===t&&(a=144),244===t&&(s=143),i=3,n=t-240}return n<<=6*i,null}if(!inRange(t,a,s))return n=i=o=0,a=128,s=191,e.prepend(t),decoderError(r);if(s=191,n+=t-(a=128)<<6*(i-(o+=1)),o!==i)return null;e=n;return n=i=o=0,e}}function UTF8Encoder(e){e.fatal,this.handler=function(e,t){if(t===end_of_stream)return finished;if(inRange(t,0,127))return t;inRange(t,128,2047)?(r=1,n=192):inRange(t,2048,65535)?(r=2,n=224):inRange(t,65536,1114111)&&(r=3,n=240);for(var r,n,o=[(t>>6*r)+n];0<r;)o.push(128|63&t>>6*(r-1)),--r;return o}}TextDecoder$1.prototype={decode:function(e,t){e="object"==typeof e&&e instanceof ArrayBuffer?new Uint8Array(e):"object"==typeof e&&"buffer"in e&&e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(0);t=ToDictionary(t),this._streaming||(this._decoder=new UTF8Decoder({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(t.stream);for(var r,n=new Stream(e),o=[];!n.endOfStream()&&(r=this._decoder.handler(n,n.read()))!==finished;)null!==r&&(Array.isArray(r)?o.push.apply(o,r):o.push(r));if(!this._streaming){for(;(r=this._decoder.handler(n,n.read()))!==finished&&(null!==r&&(Array.isArray(r)?o.push.apply(o,r):o.push(r)),!n.endOfStream()););this._decoder=null}return!o.length||-1===["utf-8"].indexOf(this.encoding)||this._ignoreBOM||this._BOMseen||(65279===o[0]?(this._BOMseen=!0,o.shift()):this._BOMseen=!0),codePointsToString(o)}},TextEncoder.prototype={encode:function(e,t){e=e?String(e):"",t=ToDictionary(t),this._streaming||(this._encoder=new UTF8Encoder(this._options)),this._streaming=Boolean(t.stream);for(var r,n=[],o=new Stream(stringToCodePoints(e));!o.endOfStream()&&(r=this._encoder.handler(o,o.read()))!==finished;)Array.isArray(r)?n.push.apply(n,r):n.push(r);if(!this._streaming){for(;;){if((r=this._encoder.handler(o,o.read()))===finished)break;Array.isArray(r)?n.push.apply(n,r):n.push(r)}this._encoder=null}return new Uint8Array(n)}};var encoding_lib=Object.freeze({__proto__:null,TextEncoder:TextEncoder,TextDecoder:TextDecoder$1}),require$$2$1=getAugmentedNamespace(encoding_lib),__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__decorate=commonjsGlobal&&commonjsGlobal.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(i<3?o(a):3<i?o(t,r,a):o(t,r))||a);return 3<i&&a&&Object.defineProperty(t,r,a),a},__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__importDefault$c=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lib$1,"__esModule",{value:!0}),lib$1.deserializeUnchecked=lib$1.deserialize=lib$1.serialize=lib$1.BinaryReader=lib$1.BinaryWriter=lib$1.BorshError=lib$1.baseDecode=lib$1.baseEncode=void 0;const bn_js_1$5=__importDefault$c(bn.exports),bs58_1=__importDefault$c(bs58),encoding=__importStar(require$$2$1),ResolvedTextDecoder="function"!=typeof TextDecoder?encoding.TextDecoder:TextDecoder,textDecoder=new ResolvedTextDecoder("utf-8",{fatal:!0});function baseEncode(e){return"string"==typeof e&&(e=Buffer.from(e,"utf8")),bs58_1.default.encode(Buffer.from(e))}function baseDecode(e){return Buffer.from(bs58_1.default.decode(e))}lib$1.baseEncode=baseEncode,lib$1.baseDecode=baseDecode;const INITIAL_LENGTH=1024;class BorshError extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}lib$1.BorshError=BorshError;class BinaryWriter{constructor(){this.buf=Buffer.alloc(INITIAL_LENGTH),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=Buffer.concat([this.buf,Buffer.alloc(INITIAL_LENGTH)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(Buffer.from(new bn_js_1$5.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(Buffer.from(new bn_js_1$5.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(Buffer.from(new bn_js_1$5.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(Buffer.from(new bn_js_1$5.default(e).toArray("le",64)))}writeBuffer(e){this.buf=Buffer.concat([Buffer.from(this.buf.subarray(0,this.length)),e,Buffer.alloc(INITIAL_LENGTH)]),this.length+=e.length}writeString(e){this.maybeResize();e=Buffer.from(e,"utf8");this.writeU32(e.length),this.writeBuffer(e)}writeFixedArray(e){this.writeBuffer(Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}function handlingRangeError(e,t,r){const n=r.value;r.value=function(...t){try{return n.apply(this,t)}catch(e){if(e instanceof RangeError){t=e.code;if(0<=["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(t))throw new BorshError("Reached the end of buffer when deserializing")}throw e}}}lib$1.BinaryWriter=BinaryWriter;class BinaryReader{constructor(e){this.buf=e,this.offset=0}readU8(){var e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){var e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){var e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){var e=this.readBuffer(8);return new bn_js_1$5.default(e,"le")}readU128(){var e=this.readBuffer(16);return new bn_js_1$5.default(e,"le")}readU256(){var e=this.readBuffer(32);return new bn_js_1$5.default(e,"le")}readU512(){var e=this.readBuffer(64);return new bn_js_1$5.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new BorshError(`Expected buffer length ${e} isn't within bounds`);var t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){var e=this.readU32(),e=this.readBuffer(e);try{return textDecoder.decode(e)}catch(e){throw new BorshError("Error decoding UTF-8 string: "+e)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(t){var r=this.readU32();const n=Array();for(let e=0;e<r;++e)n.push(t());return n}}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function serializeField(r,n,t,o,i){try{if("string"==typeof o)i["write"+capitalizeFirstLetter(o)](t);else if(o instanceof Array)if("number"==typeof o[0]){if(t.length!==o[0])throw new BorshError(`Expecting byte array of length ${o[0]}, but got ${t.length} bytes`);i.writeFixedArray(t)}else if(2===o.length&&"number"==typeof o[1]){if(t.length!==o[1])throw new BorshError(`Expecting byte array of length ${o[1]}, but got ${t.length} bytes`);for(let e=0;e<o[1];e++)serializeField(r,null,t[e],o[0],i)}else i.writeArray(t,e=>{serializeField(r,n,e,o[0],i)});else if(void 0!==o.kind)switch(o.kind){case"option":null==t?i.writeU8(0):(i.writeU8(1),serializeField(r,n,t,o.type,i));break;case"map":i.writeU32(t.size),t.forEach((e,t)=>{serializeField(r,n,t,o.key,i),serializeField(r,n,e,o.value,i)});break;default:throw new BorshError(`FieldType ${o} unrecognized`)}else serializeStruct(r,t,i)}catch(e){throw e instanceof BorshError&&e.addToFieldPath(n),e}}function serializeStruct(r,n,o){if("function"==typeof n.borshSerialize)n.borshSerialize(o);else{const s=r.get(n.constructor);if(!s)throw new BorshError(`Class ${n.constructor.name} is missing in schema`);if("struct"===s.kind)s.fields.map(([e,t])=>{serializeField(r,e,n[e],t,o)});else{if("enum"!==s.kind)throw new BorshError(`Unexpected schema kind: ${s.kind} for `+n.constructor.name);var t=n[s.field];for(let e=0;e<s.values.length;++e){var[i,a]=s.values[e];if(i===t){o.writeU8(e),serializeField(r,i,n[i],a,o);break}}}}}function serialize(e,t,r=BinaryWriter){const n=new r;return serializeStruct(e,t,n),n.toArray()}function deserializeField(r,n,o,i){try{if("string"==typeof o)return i["read"+capitalizeFirstLetter(o)]();if(o instanceof Array){if("number"==typeof o[0])return i.readFixedArray(o[0]);if("number"!=typeof o[1])return i.readArray(()=>deserializeField(r,n,o[0],i));{const t=[];for(let e=0;e<o[1];e++)t.push(deserializeField(r,null,o[0],i));return t}}if("option"===o.kind)return i.readU8()?deserializeField(r,n,o.type,i):void 0;if("map"!==o.kind)return deserializeStruct(r,o,i);{let t=new Map;var a=i.readU32();for(let e=0;e<a;e++){var s=deserializeField(r,n,o.key,i),c=deserializeField(r,n,o.value,i);t.set(s,c)}return t}}catch(e){throw e instanceof BorshError&&e.addToFieldPath(n),e}}function deserializeStruct(e,t,r){if("function"==typeof t.borshDeserialize)return t.borshDeserialize(r);var n=e.get(t);if(!n)throw new BorshError(`Class ${t.name} is missing in schema`);if("struct"===n.kind){const s={};for(var[o,i]of e.get(t).fields)s[o]=deserializeField(e,o,i,r);return new t(s)}if("enum"!==n.kind)throw new BorshError(`Unexpected schema kind: ${n.kind} for `+t.constructor.name);var a=r.readU8();if(a>=n.values.length)throw new BorshError(`Enum index: ${a} is out of range`);var[n,a]=n.values[a];return new t({[n]:deserializeField(e,n,a,r)})}function deserialize(e,t,r,n=BinaryReader){n=new n(r),e=deserializeStruct(e,t,n);if(n.offset<r.length)throw new BorshError(`Unexpected ${r.length-n.offset} bytes after deserialized data`);return e}function deserializeUnchecked(e,t,r,n=BinaryReader){return deserializeStruct(e,t,new n(r))}__decorate([handlingRangeError],BinaryReader.prototype,"readU8",null),__decorate([handlingRangeError],BinaryReader.prototype,"readU16",null),__decorate([handlingRangeError],BinaryReader.prototype,"readU32",null),__decorate([handlingRangeError],BinaryReader.prototype,"readU64",null),__decorate([handlingRangeError],BinaryReader.prototype,"readU128",null),__decorate([handlingRangeError],BinaryReader.prototype,"readU256",null),__decorate([handlingRangeError],BinaryReader.prototype,"readU512",null),__decorate([handlingRangeError],BinaryReader.prototype,"readString",null),__decorate([handlingRangeError],BinaryReader.prototype,"readFixedArray",null),__decorate([handlingRangeError],BinaryReader.prototype,"readArray",null),lib$1.BinaryReader=BinaryReader,lib$1.serialize=serialize,lib$1.deserialize=deserialize,lib$1.deserializeUnchecked=deserializeUnchecked,!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=lib$1;Object.defineProperty(e,"base_encode",{enumerable:!0,get:function(){return t.baseEncode}}),Object.defineProperty(e,"base_decode",{enumerable:!0,get:function(){return t.baseDecode}}),Object.defineProperty(e,"serialize",{enumerable:!0,get:function(){return t.serialize}}),Object.defineProperty(e,"deserialize",{enumerable:!0,get:function(){return t.deserialize}}),Object.defineProperty(e,"BorshError",{enumerable:!0,get:function(){return t.BorshError}}),Object.defineProperty(e,"BinaryWriter",{enumerable:!0,get:function(){return t.BinaryWriter}}),Object.defineProperty(e,"BinaryReader",{enumerable:!0,get:function(){return t.BinaryReader}})}(serialize$1);var enums={};Object.defineProperty(enums,"__esModule",{value:!0}),enums.Assignable=enums.Enum=void 0;class Enum{constructor(t){if(1!==Object.keys(t).length)throw new Error("Enum can only take single value");Object.keys(t).map(e=>{this[e]=t[e],this.enum=e})}}enums.Enum=Enum;class Assignable{constructor(t){Object.keys(t).map(e=>{this[e]=t[e]})}}enums.Assignable=Assignable,!function(e){var t=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.KeyPairEd25519=e.KeyPair=e.PublicKey=e.KeyType=void 0;const r=t(naclFast.exports),n=serialize$1;var o,t=enums;(o=e.KeyType||(e.KeyType={}))[o.ED25519=0]="ED25519";class i extends t.Assignable{static from(e){return"string"==typeof e?i.fromString(e):e}static fromString(e){e=e.split(":");if(1===e.length)return new i({keyType:o.ED25519,data:n.base_decode(e[0])});if(2===e.length)return new i({keyType:function(e){if("ed25519"!==e.toLowerCase())throw new Error("Unknown key type "+e);return o.ED25519}(e[0]),data:n.base_decode(e[1])});throw new Error("Invalid encoded key format, must be <curve>:<encoded key>")}toString(){return function(e){if(e!==o.ED25519)throw new Error("Unknown key type "+e);return"ed25519"}(this.keyType)+":"+n.base_encode(this.data)}verify(e,t){if(this.keyType!==o.ED25519)throw new Error("Unknown key type "+this.keyType);return r.default.sign.detached.verify(e,t,this.data)}}e.PublicKey=i;class a{static fromRandom(e){if("ED25519"!==e.toUpperCase())throw new Error("Unknown curve "+e);return s.fromRandom()}static fromString(e){const t=e.split(":");if(1===t.length)return new s(t[0]);if(2!==t.length)throw new Error("Invalid encoded key format, must be <curve>:<encoded key>");if("ED25519"!==t[0].toUpperCase())throw new Error("Unknown curve: "+t[0]);return new s(t[1])}}class s extends(e.KeyPair=a){constructor(e){super();var t=r.default.sign.keyPair.fromSecretKey(n.base_decode(e));this.publicKey=new i({keyType:o.ED25519,data:t.publicKey}),this.secretKey=e}static fromRandom(){var e=r.default.sign.keyPair();return new s(n.base_encode(e.secretKey))}sign(e){return{signature:r.default.sign.detached(e,n.base_decode(this.secretKey)),publicKey:this.publicKey}}verify(e,t){return this.publicKey.verify(e,t)}toString(){return"ed25519:"+this.secretKey}getPublicKey(){return this.publicKey}}e.KeyPairEd25519=s}(key_pair),Object.defineProperty(in_memory_key_store,"__esModule",{value:!0}),in_memory_key_store.InMemoryKeyStore=void 0;const keystore_1$3=keystore,key_pair_1$4=key_pair;class InMemoryKeyStore extends keystore_1$3.KeyStore{constructor(){super(),this.keys={}}async setKey(e,t,r){this.keys[t+":"+e]=r.toString()}async getKey(e,t){t=this.keys[t+":"+e];return t?key_pair_1$4.KeyPair.fromString(t):null}async removeKey(e,t){delete this.keys[t+":"+e]}async clear(){this.keys={}}async getNetworks(){const t=new Set;return Object.keys(this.keys).forEach(e=>{e=e.split(":");t.add(e[1])}),Array.from(t.values())}async getAccounts(r){const n=new Array;return Object.keys(this.keys).forEach(e=>{const t=e.split(":");t[t.length-1]===r&&n.push(t.slice(0,t.length-1).join(":"))}),n}toString(){return"InMemoryKeyStore"}}in_memory_key_store.InMemoryKeyStore=InMemoryKeyStore;var browser_local_storage_key_store={};Object.defineProperty(browser_local_storage_key_store,"__esModule",{value:!0}),browser_local_storage_key_store.BrowserLocalStorageKeyStore=void 0;const keystore_1$2=keystore,key_pair_1$3=key_pair,LOCAL_STORAGE_KEY_PREFIX="near-api-js:keystore:";class BrowserLocalStorageKeyStore extends keystore_1$2.KeyStore{constructor(e=window.localStorage,t=LOCAL_STORAGE_KEY_PREFIX){super(),this.localStorage=e,this.prefix=t}async setKey(e,t,r){this.localStorage.setItem(this.storageKeyForSecretKey(e,t),r.toString())}async getKey(e,t){e=this.localStorage.getItem(this.storageKeyForSecretKey(e,t));return e?key_pair_1$3.KeyPair.fromString(e):null}async removeKey(e,t){this.localStorage.removeItem(this.storageKeyForSecretKey(e,t))}async clear(){for(const e of this.storageKeys())e.startsWith(this.prefix)&&this.localStorage.removeItem(e)}async getNetworks(){const e=new Set;for(const r of this.storageKeys()){var t;r.startsWith(this.prefix)&&(t=r.substring(this.prefix.length).split(":"),e.add(t[1]))}return Array.from(e.values())}async getAccounts(e){const t=new Array;for(const n of this.storageKeys()){var r;!n.startsWith(this.prefix)||(r=n.substring(this.prefix.length).split(":"))[1]===e&&t.push(r[0])}return t}storageKeyForSecretKey(e,t){return""+this.prefix+t+":"+e}*storageKeys(){for(let e=0;e<this.localStorage.length;e++)yield this.localStorage.key(e)}}browser_local_storage_key_store.BrowserLocalStorageKeyStore=BrowserLocalStorageKeyStore;var unencrypted_file_system_keystore={},__importDefault$b=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(unencrypted_file_system_keystore,"__esModule",{value:!0}),unencrypted_file_system_keystore.UnencryptedFileSystemKeyStore=unencrypted_file_system_keystore.readKeyFile=unencrypted_file_system_keystore.loadJsonFile=void 0;const fs_1=__importDefault$b(require$$0__default$2.default),path_1=__importDefault$b(require$$1__default.default),util_1=require$$2__default.default,key_pair_1$2=key_pair,keystore_1$1=keystore,promisify=e=>e?util_1.promisify(e):()=>{throw new Error("Trying to use unimplemented function. `fs` module not available in web build?")},exists=promisify(fs_1.default.exists),readFile=promisify(fs_1.default.readFile),writeFile=promisify(fs_1.default.writeFile),unlink=promisify(fs_1.default.unlink),readdir=promisify(fs_1.default.readdir),mkdir=promisify(fs_1.default.mkdir);async function loadJsonFile(e){const t=await readFile(e);return JSON.parse(t.toString())}async function ensureDir(e){try{await mkdir(e,{recursive:!0})}catch(e){if("EEXIST"!==e.code)throw e}}async function readKeyFile(e){e=await loadJsonFile(e);let t=e.private_key;return!t&&e.secret_key&&(t=e.secret_key),[e.account_id,key_pair_1$2.KeyPair.fromString(t)]}unencrypted_file_system_keystore.loadJsonFile=loadJsonFile,unencrypted_file_system_keystore.readKeyFile=readKeyFile;class UnencryptedFileSystemKeyStore extends keystore_1$1.KeyStore{constructor(e){super(),this.keyDir=path_1.default.resolve(e)}async setKey(e,t,r){await ensureDir(this.keyDir+"/"+e);r={account_id:t,public_key:r.getPublicKey().toString(),private_key:r.toString()};await writeFile(this.getKeyFilePath(e,t),JSON.stringify(r),{mode:384})}async getKey(e,t){return await exists(this.getKeyFilePath(e,t))?(await readKeyFile(this.getKeyFilePath(e,t)))[1]:null}async removeKey(e,t){await exists(this.getKeyFilePath(e,t))&&await unlink(this.getKeyFilePath(e,t))}async clear(){for(const e of await this.getNetworks())for(const t of await this.getAccounts(e))await this.removeKey(e,t)}getKeyFilePath(e,t){return this.keyDir+`/${e}/${t}.json`}async getNetworks(){const e=await readdir(this.keyDir),t=new Array;return e.forEach(e=>{t.push(e)}),t}async getAccounts(e){if(!await exists(this.keyDir+"/"+e))return[];const t=await readdir(this.keyDir+"/"+e);return t.filter(e=>e.endsWith(".json")).map(e=>e.replace(/.json$/,""))}toString(){return`UnencryptedFileSystemKeyStore(${this.keyDir})`}}unencrypted_file_system_keystore.UnencryptedFileSystemKeyStore=UnencryptedFileSystemKeyStore;var merge_key_store={};Object.defineProperty(merge_key_store,"__esModule",{value:!0}),merge_key_store.MergeKeyStore=void 0;const keystore_1=keystore;class MergeKeyStore extends keystore_1.KeyStore{constructor(e,t={writeKeyStoreIndex:0}){super(),this.options=t,this.keyStores=e}async setKey(e,t,r){await this.keyStores[this.options.writeKeyStoreIndex].setKey(e,t,r)}async getKey(e,t){for(const n of this.keyStores){var r=await n.getKey(e,t);if(r)return r}return null}async removeKey(e,t){for(const r of this.keyStores)await r.removeKey(e,t)}async clear(){for(const e of this.keyStores)await e.clear()}async getNetworks(){const e=new Set;for(const t of this.keyStores)for(const r of await t.getNetworks())e.add(r);return Array.from(e)}async getAccounts(e){const t=new Set;for(const r of this.keyStores)for(const n of await r.getAccounts(e))t.add(n);return Array.from(t)}toString(){return`MergeKeyStore(${this.keyStores.join(", ")})`}}merge_key_store.MergeKeyStore=MergeKeyStore,!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MergeKeyStore=e.UnencryptedFileSystemKeyStore=e.BrowserLocalStorageKeyStore=e.InMemoryKeyStore=e.KeyStore=void 0;const t=keystore,r=(Object.defineProperty(e,"KeyStore",{enumerable:!0,get:function(){return t.KeyStore}}),in_memory_key_store),n=(Object.defineProperty(e,"InMemoryKeyStore",{enumerable:!0,get:function(){return r.InMemoryKeyStore}}),browser_local_storage_key_store),o=(Object.defineProperty(e,"BrowserLocalStorageKeyStore",{enumerable:!0,get:function(){return n.BrowserLocalStorageKeyStore}}),unencrypted_file_system_keystore),i=(Object.defineProperty(e,"UnencryptedFileSystemKeyStore",{enumerable:!0,get:function(){return o.UnencryptedFileSystemKeyStore}}),merge_key_store);Object.defineProperty(e,"MergeKeyStore",{enumerable:!0,get:function(){return i.MergeKeyStore}})}(key_stores);var commonIndex={},providers={},provider={},jsonRpcProvider=(!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.getTransactionLastResult=e.Provider=e.IdType=e.FinalExecutionStatusBasic=e.ExecutionStatusBasic=void 0,(t=e.ExecutionStatusBasic||(e.ExecutionStatusBasic={})).Unknown="Unknown",t.Pending="Pending",t.Failure="Failure",(t=e.FinalExecutionStatusBasic||(e.FinalExecutionStatusBasic={})).NotStarted="NotStarted",t.Started="Started",t.Failure="Failure",(t=e.IdType||(e.IdType={})).Transaction="transaction",t.Receipt="receipt";e.Provider=class{},e.getTransactionLastResult=function(t){if("object"==typeof t.status&&"string"==typeof t.status.SuccessValue){t=Buffer.from(t.status.SuccessValue,"base64").toString();try{return JSON.parse(t)}catch(e){return t}}return null}}(provider),{}),relative$1=require$$1__default.default.relative,depd_1$5=depd$1,basePath$1=process.cwd();function containsNamespace$1(e,t){for(var r=e.split(/[ ,]+/),n=String(t).toLowerCase(),o=0;o<r.length;o++){var i=r[o];if(i&&("*"===i||i.toLowerCase()===n))return!0}return!1}function convertDataDescriptorToAccessor$1(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t),o=n.value;return n.get=function(){return o},n.writable&&(n.set=function(e){return o=e}),delete n.value,delete n.writable,Object.defineProperty(e,t,n),n}function createArgumentsString$1(e){for(var t="",r=0;r<e;r++)t+=", arg"+r;return t.substr(2)}function createStackString$1(e){var t=this.name+": "+this.namespace;this.message&&(t+=" deprecated "+this.message);for(var r=0;r<e.length;r++)t+="\n    at "+e[r].toString();return t}function depd$1(e){if(!e)throw new TypeError("argument namespace is required");var t=callSiteLocation$1(getStack$1()[1])[0];function r(e){log$1.call(r,e)}return r._file=t,r._ignored=isignored$1(e),r._namespace=e,r._traced=istraced$1(e),r._warned=Object.create(null),r.function=wrapfunction$1,r.property=wrapproperty$1,r}function eehaslisteners(e,t){return 0<("function"!=typeof e.listenerCount?e.listeners(t).length:e.listenerCount(t))}function isignored$1(e){return!!process.noDeprecation||containsNamespace$1(process.env.NO_DEPRECATION||"",e)}function istraced$1(e){return!!process.traceDeprecation||containsNamespace$1(process.env.TRACE_DEPRECATION||"",e)}function log$1(e,t){var r=eehaslisteners(process,"deprecation");if(r||!this._ignored){var n,o,i,a=0,s=!1,c=getStack$1(),u=this._file;for(t?(i=t,(l=callSiteLocation$1(c[1])).name=i.name,u=l[0]):l=i=callSiteLocation$1(c[a=2]);a<c.length;a++)if((o=(n=callSiteLocation$1(c[a]))[0])===u)s=!0;else if(o===this._file)u=this._file;else if(s)break;t=n?i.join(":")+"__"+n.join(":"):void 0;if(!(void 0!==t&&t in this._warned)){this._warned[t]=!0;t=(t=e)||(l!==i&&l.name?defaultMessage$1(l):defaultMessage$1(i));if(r)return e=DeprecationError$1(this._namespace,t,c.slice(a)),void process.emit("deprecation",e);var l=(process.stderr.isTTY?formatColor$1:formatPlain$1).call(this,t,n,c.slice(a));process.stderr.write(l+"\n","utf8")}}}function callSiteLocation$1(e){var t=e.getFileName()||"<anonymous>",r=e.getLineNumber(),n=e.getColumnNumber(),t=[t=e.isEval()?e.getEvalOrigin()+", "+t:t,r,n];return t.callSite=e,t.name=e.getFunctionName(),t}function defaultMessage$1(e){var t=e.callSite,r=(r=e.name)||"<anonymous@"+formatLocation$1(e)+">",e=t.getThis(),n=e&&t.getTypeName();return(n="Function"===(n="Object"===n?void 0:n)?e.name||n:n)&&t.getMethodName()?n+"."+r:r}function formatPlain$1(e,t,r){var n=(new Date).toUTCString()+" "+this._namespace+" deprecated "+e;if(this._traced){for(var o=0;o<r.length;o++)n+="\n    at "+r[o].toString();return n}return t&&(n+=" at "+formatLocation$1(t)),n}function formatColor$1(e,t,r){var n="[36;1m"+this._namespace+"[22;39m [33;1mdeprecated[22;39m [0m"+e+"[39m";if(this._traced){for(var o=0;o<r.length;o++)n+="\n    [36mat "+r[o].toString()+"[39m";return n}return t&&(n+=" [36m"+formatLocation$1(t)+"[39m"),n}function formatLocation$1(e){return relative$1(basePath$1,e[0])+":"+e[1]+":"+e[2]}function getStack$1(){var e=Error.stackTraceLimit,t={},r=Error.prepareStackTrace,t=(Error.prepareStackTrace=prepareObjectStackTrace$1,Error.stackTraceLimit=Math.max(10,e),Error.captureStackTrace(t),t.stack.slice(1));return Error.prepareStackTrace=r,Error.stackTraceLimit=e,t}function prepareObjectStackTrace$1(e,t){return t}function wrapfunction$1(e,t){if("function"!=typeof e)throw new TypeError("argument fn must be a function");var r=createArgumentsString$1(e.length),n=callSiteLocation$1(getStack$1()[1]);return n.name=e.name,new Function("fn","log","deprecate","message","site",'"use strict"\nreturn function ('+r+") {log.call(deprecate, message, site)\nreturn fn.apply(this, arguments)\n}")(e,log$1,this,t,n)}function wrapproperty$1(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("argument obj must be object");var n=Object.getOwnPropertyDescriptor(e,t);if(!n)throw new TypeError("must call property on owner object");if(!n.configurable)throw new TypeError("property must be configurable");var o=this,i=callSiteLocation$1(getStack$1()[1]),a=(i.name=t,(n="value"in n?convertDataDescriptorToAccessor$1(e,t):n).get),s=n.set;"function"==typeof a&&(n.get=function(){return log$1.call(o,r,i),a.apply(this,arguments)}),"function"==typeof s&&(n.set=function(){return log$1.call(o,r,i),s.apply(this,arguments)}),Object.defineProperty(e,t,n)}function DeprecationError$1(e,t,r){var n,o=new Error;return Object.defineProperty(o,"constructor",{value:DeprecationError$1}),Object.defineProperty(o,"message",{configurable:!0,enumerable:!1,value:t,writable:!0}),Object.defineProperty(o,"name",{enumerable:!1,configurable:!0,value:"DeprecationError",writable:!0}),Object.defineProperty(o,"namespace",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(o,"stack",{configurable:!0,enumerable:!1,get:function(){return void 0!==n?n:n=createStackString$1.call(this,r)},set:function(e){n=e}}),o}var web={},httpErrors={exports:{}},compat={exports:{}},callsiteTostring=callSiteToString$1;function callSiteFileLocation(e){var t,r="";return e.isNative()?r="native":e.isEval()?(t=e.getScriptNameOrSourceURL())||(r=e.getEvalOrigin()):t=e.getFileName(),t&&(r+=t,null!=(t=e.getLineNumber())&&(r+=":"+t,(t=e.getColumnNumber())&&(r+=":"+t))),r||"unknown source"}function callSiteToString$1(e){var t,r=!0,n=callSiteFileLocation(e),o=e.getFunctionName(),i=e.isConstructor(),a="";return!(e.isToplevel()||i)?(t=e.getMethodName(),e=getConstructorName(e),o?(e&&0!==o.indexOf(e)&&(a+=e+"."),a+=o,t&&o.lastIndexOf("."+t)!==o.length-t.length-1&&(a+=" [as "+t+"]")):a+=e+"."+(t||"<anonymous>")):i?a+="new "+(o||"<anonymous>"):o?a+=o:(r=!1,a+=n),r&&(a+=" ("+n+")"),a}function getConstructorName(e){e=e.receiver;return e.constructor&&e.constructor.name||null}var eventListenerCount_1=eventListenerCount$1;function eventListenerCount$1(e,t){return e.listeners(t).length}!function(e){var t=require$$0__default$3.default.EventEmitter;function r(t,r,n){Object.defineProperty(t,r,{configurable:!0,enumerable:!0,get:function(){var e=n();return Object.defineProperty(t,r,{configurable:!0,enumerable:!0,value:e}),e}})}function n(e){return e.toString()}r(e.exports,"callSiteToString",function(){var e=Error.stackTraceLimit,t={},r=Error.prepareStackTrace;Error.prepareStackTrace=function(e,t){return t},Error.stackTraceLimit=2,Error.captureStackTrace(t);t=t.stack.slice();return Error.prepareStackTrace=r,Error.stackTraceLimit=e,t[0].toString?n:callsiteTostring}),r(e.exports,"eventListenerCount",function(){return t.listenerCount||eventListenerCount_1})}(compat);var callSiteToString=compat.exports.callSiteToString,eventListenerCount=compat.exports.eventListenerCount,relative=require$$1__default.default.relative,depd_1$4=depd,basePath=process.cwd();function containsNamespace(e,t){for(var r=e.split(/[ ,]+/),n=String(t).toLowerCase(),o=0;o<r.length;o++){var i=r[o];if(i&&("*"===i||i.toLowerCase()===n))return!0}return!1}function convertDataDescriptorToAccessor(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t),o=n.value;return n.get=function(){return o},n.writable&&(n.set=function(e){return o=e}),delete n.value,delete n.writable,Object.defineProperty(e,t,n),n}function createArgumentsString(e){for(var t="",r=0;r<e;r++)t+=", arg"+r;return t.substr(2)}function createStackString(e){var t=this.name+": "+this.namespace;this.message&&(t+=" deprecated "+this.message);for(var r=0;r<e.length;r++)t+="\n    at "+callSiteToString(e[r]);return t}function depd(e){if(!e)throw new TypeError("argument namespace is required");var t=callSiteLocation(getStack()[1])[0];function r(e){log.call(r,e)}return r._file=t,r._ignored=isignored(e),r._namespace=e,r._traced=istraced(e),r._warned=Object.create(null),r.function=wrapfunction,r.property=wrapproperty,r}function isignored(e){return!!process.noDeprecation||containsNamespace(process.env.NO_DEPRECATION||"",e)}function istraced(e){return!!process.traceDeprecation||containsNamespace(process.env.TRACE_DEPRECATION||"",e)}function log(e,t){var r=0!==eventListenerCount(process,"deprecation");if(r||!this._ignored){var n,o,i,a=0,s=!1,c=getStack(),u=this._file;for(t?(i=t,(l=callSiteLocation(c[1])).name=i.name,u=l[0]):l=i=callSiteLocation(c[a=2]);a<c.length;a++)if((o=(n=callSiteLocation(c[a]))[0])===u)s=!0;else if(o===this._file)u=this._file;else if(s)break;t=n?i.join(":")+"__"+n.join(":"):void 0;if(!(void 0!==t&&t in this._warned)){this._warned[t]=!0;t=(t=e)||(l!==i&&l.name?defaultMessage(l):defaultMessage(i));if(r)return e=DeprecationError(this._namespace,t,c.slice(a)),void process.emit("deprecation",e);var l=(process.stderr.isTTY?formatColor:formatPlain).call(this,t,n,c.slice(a));process.stderr.write(l+"\n","utf8")}}}function callSiteLocation(e){var t=e.getFileName()||"<anonymous>",r=e.getLineNumber(),n=e.getColumnNumber(),t=[t=e.isEval()?e.getEvalOrigin()+", "+t:t,r,n];return t.callSite=e,t.name=e.getFunctionName(),t}function defaultMessage(e){var t=e.callSite,r=(r=e.name)||"<anonymous@"+formatLocation(e)+">",e=t.getThis(),n=e&&t.getTypeName();return(n="Function"===(n="Object"===n?void 0:n)?e.name||n:n)&&t.getMethodName()?n+"."+r:r}function formatPlain(e,t,r){var n=(new Date).toUTCString()+" "+this._namespace+" deprecated "+e;if(this._traced){for(var o=0;o<r.length;o++)n+="\n    at "+callSiteToString(r[o]);return n}return t&&(n+=" at "+formatLocation(t)),n}function formatColor(e,t,r){var n="[36;1m"+this._namespace+"[22;39m [33;1mdeprecated[22;39m [0m"+e+"[39m";if(this._traced){for(var o=0;o<r.length;o++)n+="\n    [36mat "+callSiteToString(r[o])+"[39m";return n}return t&&(n+=" [36m"+formatLocation(t)+"[39m"),n}function formatLocation(e){return relative(basePath,e[0])+":"+e[1]+":"+e[2]}function getStack(){var e=Error.stackTraceLimit,t={},r=Error.prepareStackTrace,t=(Error.prepareStackTrace=prepareObjectStackTrace,Error.stackTraceLimit=Math.max(10,e),Error.captureStackTrace(t),t.stack.slice(1));return Error.prepareStackTrace=r,Error.stackTraceLimit=e,t}function prepareObjectStackTrace(e,t){return t}function wrapfunction(fn,message){if("function"!=typeof fn)throw new TypeError("argument fn must be a function");var args=createArgumentsString(fn.length),stack=getStack(),site=callSiteLocation(stack[1]),deprecatedfn=(site.name=fn.name,eval("(function ("+args+') {\n"use strict"\nlog.call(deprecate, message, site)\nreturn fn.apply(this, arguments)\n})'));return deprecatedfn}function wrapproperty(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("argument obj must be object");var n=Object.getOwnPropertyDescriptor(e,t);if(!n)throw new TypeError("must call property on owner object");if(!n.configurable)throw new TypeError("property must be configurable");var o=this,i=callSiteLocation(getStack()[1]),a=(i.name=t,(n="value"in n?convertDataDescriptorToAccessor(e,t):n).get),s=n.set;"function"==typeof a&&(n.get=function(){return log.call(o,r,i),a.apply(this,arguments)}),"function"==typeof s&&(n.set=function(){return log.call(o,r,i),s.apply(this,arguments)}),Object.defineProperty(e,t,n)}function DeprecationError(e,t,r){var n,o=new Error;return Object.defineProperty(o,"constructor",{value:DeprecationError}),Object.defineProperty(o,"message",{configurable:!0,enumerable:!1,value:t,writable:!0}),Object.defineProperty(o,"name",{enumerable:!1,configurable:!0,value:"DeprecationError",writable:!0}),Object.defineProperty(o,"namespace",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(o,"stack",{configurable:!0,enumerable:!1,get:function(){return void 0!==n?n:n=createStackString.call(this,r)},set:function(e){n=e}}),o}var setprototypeof=Object.setPrototypeOf||({__proto__:[]}instanceof Array?setProtoOf:mixinProperties);function setProtoOf(e,t){return e.__proto__=t,e}function mixinProperties(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=t[r]);return e}var require$$0$1={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},codes=require$$0$1,statuses=status;function populateStatusesMap(r,n){var o=[];return Object.keys(n).forEach(function(e){var t=n[e],e=Number(e);r[e]=t,r[t]=e,r[t.toLowerCase()]=e,o.push(e)}),o}function status(e){if("number"==typeof e){if(status[e])return e;throw new Error("invalid status code: "+e)}if("string"!=typeof e)throw new TypeError("code must be a number or string");var t=parseInt(e,10);if(!isNaN(t)){if(status[t])return t;throw new Error("invalid status code: "+t)}if(t=status[e.toLowerCase()])return t;throw new Error('invalid status message: "'+e+'"')}status.STATUS_CODES=codes,status.codes=populateStatusesMap(status,codes),status.redirect={300:!0,301:!0,302:!0,303:!0,305:!0,307:!0,308:!0},status.empty={204:!0,205:!0,304:!0},status.retry={502:!0,503:!0,504:!0};var inherits={exports:{}},inherits_browser={exports:{}};"function"==typeof Object.create?inherits_browser.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(e,t){var r;t&&(e.super_=t,(r=function(){}).prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e)};try{var util=require("util");if("function"!=typeof util.inherits)throw"";inherits.exports=util.inherits}catch(e){inherits.exports=inherits_browser.exports}var toidentifier=toIdentifier;function toIdentifier(e){return e.split(" ").map(function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}).join("").replace(/[^ _0-9a-z]/gi,"")}!function(e){var t,l,r,h,u=depd_1$4("http-errors"),d=setprototypeof,f=statuses,p=inherits.exports,m=toidentifier;function n(){throw new TypeError("cannot construct abstract class")}function y(e){return Number(String(e).charAt(0)+"00")}function g(e,t){var r=Object.getOwnPropertyDescriptor(e,"name");r&&r.configurable&&(r.value=t,Object.defineProperty(e,"name",r))}function _(e){return"Error"!==e.substr(-5)?e+"Error":e}e.exports=function e(){var t;var r;var n=500;var o={};for(var i=0;i<arguments.length;i++){var a=arguments[i];if(a instanceof Error)n=(t=a).status||t.statusCode||n;else switch(typeof a){case"string":r=a;break;case"number":n=a,0!==i&&u("non-first-argument status code; replace with createError("+a+", ...)");break;case"object":o=a}}"number"==typeof n&&(n<400||600<=n)&&u("non-error status code; use only 4xx or 5xx status codes");("number"!=typeof n||!f[n]&&(n<400||600<=n))&&(n=500);var s=e[n]||e[y(n)];t||(t=s?new s(r):new Error(r||f[n]),Error.captureStackTrace(t,e));s&&t instanceof s&&t.status===n||(t.expose=n<500,t.status=t.statusCode=n);for(var c in o)"status"!==c&&"statusCode"!==c&&(t[c]=o[c]);return t},e.exports.HttpError=(p(n,Error),n),e.exports.isHttpError=(t=e.exports.HttpError,function(e){return!(!e||"object"!=typeof e)&&(e instanceof t||e instanceof Error&&"boolean"==typeof e.expose&&"number"==typeof e.statusCode&&e.status===e.statusCode)}),l=e.exports,r=f.codes,h=e.exports.HttpError,r.forEach(function(e){var t,r,n,o,i,a,s=m(f[e]);switch(y(e)){case 400:o=h,i=e,a=_(s),p(u,o),g(u,a),u.prototype.status=i,u.prototype.statusCode=i,u.prototype.expose=!0,t=u;break;case 500:o=h,r=e,n=_(s),p(c,o),g(c,n),c.prototype.status=r,c.prototype.statusCode=r,c.prototype.expose=!1,t=c}function c(e){var e=null!=e?e:f[r],t=new Error(e);return Error.captureStackTrace(t,c),d(t,c.prototype),Object.defineProperty(t,"message",{enumerable:!0,configurable:!0,value:e,writable:!0}),Object.defineProperty(t,"name",{enumerable:!1,configurable:!0,value:n,writable:!0}),t}function u(e){var e=null!=e?e:f[i],t=new Error(e);return Error.captureStackTrace(t,u),d(t,u.prototype),Object.defineProperty(t,"message",{enumerable:!0,configurable:!0,value:e,writable:!0}),Object.defineProperty(t,"name",{enumerable:!1,configurable:!0,value:a,writable:!0}),t}t&&(l[e]=t,l[s]=t)}),l["I'mateapot"]=u.function(l.ImATeapot,'"I\'mateapot"; use "ImATeapot" instead')}(httpErrors);var exponentialBackoff$1={};async function exponentialBackoff(e,t,r,n){let o=e;for(let e=0;e<t;e++){var i=await n();if(i)return i;await sleep(o),o*=r}return null}function sleep(t){return new Promise(e=>setTimeout(e,t))}Object.defineProperty(exponentialBackoff$1,"__esModule",{value:!0}),exponentialBackoff$1.default=exponentialBackoff;var errors={};Object.defineProperty(errors,"__esModule",{value:!0}),errors.logWarning=errors.ErrorContext=errors.TypedError=errors.ArgumentTypeError=errors.PositionalArgsError=void 0;class PositionalArgsError extends Error{constructor(){super("Contract method calls expect named arguments wrapped in object, e.g. { argName1: argValue1, argName2: argValue2 }")}}errors.PositionalArgsError=PositionalArgsError;class ArgumentTypeError extends Error{constructor(e,t,r){super(`Expected ${t} for '${e}' argument, but got '${JSON.stringify(r)}'`)}}errors.ArgumentTypeError=ArgumentTypeError;class TypedError extends Error{constructor(e,t,r){super(e),this.type=t||"UntypedError",this.context=r}}errors.TypedError=TypedError;class ErrorContext{constructor(e){this.transactionHash=e}}function logWarning(...e){process.env.NEAR_NO_LOGS||console.warn(...e)}errors.ErrorContext=ErrorContext,errors.logWarning=logWarning;var __importDefault$a=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(web,"__esModule",{value:!0}),web.fetchJson=void 0;const http_errors_1=__importDefault$a(httpErrors.exports),exponential_backoff_1$1=__importDefault$a(exponentialBackoff$1),providers_1$3=providers,errors_1$3=errors,START_WAIT_TIME_MS=1e3,BACKOFF_MULTIPLIER=1.5,RETRY_NUMBER=10;async function fetchJson(e,t){let r={url:null};"string"==typeof e?r.url=e:r=e;const n=await exponential_backoff_1$1.default(START_WAIT_TIME_MS,RETRY_NUMBER,BACKOFF_MULTIPLIER,async()=>{try{const e=await fetch(r.url,{method:t?"POST":"GET",body:t||void 0,headers:{...r.headers,"Content-Type":"application/json"}});if(e.ok)return e;if(503===e.status)return errors_1$3.logWarning(`Retrying HTTP request for ${r.url} as it's not available now`),null;throw http_errors_1.default(e.status,await e.text())}catch(e){if(e.toString().includes("FetchError")||e.toString().includes("Failed to fetch"))return errors_1$3.logWarning(`Retrying HTTP request for ${r.url} because of error: `+e),null;throw e}});if(n)return n.json();throw new providers_1$3.TypedError(`Exceeded ${RETRY_NUMBER} attempts for ${r.url}.`,"RetriesExceeded")}web.fetchJson=fetchJson;var rpc_errors={},mustache={exports:{}},schema=(!function(){function l(e){return"function"==typeof e}function S(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function h(e,t){return null!=e&&"object"==typeof e&&t in e}function M(e){this.string=e,this.tail=e,this.pos=0}function i(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function e(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}var t,T,I,k,r,R,x,C,N,P,O,a;mustache.exports=(t=Object.prototype.toString,T=Array.isArray||function(e){return"[object Array]"===t.call(e)},I=RegExp.prototype.test,k=/\S/,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},R=/\s*/,x=/\s+/,C=/\s*=/,N=/\s*\}/,P=/#|\^|\/|>|\{|&|=|!/,M.prototype.eos=function(){return""===this.tail},M.prototype.scan=function(e){e=this.tail.match(e);if(!e||0!==e.index)return"";e=e[0];return this.tail=this.tail.substring(e.length),this.pos+=e.length,e},M.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},i.prototype.push=function(e){return new i(e,this)},i.prototype.lookup=function(e){var t,r,n,o=this.cache;if(o.hasOwnProperty(e))t=o[e];else{for(var i,a,s,c=this,u=!1;c;){if(0<e.indexOf("."))for(i=c.view,a=e.split("."),s=0;null!=i&&s<a.length;)s===a.length-1&&(u=h(i,a[s])||(r=i,n=a[s],null!=r&&"object"!=typeof r&&r.hasOwnProperty&&r.hasOwnProperty(n))),i=i[a[s++]];else i=c.view[e],u=h(c.view,e);if(u){t=i;break}c=c.parent}o[e]=t}return t=l(t)?t.call(this.view):t},e.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},e.prototype.parse=function(e,t){var r=this.templateCache,n=e+":"+(t||O.tags).join(":"),o=void 0!==r,i=o?r.get(n):void 0;return null==i&&(i=function(e,t){if(!e)return[];var r,n,o,i=!1,a=[],s=[],c=[],u=!1,l=!1,h="",d=0;function f(){if(u&&!l)for(;c.length;)delete s[c.pop()];else c=[];l=u=!1}function p(e){if("string"==typeof e&&(e=e.split(x,2)),!T(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(S(e[0])+"\\s*"),n=new RegExp("\\s*"+S(e[1])),o=new RegExp("\\s*"+S("}"+e[1]))}p(t||O.tags);var m,y,g,_,b,v,w=new M(e);for(;!w.eos();){if(m=w.pos,g=w.scanUntil(r))for(var E=0,A=g.length;E<A;++E)!function(e){return!function(e,t){return I.call(e,t)}(k,e)}(_=g.charAt(E))?(i=l=!0,h+=" "):(c.push(s.length),h+=_),s.push(["text",_,m,m+1]),m+=1,"\n"===_&&(f(),h="",d=0,i=!1);if(!w.scan(r))break;if(u=!0,y=w.scan(P)||"name",w.scan(R),"="===y?(g=w.scanUntil(C),w.scan(C),w.scanUntil(n)):"{"===y?(g=w.scanUntil(o),w.scan(N),w.scanUntil(n),y="&"):g=w.scanUntil(n),!w.scan(n))throw new Error("Unclosed tag at "+w.pos);if(b=">"==y?[y,g,m,w.pos,h,d,i]:[y,g,m,w.pos],d++,s.push(b),"#"===y||"^"===y)a.push(b);else if("/"===y){if(!(v=a.pop()))throw new Error('Unopened section "'+g+'" at '+m);if(v[1]!==g)throw new Error('Unclosed section "'+v[1]+'" at '+m)}else"name"===y||"{"===y||"&"===y?l=!0:"="===y&&p(g)}if(f(),v=a.pop())throw new Error('Unclosed section "'+v[1]+'" at '+w.pos);return function(e){for(var t,r=[],n=r,o=[],i=0,a=e.length;i<a;++i)switch((t=e[i])[0]){case"#":case"^":n.push(t),o.push(t),n=t[4]=[];break;case"/":o.pop()[5]=t[2],n=0<o.length?o[o.length-1][4]:r;break;default:n.push(t)}return r}(function(e){for(var t,r,n=[],o=0,i=e.length;o<i;++o)(t=e[o])&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t));return n}(s))}(e,t),o&&r.set(n,i)),i},e.prototype.render=function(e,t,r,n){var o=this.getConfigTags(n),o=this.parse(e,o),t=t instanceof i?t:new i(t,void 0);return this.renderTokens(o,t,r,e,n)},e.prototype.renderTokens=function(e,t,r,n,o){for(var i,a,s,c="",u=0,l=e.length;u<l;++u)s=void 0,"#"===(a=(i=e[u])[0])?s=this.renderSection(i,t,r,n,o):"^"===a?s=this.renderInverted(i,t,r,n,o):">"===a?s=this.renderPartial(i,t,r,o):"&"===a?s=this.unescapedValue(i,t):"name"===a?s=this.escapedValue(i,t,o):"text"===a&&(s=this.rawValue(i)),void 0!==s&&(c+=s);return c},e.prototype.renderSection=function(e,t,r,n,o){var i=this,a="",s=t.lookup(e[1]);if(s){if(T(s))for(var c=0,u=s.length;c<u;++c)a+=this.renderTokens(e[4],t.push(s[c]),r,n,o);else if("object"==typeof s||"string"==typeof s||"number"==typeof s)a+=this.renderTokens(e[4],t.push(s),r,n,o);else if(l(s)){if("string"!=typeof n)throw new Error("Cannot use higher-order sections without the original template");null!=(s=s.call(t.view,n.slice(e[3],e[5]),function(e){return i.render(e,t,r,o)}))&&(a+=s)}else a+=this.renderTokens(e[4],t,r,n,o);return a}},e.prototype.renderInverted=function(e,t,r,n,o){var i=t.lookup(e[1]);if(!i||T(i)&&0===i.length)return this.renderTokens(e[4],t,r,n,o)},e.prototype.indentPartial=function(e,t,r){for(var n=t.replace(/[^ \t]/g,""),o=e.split("\n"),i=0;i<o.length;i++)o[i].length&&(0<i||!r)&&(o[i]=n+o[i]);return o.join("\n")},e.prototype.renderPartial=function(e,t,r,n){var o,i,a,s,c;if(r)return o=this.getConfigTags(n),i=l(r)?r(e[1]):r[e[1]],null!=i?(a=e[6],c=e[5],e=e[4],s=i,0==c&&e&&(s=this.indentPartial(i,e,a)),c=this.parse(s,o),this.renderTokens(c,t,r,s,n)):void 0},e.prototype.unescapedValue=function(e,t){t=t.lookup(e[1]);if(null!=t)return t},e.prototype.escapedValue=function(e,t,r){r=this.getConfigEscape(r)||O.escape,t=t.lookup(e[1]);if(null!=t)return("number"==typeof t&&r===O.escape?String:r)(t)},e.prototype.rawValue=function(e){return e[1]},e.prototype.getConfigTags=function(e){return T(e)?e:e&&"object"==typeof e?e.tags:void 0},e.prototype.getConfigEscape=function(e){if(e&&"object"==typeof e&&!T(e))return e.escape},O={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){a.templateCache=e},get templateCache(){return a.templateCache}},a=new e,O.clearCache=function(){return a.clearCache()},O.parse=function(e,t){return a.parse(e,t)},O.render=function(e,t,r,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(T(o=e)?"array":typeof o)+'" was given as the first argument for mustache#render(template, view, partials)');var o;return a.render(e,t,r,n)},O.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return r[e]})},O.Scanner=M,O.Context=i,O.Writer=e,O)}(),{BadUTF16:{name:"BadUTF16",subtypes:[],props:{}},BadUTF8:{name:"BadUTF8",subtypes:[],props:{}},BalanceExceeded:{name:"BalanceExceeded",subtypes:[],props:{}},BreakpointTrap:{name:"BreakpointTrap",subtypes:[],props:{}},CacheError:{name:"CacheError",subtypes:["ReadError","WriteError","DeserializationError","SerializationError"],props:{}},CallIndirectOOB:{name:"CallIndirectOOB",subtypes:[],props:{}},CannotAppendActionToJointPromise:{name:"CannotAppendActionToJointPromise",subtypes:[],props:{}},CannotReturnJointPromise:{name:"CannotReturnJointPromise",subtypes:[],props:{}},CodeDoesNotExist:{name:"CodeDoesNotExist",subtypes:[],props:{account_id:""}},CompilationError:{name:"CompilationError",subtypes:["CodeDoesNotExist","PrepareError","WasmerCompileError"],props:{}},ContractSizeExceeded:{name:"ContractSizeExceeded",subtypes:[],props:{limit:"",size:""}},Deprecated:{name:"Deprecated",subtypes:[],props:{method_name:""}},Deserialization:{name:"Deserialization",subtypes:[],props:{}},DeserializationError:{name:"DeserializationError",subtypes:[],props:{}},EmptyMethodName:{name:"EmptyMethodName",subtypes:[],props:{}},FunctionCallError:{name:"FunctionCallError",subtypes:["CompilationError","LinkError","MethodResolveError","WasmTrap","WasmUnknownError","HostError","EvmError"],props:{}},GasExceeded:{name:"GasExceeded",subtypes:[],props:{}},GasInstrumentation:{name:"GasInstrumentation",subtypes:[],props:{}},GasLimitExceeded:{name:"GasLimitExceeded",subtypes:[],props:{}},GenericTrap:{name:"GenericTrap",subtypes:[],props:{}},GuestPanic:{name:"GuestPanic",subtypes:[],props:{panic_msg:""}},HostError:{name:"HostError",subtypes:["BadUTF16","BadUTF8","GasExceeded","GasLimitExceeded","BalanceExceeded","EmptyMethodName","GuestPanic","IntegerOverflow","InvalidPromiseIndex","CannotAppendActionToJointPromise","CannotReturnJointPromise","InvalidPromiseResultIndex","InvalidRegisterId","IteratorWasInvalidated","MemoryAccessViolation","InvalidReceiptIndex","InvalidIteratorIndex","InvalidAccountId","InvalidMethodName","InvalidPublicKey","ProhibitedInView","NumberOfLogsExceeded","KeyLengthExceeded","ValueLengthExceeded","TotalLogLengthExceeded","NumberPromisesExceeded","NumberInputDataDependenciesExceeded","ReturnedValueLengthExceeded","ContractSizeExceeded","Deprecated"],props:{}},IllegalArithmetic:{name:"IllegalArithmetic",subtypes:[],props:{}},IncorrectCallIndirectSignature:{name:"IncorrectCallIndirectSignature",subtypes:[],props:{}},Instantiate:{name:"Instantiate",subtypes:[],props:{}},IntegerOverflow:{name:"IntegerOverflow",subtypes:[],props:{}},InternalMemoryDeclared:{name:"InternalMemoryDeclared",subtypes:[],props:{}},InvalidAccountId:{name:"InvalidAccountId",subtypes:[],props:{account_id:""}},InvalidIteratorIndex:{name:"InvalidIteratorIndex",subtypes:[],props:{iterator_index:""}},InvalidMethodName:{name:"InvalidMethodName",subtypes:[],props:{}},InvalidPromiseIndex:{name:"InvalidPromiseIndex",subtypes:[],props:{promise_idx:""}},InvalidPromiseResultIndex:{name:"InvalidPromiseResultIndex",subtypes:[],props:{result_idx:""}},InvalidPublicKey:{name:"InvalidPublicKey",subtypes:[],props:{}},InvalidReceiptIndex:{name:"InvalidReceiptIndex",subtypes:[],props:{receipt_index:""}},InvalidRegisterId:{name:"InvalidRegisterId",subtypes:[],props:{register_id:""}},IteratorWasInvalidated:{name:"IteratorWasInvalidated",subtypes:[],props:{iterator_index:""}},KeyLengthExceeded:{name:"KeyLengthExceeded",subtypes:[],props:{length:"",limit:""}},LinkError:{name:"LinkError",subtypes:[],props:{msg:""}},Memory:{name:"Memory",subtypes:[],props:{}},MemoryAccessViolation:{name:"MemoryAccessViolation",subtypes:[],props:{}},MemoryOutOfBounds:{name:"MemoryOutOfBounds",subtypes:[],props:{}},MethodEmptyName:{name:"MethodEmptyName",subtypes:[],props:{}},MethodInvalidSignature:{name:"MethodInvalidSignature",subtypes:[],props:{}},MethodNotFound:{name:"MethodNotFound",subtypes:[],props:{}},MethodResolveError:{name:"MethodResolveError",subtypes:["MethodEmptyName","MethodUTF8Error","MethodNotFound","MethodInvalidSignature"],props:{}},MethodUTF8Error:{name:"MethodUTF8Error",subtypes:[],props:{}},MisalignedAtomicAccess:{name:"MisalignedAtomicAccess",subtypes:[],props:{}},NumberInputDataDependenciesExceeded:{name:"NumberInputDataDependenciesExceeded",subtypes:[],props:{limit:"",number_of_input_data_dependencies:""}},NumberOfLogsExceeded:{name:"NumberOfLogsExceeded",subtypes:[],props:{limit:""}},NumberPromisesExceeded:{name:"NumberPromisesExceeded",subtypes:[],props:{limit:"",number_of_promises:""}},PrepareError:{name:"PrepareError",subtypes:["Serialization","Deserialization","InternalMemoryDeclared","GasInstrumentation","StackHeightInstrumentation","Instantiate","Memory"],props:{}},ProhibitedInView:{name:"ProhibitedInView",subtypes:[],props:{method_name:""}},ReadError:{name:"ReadError",subtypes:[],props:{}},ReturnedValueLengthExceeded:{name:"ReturnedValueLengthExceeded",subtypes:[],props:{length:"",limit:""}},Serialization:{name:"Serialization",subtypes:[],props:{}},SerializationError:{name:"SerializationError",subtypes:[],props:{hash:""}},StackHeightInstrumentation:{name:"StackHeightInstrumentation",subtypes:[],props:{}},StackOverflow:{name:"StackOverflow",subtypes:[],props:{}},TotalLogLengthExceeded:{name:"TotalLogLengthExceeded",subtypes:[],props:{length:"",limit:""}},Unreachable:{name:"Unreachable",subtypes:[],props:{}},ValueLengthExceeded:{name:"ValueLengthExceeded",subtypes:[],props:{length:"",limit:""}},WasmTrap:{name:"WasmTrap",subtypes:["Unreachable","IncorrectCallIndirectSignature","MemoryOutOfBounds","CallIndirectOOB","IllegalArithmetic","MisalignedAtomicAccess","BreakpointTrap","StackOverflow","GenericTrap"],props:{}},WasmUnknownError:{name:"WasmUnknownError",subtypes:[],props:{}},WasmerCompileError:{name:"WasmerCompileError",subtypes:[],props:{msg:""}},WriteError:{name:"WriteError",subtypes:[],props:{}},AccessKeyNotFound:{name:"AccessKeyNotFound",subtypes:[],props:{account_id:"",public_key:""}},AccountAlreadyExists:{name:"AccountAlreadyExists",subtypes:[],props:{account_id:""}},AccountDoesNotExist:{name:"AccountDoesNotExist",subtypes:[],props:{account_id:""}},ActionError:{name:"ActionError",subtypes:["AccountAlreadyExists","AccountDoesNotExist","CreateAccountOnlyByRegistrar","CreateAccountNotAllowed","ActorNoPermission","DeleteKeyDoesNotExist","AddKeyAlreadyExists","DeleteAccountStaking","LackBalanceForState","TriesToUnstake","TriesToStake","InsufficientStake","FunctionCallError","NewReceiptValidationError","OnlyImplicitAccountCreationAllowed"],props:{index:""}},ActionsValidationError:{name:"ActionsValidationError",subtypes:["DeleteActionMustBeFinal","TotalPrepaidGasExceeded","TotalNumberOfActionsExceeded","AddKeyMethodNamesNumberOfBytesExceeded","AddKeyMethodNameLengthExceeded","IntegerOverflow","InvalidAccountId","ContractSizeExceeded","FunctionCallMethodNameLengthExceeded","FunctionCallArgumentsLengthExceeded","UnsuitableStakingKey","FunctionCallZeroAttachedGas"],props:{}},ActorNoPermission:{name:"ActorNoPermission",subtypes:[],props:{account_id:"",actor_id:""}},AddKeyAlreadyExists:{name:"AddKeyAlreadyExists",subtypes:[],props:{account_id:"",public_key:""}},AddKeyMethodNameLengthExceeded:{name:"AddKeyMethodNameLengthExceeded",subtypes:[],props:{length:"",limit:""}},AddKeyMethodNamesNumberOfBytesExceeded:{name:"AddKeyMethodNamesNumberOfBytesExceeded",subtypes:[],props:{limit:"",total_number_of_bytes:""}},BalanceMismatchError:{name:"BalanceMismatchError",subtypes:[],props:{final_accounts_balance:"",final_postponed_receipts_balance:"",incoming_receipts_balance:"",incoming_validator_rewards:"",initial_accounts_balance:"",initial_postponed_receipts_balance:"",new_delayed_receipts_balance:"",other_burnt_amount:"",outgoing_receipts_balance:"",processed_delayed_receipts_balance:"",slashed_burnt_amount:"",tx_burnt_amount:""}},CostOverflow:{name:"CostOverflow",subtypes:[],props:{}},CreateAccountNotAllowed:{name:"CreateAccountNotAllowed",subtypes:[],props:{account_id:"",predecessor_id:""}},CreateAccountOnlyByRegistrar:{name:"CreateAccountOnlyByRegistrar",subtypes:[],props:{account_id:"",predecessor_id:"",registrar_account_id:""}},DeleteAccountStaking:{name:"DeleteAccountStaking",subtypes:[],props:{account_id:""}},DeleteActionMustBeFinal:{name:"DeleteActionMustBeFinal",subtypes:[],props:{}},DeleteKeyDoesNotExist:{name:"DeleteKeyDoesNotExist",subtypes:[],props:{account_id:"",public_key:""}},DepositWithFunctionCall:{name:"DepositWithFunctionCall",subtypes:[],props:{}},Expired:{name:"Expired",subtypes:[],props:{}},FunctionCallArgumentsLengthExceeded:{name:"FunctionCallArgumentsLengthExceeded",subtypes:[],props:{length:"",limit:""}},FunctionCallMethodNameLengthExceeded:{name:"FunctionCallMethodNameLengthExceeded",subtypes:[],props:{length:"",limit:""}},FunctionCallZeroAttachedGas:{name:"FunctionCallZeroAttachedGas",subtypes:[],props:{}},InsufficientStake:{name:"InsufficientStake",subtypes:[],props:{account_id:"",minimum_stake:"",stake:""}},InvalidAccessKeyError:{name:"InvalidAccessKeyError",subtypes:["AccessKeyNotFound","ReceiverMismatch","MethodNameMismatch","RequiresFullAccess","NotEnoughAllowance","DepositWithFunctionCall"],props:{}},InvalidChain:{name:"InvalidChain",subtypes:[],props:{}},InvalidDataReceiverId:{name:"InvalidDataReceiverId",subtypes:[],props:{account_id:""}},InvalidNonce:{name:"InvalidNonce",subtypes:[],props:{ak_nonce:"",tx_nonce:""}},InvalidPredecessorId:{name:"InvalidPredecessorId",subtypes:[],props:{account_id:""}},InvalidReceiverId:{name:"InvalidReceiverId",subtypes:[],props:{account_id:""}},InvalidSignature:{name:"InvalidSignature",subtypes:[],props:{}},InvalidSignerId:{name:"InvalidSignerId",subtypes:[],props:{account_id:""}},InvalidTxError:{name:"InvalidTxError",subtypes:["InvalidAccessKeyError","InvalidSignerId","SignerDoesNotExist","InvalidNonce","InvalidReceiverId","InvalidSignature","NotEnoughBalance","LackBalanceForState","CostOverflow","InvalidChain","Expired","ActionsValidation"],props:{}},LackBalanceForState:{name:"LackBalanceForState",subtypes:[],props:{account_id:"",amount:""}},MethodNameMismatch:{name:"MethodNameMismatch",subtypes:[],props:{method_name:""}},NotEnoughAllowance:{name:"NotEnoughAllowance",subtypes:[],props:{account_id:"",allowance:"",cost:"",public_key:""}},NotEnoughBalance:{name:"NotEnoughBalance",subtypes:[],props:{balance:"",cost:"",signer_id:""}},OnlyImplicitAccountCreationAllowed:{name:"OnlyImplicitAccountCreationAllowed",subtypes:[],props:{account_id:""}},ReceiptValidationError:{name:"ReceiptValidationError",subtypes:["InvalidPredecessorId","InvalidReceiverId","InvalidSignerId","InvalidDataReceiverId","ReturnedValueLengthExceeded","NumberInputDataDependenciesExceeded","ActionsValidation"],props:{}},ReceiverMismatch:{name:"ReceiverMismatch",subtypes:[],props:{ak_receiver:"",tx_receiver:""}},RequiresFullAccess:{name:"RequiresFullAccess",subtypes:[],props:{}},SignerDoesNotExist:{name:"SignerDoesNotExist",subtypes:[],props:{signer_id:""}},TotalNumberOfActionsExceeded:{name:"TotalNumberOfActionsExceeded",subtypes:[],props:{limit:"",total_number_of_actions:""}},TotalPrepaidGasExceeded:{name:"TotalPrepaidGasExceeded",subtypes:[],props:{limit:"",total_prepaid_gas:""}},TriesToStake:{name:"TriesToStake",subtypes:[],props:{account_id:"",balance:"",locked:"",stake:""}},TriesToUnstake:{name:"TriesToUnstake",subtypes:[],props:{account_id:""}},TxExecutionError:{name:"TxExecutionError",subtypes:["ActionError","InvalidTxError"],props:{}},UnsuitableStakingKey:{name:"UnsuitableStakingKey",subtypes:[],props:{public_key:""}},Closed:{name:"Closed",subtypes:[],props:{}},InternalError:{name:"InternalError",subtypes:[],props:{}},ServerError:{name:"ServerError",subtypes:["TxExecutionError","Timeout","Closed","InternalError"],props:{}},Timeout:{name:"Timeout",subtypes:[],props:{}}}),require$$1={schema:schema},GasLimitExceeded="Exceeded the maximum amount of gas allowed to burn per contract",MethodEmptyName="Method name is empty",WasmerCompileError="Wasmer compilation error: {{msg}}",GuestPanic="Smart contract panicked: {{panic_msg}}",Memory="Error creating Wasm memory",GasExceeded="Exceeded the prepaid gas",MethodUTF8Error="Method name is not valid UTF8 string",BadUTF16="String encoding is bad UTF-16 sequence",WasmTrap="WebAssembly trap: {{msg}}",GasInstrumentation="Gas instrumentation failed or contract has denied instructions.",InvalidPromiseIndex="{{promise_idx}} does not correspond to existing promises",InvalidPromiseResultIndex="Accessed invalid promise result index: {{result_idx}}",Deserialization="Error happened while deserializing the module",MethodNotFound="Contract method is not found",InvalidRegisterId="Accessed invalid register id: {{register_id}}",InvalidReceiptIndex="VM Logic returned an invalid receipt index: {{receipt_index}}",EmptyMethodName="Method name is empty in contract call",CannotReturnJointPromise="Returning joint promise is currently prohibited",StackHeightInstrumentation="Stack instrumentation failed",CodeDoesNotExist="Cannot find contract code for account {{account_id}}",MethodInvalidSignature="Invalid method signature",IntegerOverflow="Integer overflow happened during contract execution",MemoryAccessViolation="MemoryAccessViolation",InvalidIteratorIndex="Iterator index {{iterator_index}} does not exist",IteratorWasInvalidated="Iterator {{iterator_index}} was invalidated after its creation by performing a mutable operation on trie",InvalidAccountId="VM Logic returned an invalid account id",Serialization="Error happened while serializing the module",CannotAppendActionToJointPromise="Actions can only be appended to non-joint promise.",InternalMemoryDeclared="Internal memory declaration has been found in the module",Instantiate="Error happened during instantiation",ProhibitedInView="{{method_name}} is not allowed in view calls",InvalidMethodName="VM Logic returned an invalid method name",BadUTF8="String encoding is bad UTF-8 sequence",BalanceExceeded="Exceeded the account balance",LinkError="Wasm contract link error: {{msg}}",InvalidPublicKey="VM Logic provided an invalid public key",ActorNoPermission="Actor {{actor_id}} doesn't have permission to account {{account_id}} to complete the action",LackBalanceForState="The account {{account_id}} wouldn't have enough balance to cover storage, required to have {{amount}} yoctoNEAR more",ReceiverMismatch="Wrong AccessKey used for transaction: transaction is sent to receiver_id={{tx_receiver}}, but is signed with function call access key that restricted to only use with receiver_id={{ak_receiver}}. Either change receiver_id in your transaction or switch to use a FullAccessKey.",CostOverflow="Transaction gas or balance cost is too high",InvalidSignature="Transaction is not signed with the given public key",AccessKeyNotFound='Signer "{{account_id}}" doesn\'t have access key with the given public_key {{public_key}}',NotEnoughBalance="Sender {{signer_id}} does not have enough balance {{#formatNear}}{{balance}}{{/formatNear}} for operation costing {{#formatNear}}{{cost}}{{/formatNear}}",NotEnoughAllowance="Access Key {account_id}:{public_key} does not have enough balance {{#formatNear}}{{allowance}}{{/formatNear}} for transaction costing {{#formatNear}}{{cost}}{{/formatNear}}",Expired="Transaction has expired",DeleteAccountStaking="Account {{account_id}} is staking and can not be deleted",SignerDoesNotExist="Signer {{signer_id}} does not exist",TriesToStake="Account {{account_id}} tried to stake {{#formatNear}}{{stake}}{{/formatNear}}, but has staked {{#formatNear}}{{locked}}{{/formatNear}} and only has {{#formatNear}}{{balance}}{{/formatNear}}",AddKeyAlreadyExists="The public key {{public_key}} is already used for an existing access key",InvalidSigner="Invalid signer account ID {{signer_id}} according to requirements",CreateAccountNotAllowed="The new account_id {{account_id}} can't be created by {{predecessor_id}}",RequiresFullAccess="The transaction contains more then one action, but it was signed with an access key which allows transaction to apply only one specific action. To apply more then one actions TX must be signed with a full access key",TriesToUnstake="Account {{account_id}} is not yet staked, but tried to unstake",InvalidNonce="Transaction nonce {{tx_nonce}} must be larger than nonce of the used access key {{ak_nonce}}",AccountAlreadyExists="Can't create a new account {{account_id}}, because it already exists",InvalidChain="Transaction parent block hash doesn't belong to the current chain",AccountDoesNotExist="Can't complete the action because account {{account_id}} doesn't exist",MethodNameMismatch="Transaction method name {{method_name}} isn't allowed by the access key",DeleteAccountHasRent="Account {{account_id}} can't be deleted. It has {{#formatNear}}{{balance}}{{/formatNear}}, which is enough to cover the rent",DeleteAccountHasEnoughBalance="Account {{account_id}} can't be deleted. It has {{#formatNear}}{{balance}}{{/formatNear}}, which is enough to cover it's storage",InvalidReceiver="Invalid receiver account ID {{receiver_id}} according to requirements",DeleteKeyDoesNotExist="Account {{account_id}} tries to remove an access key that doesn't exist",Timeout="Timeout exceeded",Closed="Connection closed",require$$2={GasLimitExceeded:GasLimitExceeded,MethodEmptyName:MethodEmptyName,WasmerCompileError:WasmerCompileError,GuestPanic:GuestPanic,Memory:Memory,GasExceeded:GasExceeded,MethodUTF8Error:MethodUTF8Error,BadUTF16:BadUTF16,WasmTrap:WasmTrap,GasInstrumentation:GasInstrumentation,InvalidPromiseIndex:InvalidPromiseIndex,InvalidPromiseResultIndex:InvalidPromiseResultIndex,Deserialization:Deserialization,MethodNotFound:MethodNotFound,InvalidRegisterId:InvalidRegisterId,InvalidReceiptIndex:InvalidReceiptIndex,EmptyMethodName:EmptyMethodName,CannotReturnJointPromise:CannotReturnJointPromise,StackHeightInstrumentation:StackHeightInstrumentation,CodeDoesNotExist:CodeDoesNotExist,MethodInvalidSignature:MethodInvalidSignature,IntegerOverflow:IntegerOverflow,MemoryAccessViolation:MemoryAccessViolation,InvalidIteratorIndex:InvalidIteratorIndex,IteratorWasInvalidated:IteratorWasInvalidated,InvalidAccountId:InvalidAccountId,Serialization:Serialization,CannotAppendActionToJointPromise:CannotAppendActionToJointPromise,InternalMemoryDeclared:InternalMemoryDeclared,Instantiate:Instantiate,ProhibitedInView:ProhibitedInView,InvalidMethodName:InvalidMethodName,BadUTF8:BadUTF8,BalanceExceeded:BalanceExceeded,LinkError:LinkError,InvalidPublicKey:InvalidPublicKey,ActorNoPermission:ActorNoPermission,LackBalanceForState:LackBalanceForState,ReceiverMismatch:ReceiverMismatch,CostOverflow:CostOverflow,InvalidSignature:InvalidSignature,AccessKeyNotFound:AccessKeyNotFound,NotEnoughBalance:NotEnoughBalance,NotEnoughAllowance:NotEnoughAllowance,Expired:Expired,DeleteAccountStaking:DeleteAccountStaking,SignerDoesNotExist:SignerDoesNotExist,TriesToStake:TriesToStake,AddKeyAlreadyExists:AddKeyAlreadyExists,InvalidSigner:InvalidSigner,CreateAccountNotAllowed:CreateAccountNotAllowed,RequiresFullAccess:RequiresFullAccess,TriesToUnstake:TriesToUnstake,InvalidNonce:InvalidNonce,AccountAlreadyExists:AccountAlreadyExists,InvalidChain:InvalidChain,AccountDoesNotExist:AccountDoesNotExist,MethodNameMismatch:MethodNameMismatch,DeleteAccountHasRent:DeleteAccountHasRent,DeleteAccountHasEnoughBalance:DeleteAccountHasEnoughBalance,InvalidReceiver:InvalidReceiver,DeleteKeyDoesNotExist:DeleteKeyDoesNotExist,Timeout:Timeout,Closed:Closed},__importDefault$9=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rpc_errors,"__esModule",{value:!0}),rpc_errors.getErrorTypeFromErrorMessage=rpc_errors.formatError=rpc_errors.parseResultError=rpc_errors.parseRpcError=rpc_errors.ServerError=void 0;const mustache_1=__importDefault$9(mustache.exports),rpc_error_schema_json_1=__importDefault$9(require$$1),error_messages_json_1=__importDefault$9(require$$2),common_index_1=commonIndex,errors_1$2=errors,mustacheHelpers={formatNear:()=>(e,t)=>common_index_1.utils.format.formatNearAmount(t(e))};class ServerError extends errors_1$2.TypedError{}rpc_errors.ServerError=ServerError;class ServerTransactionError extends ServerError{}function parseRpcError(e){var t={},e=walkSubtype(e,rpc_error_schema_json_1.default.schema,t,""),e=new ServerError(formatError(e,t),e);return Object.assign(e,t),e}function parseResultError(e){var t=parseRpcError(e.status.Failure);const r=new ServerTransactionError;return Object.assign(r,t),r.type=t.type,r.message=t.message,r.transaction_outcome=e.transaction_outcome,r}function formatError(e,t){return"string"==typeof error_messages_json_1.default[e]?mustache_1.default.render(error_messages_json_1.default[e],{...t,...mustacheHelpers}):JSON.stringify(t)}function walkSubtype(e,t,r,n){let o,i,a;for(const s in t){if(isString(e[s]))return e[s];isObject$1(e[s])?(o=e[s],i=t[s],a=s):isObject$1(e.kind)&&isObject$1(e.kind[s])&&(o=e.kind[s],i=t[s],a=s)}if(o&&i){for(const c of Object.keys(i.props))r[c]=o[c];return walkSubtype(o,t,r,a)}return r.kind=e,n}function getErrorTypeFromErrorMessage(e){switch(!0){case/^account .*? does not exist while viewing$/.test(e):case/^Account .*? doesn't exist$/.test(e):return"AccountDoesNotExist";case/^access key .*? does not exist while viewing$/.test(e):return"AccessKeyDoesNotExist";case/wasm execution failed with error: FunctionCallError\(CompilationError\(CodeDoesNotExist/.test(e):return"CodeDoesNotExist";case/Transaction nonce \d+ must be larger than nonce of the used access key \d+/.test(e):return"InvalidNonce";default:return"UntypedError"}}function isObject$1(e){return"[object Object]"===Object.prototype.toString.call(e)}function isString(e){return"[object String]"===Object.prototype.toString.call(e)}rpc_errors.parseRpcError=parseRpcError,rpc_errors.parseResultError=parseResultError,rpc_errors.formatError=formatError,rpc_errors.getErrorTypeFromErrorMessage=getErrorTypeFromErrorMessage,!function(e){var t=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.JsonRpcProvider=e.ErrorContext=e.TypedError=void 0;const o=t(depd_1$5);var r=provider;const i=web,a=errors,n=(Object.defineProperty(e,"TypedError",{enumerable:!0,get:function(){return a.TypedError}}),Object.defineProperty(e,"ErrorContext",{enumerable:!0,get:function(){return a.ErrorContext}}),lib$1),s=t(exponentialBackoff$1),c=rpc_errors;let u=123;class l extends r.Provider{constructor(e){if(super(),null!=e&&"object"==typeof e)this.connection=e;else{const t=o.default("JsonRpcProvider(url?: string)");t("use `JsonRpcProvider(connectionInfo: ConnectionInfo)` instead"),this.connection={url:e}}}async status(){return this.sendJsonRpc("status",[])}async sendTransaction(e){e=e.encode();return this.sendJsonRpc("broadcast_tx_commit",[Buffer.from(e).toString("base64")])}async sendTransactionAsync(e){e=e.encode();return this.sendJsonRpc("broadcast_tx_async",[Buffer.from(e).toString("base64")])}async txStatus(e,t){return"string"==typeof e?this.txStatusString(e,t):this.txStatusUint8Array(e,t)}async txStatusUint8Array(e,t){return this.sendJsonRpc("tx",[n.baseEncode(e),t])}async txStatusString(e,t){return this.sendJsonRpc("tx",[e,t])}async txStatusReceipts(e,t){return this.sendJsonRpc("EXPERIMENTAL_tx_status",[n.baseEncode(e),t])}async query(...e){let t;var r,n;if((t=1===e.length?await this.sendJsonRpc("query",e[0]):([r,n]=e,await this.sendJsonRpc("query",[r,n])))&&t.error)throw new a.TypedError(`Querying ${e} failed: ${t.error}.
`+JSON.stringify(t,null,2),c.getErrorTypeFromErrorMessage(t.error));return t}async block(e){var t=e["finality"];let r=e["blockId"];if("object"!=typeof e){const n=o.default("JsonRpcProvider.block(blockId)");n("use `block({ blockId })` or `block({ finality })` instead"),r=e}return this.sendJsonRpc("block",{block_id:r,finality:t})}async blockChanges(e){var t=e["finality"],e=e["blockId"];return this.sendJsonRpc("EXPERIMENTAL_changes_in_block",{block_id:e,finality:t})}async chunk(e){return this.sendJsonRpc("chunk",[e])}async validators(e){return this.sendJsonRpc("validators",[e])}async experimental_genesisConfig(){const e=o.default("JsonRpcProvider.experimental_protocolConfig()");return e("use `experimental_protocolConfig({ sync_checkpoint: 'genesis' })` to fetch the up-to-date or genesis protocol config explicitly"),this.sendJsonRpc("EXPERIMENTAL_protocol_config",{sync_checkpoint:"genesis"})}async experimental_protocolConfig(e){return this.sendJsonRpc("EXPERIMENTAL_protocol_config",e)}async experimental_lightClientProof(e){const t=o.default("JsonRpcProvider.experimental_lightClientProof(request)");return t("use `lightClientProof` instead"),this.lightClientProof(e)}async lightClientProof(e){return this.sendJsonRpc("EXPERIMENTAL_light_client_proof",e)}async accessKeyChanges(e,t){var r=t["finality"],t=t["blockId"];return this.sendJsonRpc("EXPERIMENTAL_changes",{changes_type:"all_access_key_changes",account_ids:e,block_id:t,finality:r})}async singleAccessKeyChanges(e,t){var r=t["finality"],t=t["blockId"];return this.sendJsonRpc("EXPERIMENTAL_changes",{changes_type:"single_access_key_changes",keys:e,block_id:t,finality:r})}async accountChanges(e,t){var r=t["finality"],t=t["blockId"];return this.sendJsonRpc("EXPERIMENTAL_changes",{changes_type:"account_changes",account_ids:e,block_id:t,finality:r})}async contractStateChanges(e,t,r=""){var n=t["finality"],t=t["blockId"];return this.sendJsonRpc("EXPERIMENTAL_changes",{changes_type:"data_changes",account_ids:e,key_prefix_base64:r,block_id:t,finality:n})}async contractCodeChanges(e,t){var r=t["finality"],t=t["blockId"];return this.sendJsonRpc("EXPERIMENTAL_changes",{changes_type:"contract_code_changes",account_ids:e,block_id:t,finality:r})}async gasPrice(e){return this.sendJsonRpc("gas_price",[e])}async sendJsonRpc(n,o){var e=(await s.default(500,12,1.5,async()=>{try{var e={method:n,params:o,id:u++,jsonrpc:"2.0"},t=await i.fetchJson(this.connection,JSON.stringify(e));if(t.error){if("object"==typeof t.error.data){if("string"==typeof t.error.data.error_message&&"string"==typeof t.error.data.error_type)throw new a.TypedError(t.error.data.error_message,t.error.data.error_type);throw c.parseRpcError(t.error.data)}{const r=`[${t.error.code}] ${t.error.message}: `+t.error.data;if("Timeout"===t.error.data||r.includes("Timeout error")||r.includes("query has timed out"))throw new a.TypedError(r,"TimeoutError");throw new a.TypedError(r,c.getErrorTypeFromErrorMessage(t.error.data))}}return t}catch(e){if("TimeoutError"===e.type)return process.env.NEAR_NO_LOGS||console.warn(`Retrying request to ${n} as it has timed out`,o),null;throw e}}))["result"];if(void 0===e)throw new a.TypedError(`Exceeded 12 attempts for request to ${n}.`,"RetriesExceeded");return e}}e.JsonRpcProvider=l}(jsonRpcProvider),!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorContext=e.TypedError=e.getTransactionLastResult=e.FinalExecutionStatusBasic=e.JsonRpcProvider=e.Provider=void 0;const t=provider,r=(Object.defineProperty(e,"Provider",{enumerable:!0,get:function(){return t.Provider}}),Object.defineProperty(e,"getTransactionLastResult",{enumerable:!0,get:function(){return t.getTransactionLastResult}}),Object.defineProperty(e,"FinalExecutionStatusBasic",{enumerable:!0,get:function(){return t.FinalExecutionStatusBasic}}),jsonRpcProvider);Object.defineProperty(e,"JsonRpcProvider",{enumerable:!0,get:function(){return r.JsonRpcProvider}}),Object.defineProperty(e,"TypedError",{enumerable:!0,get:function(){return r.TypedError}}),Object.defineProperty(e,"ErrorContext",{enumerable:!0,get:function(){return r.ErrorContext}})}(providers);var utils={},format={},transaction=(!function(o){var e=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.parseNearAmount=o.formatNearAmount=o.NEAR_NOMINATION=o.NEAR_NOMINATION_EXP=void 0;const i=e(bn.exports),a=(o.NEAR_NOMINATION_EXP=24,o.NEAR_NOMINATION=new i.default("10",10).pow(new i.default(o.NEAR_NOMINATION_EXP,10)),[]);var r=new i.default(10);for(let e=0,t=new i.default(5);e<o.NEAR_NOMINATION_EXP;e++,t=t.mul(r))a[e]=t;o.formatNearAmount=function(e,t=o.NEAR_NOMINATION_EXP){const r=new i.default(e,10);t!==o.NEAR_NOMINATION_EXP&&0<(n=o.NEAR_NOMINATION_EXP-t-1)&&r.iadd(a[n]);var n=(e=r.toString()).substring(0,e.length-o.NEAR_NOMINATION_EXP)||"0",e=e.substring(e.length-o.NEAR_NOMINATION_EXP).padStart(o.NEAR_NOMINATION_EXP,"0").substring(0,t);return(function(e){const t=/(-?\d+)(\d{3})/;for(;t.test(e);)e=e.replace(t,"$1,$2");return e}(n)+"."+e).replace(/\.?0*$/,"")},o.parseNearAmount=function(e){if(!e)return null;var t=(e=e.replace(/,/g,"").trim()).split("."),r=t[0];const n=t[1]||"";if(2<t.length||n.length>o.NEAR_NOMINATION_EXP)throw new Error(`Cannot parse '${e}' as NEAR amount`);return""!==(t=(t=r+n.padEnd(o.NEAR_NOMINATION_EXP,"0")).replace(/^0+/,""))?t:"0"}}(format),!function(e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),o=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},r=(Object.defineProperty(e,"__esModule",{value:!0}),e.logWarning=e.rpc_errors=e.KeyPairEd25519=e.KeyPair=e.PublicKey=e.format=e.enums=e.web=e.serialize=e.key_pair=void 0,t(key_pair)),r=(e.key_pair=r,t(serialize$1)),r=(e.serialize=r,t(web)),r=(e.web=r,t(enums)),r=(e.enums=r,t(format)),r=(e.format=r,t(rpc_errors));e.rpc_errors=r;const i=key_pair,a=(Object.defineProperty(e,"PublicKey",{enumerable:!0,get:function(){return i.PublicKey}}),Object.defineProperty(e,"KeyPair",{enumerable:!0,get:function(){return i.KeyPair}}),Object.defineProperty(e,"KeyPairEd25519",{enumerable:!0,get:function(){return i.KeyPairEd25519}}),errors);Object.defineProperty(e,"logWarning",{enumerable:!0,get:function(){return a.logWarning}})}(utils),{}),sha256={exports:{}},validators=(!function(module){!function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{},WEB_WORKER=(root.JS_SHA256_NO_WINDOW&&(WINDOW=!1),!WINDOW&&"object"==typeof self),NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node,COMMON_JS=(NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self),!root.JS_SHA256_NO_COMMON_JS&&module.exports),ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[],createOutputMethod=(!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer}),function(t,r){return function(e){return new Sha256(r,!0).update(e)[t]()}}),createMethod=function(e){var t=createOutputMethod("hex",e);(t=NODE_JS?nodeWrap(t,e):t).create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var r=0;r<OUTPUT_TYPES.length;++r){var n=OUTPUT_TYPES[r];t[n]=createOutputMethod(n,e)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(r,n){return function(e,t){return new HmacSha256(e,n,!0).update(t)[r]()}},createHmacMethod=function(t){var r=createHmacOutputMethod("hex",t);r.create=function(e){return new HmacSha256(e,t)},r.update=function(e,t){return r.create(e).update(t)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];r[n]=createHmacOutputMethod(n,t)}return r};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,r){var n=typeof e;if("string"==n){for(var o,i=[],a=e.length,s=0,c=0;c<a;++c)(o=e.charCodeAt(c))<128?i[s++]=o:(o<2048?i[s++]=192|o>>6:(o<55296||57344<=o?i[s++]=224|o>>12:(o=65536+((1023&o)<<10|1023&e.charCodeAt(++c)),i[s++]=240|o>>18,i[s++]=128|o>>12&63),i[s++]=128|o>>6&63),i[s++]=128|63&o);e=i}else{if("object"!=n)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}64<e.length&&(e=new Sha256(t,!0).update(e).array());var u=[],l=[];for(c=0;c<64;++c){var h=e[c]||0;u[c]=92^h,l[c]=54^h}Sha256.call(this,t,r),this.update(l),this.oKeyPad=u,this.inner=!0,this.sharedMemory=r}Sha256.prototype.update=function(e){if(!this.finalized){var t,r=typeof e;if("string"!=r){if("object"!=r)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var n,o,i=0,a=e.length,s=this.blocks;i<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)for(o=this.start;i<a&&o<64;++i)s[o>>2]|=e[i]<<SHIFT[3&o++];else for(o=this.start;i<a&&o<64;++i)(n=e.charCodeAt(i))<128?s[o>>2]|=n<<SHIFT[3&o++]:(n<2048?s[o>>2]|=(192|n>>6)<<SHIFT[3&o++]:(n<55296||57344<=n?s[o>>2]|=(224|n>>12)<<SHIFT[3&o++]:(n=65536+((1023&n)<<10|1023&e.charCodeAt(++i)),s[o>>2]|=(240|n>>18)<<SHIFT[3&o++],s[o>>2]|=(128|n>>12&63)<<SHIFT[3&o++]),s[o>>2]|=(128|n>>6&63)<<SHIFT[3&o++]),s[o>>2]|=(128|63&n)<<SHIFT[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,64<=o?(this.block=s[16],this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){var e,t;this.finalized||(this.finalized=!0,e=this.blocks,t=this.lastByteIndex,e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],56<=t&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash())},Sha256.prototype.hash=function(){for(var e,t,r,n,o,i,a=this.h0,s=this.h1,c=this.h2,u=this.h3,l=this.h4,h=this.h5,d=this.h6,f=this.h7,p=this.blocks,m=16;m<64;++m)e=((t=p[m-15])>>>7|t<<25)^(t>>>18|t<<14)^t>>>3,t=p[m-2],p[m]=p[m-16]+e+p[m-7]+((t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)<<0;for(i=s&c,m=0;m<64;m+=4)this.first?(u=this.is224?(r=300032,f=(t=p[0]-1413257819)-150054599<<0,t+24177077<<0):(r=704751109,f=(t=p[0]-210244248)-1521486534<<0,t+143694565<<0),this.first=!1):(f=u+(t=f+((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&h^~l&d)+K[m]+p[m])<<0,u=t+((e=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+((r=a&s)^a&c^i))<<0),d=c+(t=d+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&l^~f&h)+K[m+1]+p[m+1])<<0,c=t+((e=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10))+((n=u&a)^u&s^r))<<0,h=s+(t=h+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&f^~d&l)+K[m+2]+p[m+2])<<0,s=t+((e=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10))+((o=c&u)^c&a^n))<<0,l=a+(t=l+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&d^~h&f)+K[m+3]+p[m+3])<<0,a=t+((e=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+((i=s&c)^s&u^o))<<0;this.h0=this.h0+a<<0,this.h1=this.h1+s<<0,this.h2=this.h2+c<<0,this.h3=this.h3+u<<0,this.h4=this.h4+l<<0,this.h5=this.h5+h<<0,this.h6=this.h6+d<<0,this.h7=this.h7+f<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,o=this.h4,i=this.h5,a=this.h6,s=this.h7,e=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a];return this.is224||(e+=HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]),e},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,o=this.h4,i=this.h5,a=this.h6,s=this.h7,e=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,n>>24&255,n>>16&255,n>>8&255,255&n,o>>24&255,o>>16&255,o>>8&255,255&o,i>>24&255,i>>16&255,i>>8&255,255&i,a>>24&255,a>>16&255,a>>8&255,255&a];return this.is224||e.push(s>>24&255,s>>16&255,s>>8&255,255&s),e},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){var e;Sha256.prototype.finalize.call(this),this.inner&&(this.inner=!1,e=this.array(),Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this))};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)}()}(sha256),!function(a){var e=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0}),a.signTransaction=a.createTransaction=a.SCHEMA=a.Action=a.SignedTransaction=a.Transaction=a.Signature=a.deleteAccount=a.deleteKey=a.addKey=a.stake=a.transfer=a.functionCall=a.stringifyJsonOrBytes=a.deployContract=a.createAccount=a.DeleteAccount=a.DeleteKey=a.AddKey=a.Stake=a.Transfer=a.FunctionCall=a.DeployContract=a.CreateAccount=a.IAction=a.functionCallAccessKey=a.fullAccessKey=a.AccessKey=a.AccessKeyPermission=a.FullAccessPermission=a.FunctionCallPermission=void 0;const s=e(sha256.exports);e=enums;const c=lib$1;var t=key_pair;class n extends e.Assignable{}a.FunctionCallPermission=n;class r extends e.Assignable{}a.FullAccessPermission=r;class o extends e.Enum{}a.AccessKeyPermission=o;class i extends e.Assignable{}a.AccessKey=i,a.fullAccessKey=function(){return new i({nonce:0,permission:new o({fullAccess:new r({})})})},a.functionCallAccessKey=function(e,t,r){return new i({nonce:0,permission:new o({functionCall:new n({receiverId:e,allowance:r,methodNames:t})})})};class u extends e.Assignable{}class l extends(a.IAction=u){}a.CreateAccount=l;class h extends u{}a.DeployContract=h;class d extends u{}a.FunctionCall=d;class f extends u{}a.Transfer=f;class p extends u{}a.Stake=p;class m extends u{}a.AddKey=m;class y extends u{}a.DeleteKey=y;class g extends u{}function _(e){return void 0!==e.byteLength&&e.byteLength===e.length?e:Buffer.from(JSON.stringify(e))}a.DeleteAccount=g,a.createAccount=function(){return new E({createAccount:new l({})})},a.deployContract=function(e){return new E({deployContract:new h({code:e})})},a.stringifyJsonOrBytes=_,a.functionCall=function(e,t,r,n,o=_){return new E({functionCall:new d({methodName:e,args:o(t),gas:r,deposit:n})})},a.transfer=function(e){return new E({transfer:new f({deposit:e})})},a.stake=function(e,t){return new E({stake:new p({stake:e,publicKey:t})})},a.addKey=function(e,t){return new E({addKey:new m({publicKey:e,accessKey:t})})},a.deleteKey=function(e){return new E({deleteKey:new y({publicKey:e})})},a.deleteAccount=function(e){return new E({deleteAccount:new g({beneficiaryId:e})})};class b extends e.Assignable{}a.Signature=b;class v extends e.Assignable{encode(){return c.serialize(a.SCHEMA,this)}static decode(e){return c.deserialize(a.SCHEMA,v,e)}}a.Transaction=v;class w extends e.Assignable{encode(){return c.serialize(a.SCHEMA,this)}static decode(e){return c.deserialize(a.SCHEMA,w,e)}}a.SignedTransaction=w;class E extends e.Enum{}function A(e,t,r,n,o,i){return new v({signerId:e,publicKey:t,nonce:n,receiverId:r,actions:o,blockHash:i})}async function S(e,t,r,n){var o=c.serialize(a.SCHEMA,e),i=new Uint8Array(s.default.sha256.array(o)),t=await t.signMessage(o,r,n);return[i,new w({transaction:e,signature:new b({keyType:e.publicKey.keyType,data:t.signature})})]}a.Action=E,a.SCHEMA=new Map([[b,{kind:"struct",fields:[["keyType","u8"],["data",[64]]]}],[w,{kind:"struct",fields:[["transaction",v],["signature",b]]}],[v,{kind:"struct",fields:[["signerId","string"],["publicKey",t.PublicKey],["nonce","u64"],["receiverId","string"],["blockHash",[32]],["actions",[E]]]}],[t.PublicKey,{kind:"struct",fields:[["keyType","u8"],["data",[32]]]}],[i,{kind:"struct",fields:[["nonce","u64"],["permission",o]]}],[o,{kind:"enum",field:"enum",values:[["functionCall",n],["fullAccess",r]]}],[n,{kind:"struct",fields:[["allowance",{kind:"option",type:"u128"}],["receiverId","string"],["methodNames",["string"]]]}],[r,{kind:"struct",fields:[]}],[E,{kind:"enum",field:"enum",values:[["createAccount",l],["deployContract",h],["functionCall",d],["transfer",f],["stake",p],["addKey",m],["deleteKey",y],["deleteAccount",g]]}],[l,{kind:"struct",fields:[]}],[h,{kind:"struct",fields:[["code",["u8"]]]}],[d,{kind:"struct",fields:[["methodName","string"],["args",["u8"]],["gas","u64"],["deposit","u128"]]}],[f,{kind:"struct",fields:[["deposit","u128"]]}],[p,{kind:"struct",fields:[["stake","u128"],["publicKey",t.PublicKey]]}],[m,{kind:"struct",fields:[["publicKey",t.PublicKey],["accessKey",i]]}],[y,{kind:"struct",fields:[["publicKey",t.PublicKey]]}],[g,{kind:"struct",fields:[["beneficiaryId","string"]]}]]),a.createTransaction=A,a.signTransaction=async function(...e){var t,r,n,o;if(e[0].constructor===v)return[t,r,n,o]=e,S(t,r,n,o);{const[i,a,s,c,u,l,h]=e;return S(A(l,await u.getPublicKey(l,h),i,a,s,c),u,l,h)}}}(transaction),{}),__importDefault$8=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(validators,"__esModule",{value:!0}),validators.diffEpochValidators=validators.findSeatPrice=void 0;const bn_js_1$4=__importDefault$8(bn.exports),depd_1$3=__importDefault$8(depd_1$5);function findSeatPrice(e,t,r,n){if(n&&n<49)return findSeatPriceForProtocolBefore49(e,t);if(!r){const o=depd_1$3.default("findSeatPrice(validators, maxNumberOfSeats)");o("`use `findSeatPrice(validators, maxNumberOfSeats, minimumStakeRatio)` instead"),r=[1,6250]}return findSeatPriceForProtocolAfter49(e,t,r)}function findSeatPriceForProtocolBefore49(e,t){const n=e.map(e=>new bn_js_1$4.default(e.stake,10)).sort((e,t)=>e.cmp(t));var o=new bn_js_1$4.default(t);const r=n.reduce((e,t)=>e.add(t));if(r.lt(o))throw new Error("Stakes are below seats");let i=new bn_js_1$4.default(1),a=r.add(new bn_js_1$4.default(1));for(;!i.eq(a.sub(new bn_js_1$4.default(1)));){var s=i.add(a).div(new bn_js_1$4.default(2));let t=!1,r=new bn_js_1$4.default(0);for(let e=0;e<n.length;++e)if((r=r.add(n[e].div(s))).gte(o)){i=s,t=!0;break}t||(a=s)}return i}function findSeatPriceForProtocolAfter49(e,t,r){if(2!=r.length)throw Error("minimumStakeRatio should have 2 elements");const n=e.map(e=>new bn_js_1$4.default(e.stake,10)).sort((e,t)=>e.cmp(t)),o=n.reduce((e,t)=>e.add(t));return e.length<t?o.mul(new bn_js_1$4.default(r[0])).div(new bn_js_1$4.default(r[1])):n[0].add(new bn_js_1$4.default(1))}function diffEpochValidators(e,t){const r=new Map,n=(e.forEach(e=>r.set(e.account_id,e)),new Set(t.map(e=>e.account_id)));return{newValidators:t.filter(e=>!r.has(e.account_id)),removedValidators:e.filter(e=>!n.has(e.account_id)),changedValidators:t.filter(e=>r.has(e.account_id)&&r.get(e.account_id).stake!=e.stake).map(e=>({current:r.get(e.account_id),next:e}))}}validators.findSeatPrice=findSeatPrice,validators.diffEpochValidators=diffEpochValidators;var account={},constants={},__importDefault$7=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(constants,"__esModule",{value:!0}),constants.DEFAULT_FUNCTION_CALL_GAS=void 0;const bn_js_1$3=__importDefault$7(bn.exports);constants.DEFAULT_FUNCTION_CALL_GAS=new bn_js_1$3.default("30000000000000");var __importDefault$6=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(account,"__esModule",{value:!0}),account.Account=void 0;const bn_js_1$2=__importDefault$6(bn.exports),depd_1$2=__importDefault$6(depd_1$5),transaction_1$1=transaction,providers_1$2=providers,borsh_1$1=lib$1,key_pair_1$1=key_pair,errors_1$1=errors,rpc_errors_1=rpc_errors,constants_1=constants,exponential_backoff_1=__importDefault$6(exponentialBackoff$1),TX_NONCE_RETRY_NUMBER=12,TX_NONCE_RETRY_WAIT=500,TX_NONCE_RETRY_WAIT_BACKOFF=1.5;function parseJsonFromRawResponse(e){return JSON.parse(Buffer.from(e).toString())}function bytesJsonStringify(e){return Buffer.from(JSON.stringify(e))}class Account{constructor(e,t){this.accessKeyByPublicKeyCache={},this.connection=e,this.accountId=t}get ready(){const e=depd_1$2.default("Account.ready()");return e("not needed anymore, always ready"),Promise.resolve()}async fetchState(){const e=depd_1$2.default("Account.fetchState()");e("use `Account.state()` instead")}async state(){return this.connection.provider.query({request_type:"view_account",account_id:this.accountId,finality:"optimistic"})}printLogsAndFailures(e,t){if(!process.env.NEAR_NO_LOGS)for(const r of t)console.log(`Receipt${1<r.receiptIds.length?"s":""}: `+r.receiptIds.join(", ")),this.printLogs(e,r.logs,"\t"),r.failure&&console.warn(`	Failure [${e}]: `+r.failure)}printLogs(e,t,r=""){if(!process.env.NEAR_NO_LOGS)for(const n of t)console.log(r+`Log [${e}]: `+n)}async signTransaction(e,t){var r=await this.findAccessKey(e,t);if(!r)throw new providers_1$2.TypedError(`Can not sign transactions for account ${this.accountId} on network ${this.connection.networkId}, no matching key pair found in ${this.connection.signer}.`,"KeyNotFound");const n=r["accessKey"];var r=(await this.connection.provider.block({finality:"final"})).header.hash,o=++n.nonce;return transaction_1$1.signTransaction(e,o,t,borsh_1$1.baseDecode(r),this.connection.signer,this.accountId,this.connection.networkId)}signAndSendTransaction(...e){return"string"==typeof e[0]?this.signAndSendTransactionV1(e[0],e[1]):this.signAndSendTransactionV2(e[0])}signAndSendTransactionV1(e,t){const r=depd_1$2.default("Account.signAndSendTransaction(receiverId, actions");return r("use `Account.signAndSendTransaction(SignAndSendTransactionOptions)` instead"),this.signAndSendTransactionV2({receiverId:e,actions:t})}async signAndSendTransactionV2({receiverId:r,actions:e,returnError:t}){let n,o;const i=await exponential_backoff_1.default(TX_NONCE_RETRY_WAIT,TX_NONCE_RETRY_NUMBER,TX_NONCE_RETRY_WAIT_BACKOFF,async()=>{[n,o]=await this.signTransaction(r,e);const t=o.transaction.publicKey;try{return await this.connection.provider.sendTransaction(o)}catch(e){if("InvalidNonce"===e.type)return errors_1$1.logWarning(`Retrying transaction ${r}:${borsh_1$1.baseEncode(n)} with new nonce.`),delete this.accessKeyByPublicKeyCache[t.toString()],null;if("Expired"===e.type)return errors_1$1.logWarning(`Retrying transaction ${r}:${borsh_1$1.baseEncode(n)} due to expired block hash`),null;throw e.context=new providers_1$2.ErrorContext(borsh_1$1.baseEncode(n)),e}});if(!i)throw new providers_1$2.TypedError("nonce retries exceeded for transaction. This usually means there are too many parallel requests with the same access key.","RetriesExceeded");var a=[i.transaction_outcome,...i.receipts_outcome].reduce((e,t)=>t.outcome.logs.length||"object"==typeof t.outcome.status&&"object"==typeof t.outcome.status.Failure?e.concat({receiptIds:t.outcome.receipt_ids,logs:t.outcome.logs,failure:void 0!==t.outcome.status.Failure?rpc_errors_1.parseRpcError(t.outcome.status.Failure):null}):e,[]);if(this.printLogsAndFailures(o.transaction.receiverId,a),t||"object"!=typeof i.status||"object"!=typeof i.status.Failure)return i;throw i.status.Failure.error_message&&i.status.Failure.error_type?new providers_1$2.TypedError(`Transaction ${i.transaction_outcome.id} failed. `+i.status.Failure.error_message,i.status.Failure.error_type):rpc_errors_1.parseResultError(i)}async findAccessKey(e,t){const r=await this.connection.signer.getPublicKey(this.accountId,this.connection.networkId);if(!r)return null;var n=this.accessKeyByPublicKeyCache[r.toString()];if(void 0!==n)return{publicKey:r,accessKey:n};try{var o=await this.connection.provider.query({request_type:"view_access_key",account_id:this.accountId,public_key:r.toString(),finality:"optimistic"});return this.accessKeyByPublicKeyCache[r.toString()]?{publicKey:r,accessKey:this.accessKeyByPublicKeyCache[r.toString()]}:(this.accessKeyByPublicKeyCache[r.toString()]=o,{publicKey:r,accessKey:o})}catch(e){if("AccessKeyDoesNotExist"==e.type)return null;throw e}}async createAndDeployContract(e,t,r,n){var o=transaction_1$1.fullAccessKey(),n=(await this.signAndSendTransaction({receiverId:e,actions:[transaction_1$1.createAccount(),transaction_1$1.transfer(n),transaction_1$1.addKey(key_pair_1$1.PublicKey.from(t),o),transaction_1$1.deployContract(r)]}),new Account(this.connection,e));return n}async sendMoney(e,t){return this.signAndSendTransaction({receiverId:e,actions:[transaction_1$1.transfer(t)]})}async createAccount(e,t,r){var n=transaction_1$1.fullAccessKey();return this.signAndSendTransaction({receiverId:e,actions:[transaction_1$1.createAccount(),transaction_1$1.transfer(r),transaction_1$1.addKey(key_pair_1$1.PublicKey.from(t),n)]})}async deleteAccount(e){return this.signAndSendTransaction({receiverId:this.accountId,actions:[transaction_1$1.deleteAccount(e)]})}async deployContract(e){return this.signAndSendTransaction({receiverId:this.accountId,actions:[transaction_1$1.deployContract(e)]})}async functionCall(...e){return"string"==typeof e[0]?this.functionCallV1(e[0],e[1],e[2],e[3],e[4]):this.functionCallV2(e[0])}functionCallV1(e,t,r,n,o){const i=depd_1$2.default("Account.functionCall(contractId, methodName, args, gas, amount)");return i("use `Account.functionCall(FunctionCallOptions)` instead"),this.validateArgs(r=r||{}),this.signAndSendTransaction({receiverId:e,actions:[transaction_1$1.functionCall(t,r,n||constants_1.DEFAULT_FUNCTION_CALL_GAS,o)]})}functionCallV2({contractId:e,methodName:t,args:r={},gas:n=constants_1.DEFAULT_FUNCTION_CALL_GAS,attachedDeposit:o,walletMeta:i,walletCallbackUrl:a,stringify:s}){this.validateArgs(r);s=void 0===s?transaction_1$1.stringifyJsonOrBytes:s;return this.signAndSendTransaction({receiverId:e,actions:[transaction_1$1.functionCall(t,r,n,o,s)],walletMeta:i,walletCallbackUrl:a})}async addKey(e,t,r,n){r=r||[],Array.isArray(r)||(r=[r]);let o;return o=t?transaction_1$1.functionCallAccessKey(t,r,n):transaction_1$1.fullAccessKey(),this.signAndSendTransaction({receiverId:this.accountId,actions:[transaction_1$1.addKey(key_pair_1$1.PublicKey.from(e),o)]})}async deleteKey(e){return this.signAndSendTransaction({receiverId:this.accountId,actions:[transaction_1$1.deleteKey(key_pair_1$1.PublicKey.from(e))]})}async stake(e,t){return this.signAndSendTransaction({receiverId:this.accountId,actions:[transaction_1$1.stake(t,key_pair_1$1.PublicKey.from(e))]})}validateArgs(e){var t=void 0!==e.byteLength&&e.byteLength===e.length;if(!t&&(Array.isArray(e)||"object"!=typeof e))throw new errors_1$1.PositionalArgsError}async viewFunction(e,t,r={},{parse:n=parseJsonFromRawResponse,stringify:o=bytesJsonStringify}={}){this.validateArgs(r);o=o(r).toString("base64"),r=await this.connection.provider.query({request_type:"call_function",account_id:e,method_name:t,args_base64:o,finality:"optimistic"});return r.logs&&this.printLogs(e,r.logs),r.result&&0<r.result.length&&n(Buffer.from(r.result))}async viewState(e,t={finality:"optimistic"}){const r=(await this.connection.provider.query({request_type:"view_state",...t,account_id:this.accountId,prefix_base64:Buffer.from(e).toString("base64")}))["values"];return r.map(({key:e,value:t})=>({key:Buffer.from(e,"base64"),value:Buffer.from(t,"base64")}))}async getAccessKeys(){var e=await this.connection.provider.query({request_type:"view_access_key_list",account_id:this.accountId,finality:"optimistic"});return Array.isArray(e)?e:e.keys}async getAccountDetails(){const e=await this.getAccessKeys();return{authorizedApps:e.filter(e=>"FullAccess"!==e.access_key.permission).map(e=>{var t=e.access_key.permission;return{contractId:t.FunctionCall.receiver_id,amount:t.FunctionCall.allowance,publicKey:e.public_key}})}}async getAccountBalance(){var e=await this.connection.provider.experimental_protocolConfig({finality:"final"}),t=await this.state(),e=new bn_js_1$2.default(e.runtime_config.storage_amount_per_byte);const r=new bn_js_1$2.default(t.storage_usage).mul(e),n=new bn_js_1$2.default(t.locked),o=new bn_js_1$2.default(t.amount).add(n),i=o.sub(bn_js_1$2.default.max(n,r));return{total:o.toString(),stateStaked:r.toString(),staked:n.toString(),available:i.toString()}}}account.Account=Account;var account_multisig={},account_creator=(!function(m){var e=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(m,"__esModule",{value:!0}),m.Account2FA=m.AccountMultisig=m.MULTISIG_CONFIRM_METHODS=m.MULTISIG_CHANGE_METHODS=m.MULTISIG_DEPOSIT=m.MULTISIG_GAS=m.MULTISIG_ALLOWANCE=m.MULTISIG_STORAGE_KEY=void 0;const t=e(bn.exports),r=e(depd_1$5);e=account;const n=format,i=key_pair,s=transaction,o=web,a=(m.MULTISIG_STORAGE_KEY="__multisigRequest",m.MULTISIG_ALLOWANCE=new t.default(n.parseNearAmount("1")),m.MULTISIG_GAS=new t.default("100000000000000"),m.MULTISIG_DEPOSIT=new t.default("0"),m.MULTISIG_CHANGE_METHODS=["add_request","add_request_and_confirm","delete_request","confirm"],m.MULTISIG_CONFIRM_METHODS=["confirm"],{[m.MULTISIG_STORAGE_KEY]:null});class c extends e.Account{constructor(e,t,r){super(e,t),this.storage=r.storage,this.onAddRequestResult=r.onAddRequestResult}async signAndSendTransactionWithAccount(e,t){return super.signAndSendTransaction({receiverId:e,actions:t})}signAndSendTransaction(...e){return"string"==typeof e[0]?this._signAndSendTransaction({receiverId:e[0],actions:e[1]}):this._signAndSendTransaction(e[0])}async _signAndSendTransaction({receiverId:t,actions:r}){var e=this["accountId"],n=Buffer.from(JSON.stringify({request:{receiver_id:t,actions:l(r,e,t)}}));let o;try{o=await super.signAndSendTransaction({receiverId:e,actions:[s.functionCall("add_request_and_confirm",n,m.MULTISIG_GAS,m.MULTISIG_DEPOSIT)]})}catch(e){if(e.toString().includes("Account has too many active requests. Confirm or delete some"))return await this.deleteUnconfirmedRequests(),this.signAndSendTransaction(t,r);throw e}if(!o.status)throw new Error("Request failed");n={...o.status};if(n.SuccessValue&&"string"==typeof n.SuccessValue)return this.setRequest({accountId:e,actions:r,requestId:parseInt(Buffer.from(n.SuccessValue,"base64").toString("ascii"),10)}),this.onAddRequestResult&&await this.onAddRequestResult(o),this.deleteUnconfirmedRequests(),o;throw new Error("Request failed")}async deleteUnconfirmedRequests(){var e=await this.getRequestIds(),t=this.getRequest()["requestId"];for(const r of e)if(r!=t)try{await super.signAndSendTransaction({receiverId:this.accountId,actions:[s.functionCall("delete_request",{request_id:r},m.MULTISIG_GAS,m.MULTISIG_DEPOSIT)]})}catch(e){console.warn("Attempt to delete an earlier request before 15 minutes failed. Will try again.")}}async getRequestIds(){return this.viewFunction(this.accountId,"list_request_ids")}getRequest(){return this.storage?JSON.parse(this.storage.getItem(m.MULTISIG_STORAGE_KEY)||"{}"):a[m.MULTISIG_STORAGE_KEY]}setRequest(e){if(this.storage)return this.storage.setItem(m.MULTISIG_STORAGE_KEY,JSON.stringify(e));a[m.MULTISIG_STORAGE_KEY]=e}}(class extends(m.AccountMultisig=c){});m.Account2FA=class extends c{constructor(e,t,r){super(e,t,r),this.helperUrl="https://helper.testnet.near.org",this.helperUrl=r.helperUrl||this.helperUrl,this.storage=r.storage,this.sendCode=r.sendCode||this.sendCodeDefault,this.getCode=r.getCode||this.getCodeDefault,this.verifyCode=r.verifyCode||this.verifyCodeDefault,this.onConfirmResult=r.onConfirmResult}async signAndSendTransaction(...e){if("string"!=typeof e[0])return this.__signAndSendTransaction(e[0]);{const t=r.default("Account.signAndSendTransaction(receiverId, actions");return t("use `Account2FA.signAndSendTransaction(SignAndSendTransactionOptions)` instead"),this.__signAndSendTransaction({receiverId:e[0],actions:e[1]})}}async __signAndSendTransaction({receiverId:e,actions:t}){await super.signAndSendTransaction({receiverId:e,actions:t}),await this.sendCode();e=await this.promptAndVerify();return this.onConfirmResult&&await this.onConfirmResult(e),e}async deployMultisig(e){const t=this["accountId"],r=(await this.getRecoveryMethods()).data.filter(({kind:e,publicKey:t})=>("phrase"===e||"ledger"===e)&&null!==t).map(e=>e.publicKey),n=(await this.getAccessKeys()).filter(({public_key:e,access_key:{permission:t}})=>"FullAccess"===t&&!r.includes(e)).map(e=>e.public_key).map(u);var o=u((await this.postSignedJson("/2fa/getAccessKey",{accountId:t})).publicKey),i=Buffer.from(JSON.stringify({num_confirmations:2}));const a=[...n.map(e=>s.deleteKey(e)),...n.map(e=>s.addKey(e,s.functionCallAccessKey(t,m.MULTISIG_CHANGE_METHODS,null))),s.addKey(o,s.functionCallAccessKey(t,m.MULTISIG_CONFIRM_METHODS,null)),s.deployContract(e)];return"11111111111111111111111111111111"===(await this.state()).code_hash&&a.push(s.functionCall("new",i,m.MULTISIG_GAS,m.MULTISIG_DEPOSIT)),console.log("deploying multisig contract for",t),super.signAndSendTransactionWithAccount(t,a)}async disable(e){const r=this["accountId"],t=await this.getAccessKeys(),n=t.filter(({access_key:e})=>"FullAccess"!==e.permission).filter(({access_key:e})=>{const t=e.permission.FunctionCall;return t.receiver_id===r&&4===t.method_names.length&&t.method_names.includes("add_request_and_confirm")});var o=i.PublicKey.from((await this.postSignedJson("/2fa/getAccessKey",{accountId:r})).publicKey),o=[s.deleteKey(o),...n.map(({public_key:e})=>s.deleteKey(i.PublicKey.from(e))),...n.map(({public_key:e})=>s.addKey(i.PublicKey.from(e),null)),s.deployContract(e)];return console.log("disabling 2fa for",r),this.signAndSendTransaction({receiverId:r,actions:o})}async sendCodeDefault(){var e=this["accountId"],t=this.getRequest()["requestId"],r=await this.get2faMethod();return await this.postSignedJson("/2fa/send",{accountId:e,method:r,requestId:t}),t}async getCodeDefault(e){throw new Error('There is no getCode callback provided. Please provide your own in AccountMultisig constructor options. It has a parameter method where method.kind is "email" or "phone".')}async promptAndVerify(){var e=await this.get2faMethod(),e=await this.getCode(e);try{return await this.verifyCode(e)}catch(e){if(console.warn("Error validating security code:",e),e.toString().includes("invalid 2fa code provided")||e.toString().includes("2fa code not valid"))return this.promptAndVerify();throw e}}async verifyCodeDefault(e){var t=this["accountId"],r=this.getRequest();if(!r)throw new Error("no request pending");r=r.requestId;return this.postSignedJson("/2fa/verify",{accountId:t,securityCode:e,requestId:r})}async getRecoveryMethods(){var e=this["accountId"];return{accountId:e,data:await this.postSignedJson("/account/recoveryMethods",{accountId:e})}}async get2faMethod(){let e=(await this.getRecoveryMethods())["data"];if(!(e=e&&e.length?e.find(e=>0===e.kind.indexOf("2fa-")):e))return null;var{kind:t,detail:r}=e;return{kind:t,detail:r}}async signatureFor(){var e=this["accountId"];const t=await this.connection.provider.block({finality:"final"});var r=t.header.height.toString(),e=await this.connection.signer.signMessage(Buffer.from(r),e,this.connection.networkId);return{blockNumber:r,blockNumberSignature:Buffer.from(e.signature).toString("base64")}}async postSignedJson(e,t){return o.fetchJson(this.helperUrl+e,JSON.stringify({...t,...await this.signatureFor()}))}};const u=e=>i.PublicKey.from(e),l=(e,f,p)=>e.map(e=>{const t=e.enum,{gas:r,publicKey:n,methodName:o,args:i,deposit:a,accessKey:s,code:c}=e[t],u={type:t[0].toUpperCase()+t.substr(1),gas:r&&r.toString()||void 0,public_key:n&&n.toString().replace("ed25519:","")||void 0,method_name:o,args:i&&Buffer.from(i).toString("base64")||void 0,code:c&&Buffer.from(c).toString("base64")||void 0,amount:a&&a.toString()||void 0,deposit:a&&a.toString()||"0",permission:void 0};if(s&&(p===f&&"fullAccess"!==s.permission.enum&&(u.permission={receiver_id:f,allowance:m.MULTISIG_ALLOWANCE.toString(),method_names:m.MULTISIG_CHANGE_METHODS}),"functionCall"===s.permission.enum)){const{receiverId:l,methodNames:h,allowance:d}=s.permission.functionCall;u.permission={receiver_id:l,allowance:d&&d.toString()||void 0,method_names:h}}return u})}(account_multisig),{});Object.defineProperty(account_creator,"__esModule",{value:!0}),account_creator.UrlAccountCreator=account_creator.LocalAccountCreator=account_creator.AccountCreator=void 0;const web_1=web;class AccountCreator{}account_creator.AccountCreator=AccountCreator;class LocalAccountCreator extends AccountCreator{constructor(e,t){super(),this.masterAccount=e,this.initialBalance=t}async createAccount(e,t){await this.masterAccount.createAccount(e,t,this.initialBalance)}}account_creator.LocalAccountCreator=LocalAccountCreator;class UrlAccountCreator extends AccountCreator{constructor(e,t){super(),this.connection=e,this.helperUrl=t}async createAccount(e,t){await web_1.fetchJson(this.helperUrl+"/account",JSON.stringify({newAccountId:e,newAccountPublicKey:t.toString()}))}}account_creator.UrlAccountCreator=UrlAccountCreator;var connection={},signer={},__importDefault$5=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(signer,"__esModule",{value:!0}),signer.InMemorySigner=signer.Signer=void 0;const js_sha256_1=__importDefault$5(sha256.exports),key_pair_1=key_pair,in_memory_key_store_1=in_memory_key_store;class Signer{}signer.Signer=Signer;class InMemorySigner extends Signer{constructor(e){super(),this.keyStore=e}static async fromKeyPair(e,t,r){const n=new in_memory_key_store_1.InMemoryKeyStore;return await n.setKey(e,t,r),new InMemorySigner(n)}async createKey(e,t){const r=key_pair_1.KeyPair.fromRandom("ed25519");return await this.keyStore.setKey(t,e,r),r.getPublicKey()}async getPublicKey(e,t){const r=await this.keyStore.getKey(t,e);return null===r?null:r.getPublicKey()}async signMessage(e,t,r){e=new Uint8Array(js_sha256_1.default.sha256.array(e));if(!t)throw new Error("InMemorySigner requires provided account id");const n=await this.keyStore.getKey(r,t);if(null===n)throw new Error(`Key for ${t} not found in `+r);return n.sign(e)}toString(){return`InMemorySigner(${this.keyStore})`}}signer.InMemorySigner=InMemorySigner,Object.defineProperty(connection,"__esModule",{value:!0}),connection.Connection=void 0;const providers_1$1=providers,signer_1=signer;function getProvider(e){switch(e.type){case void 0:return e;case"JsonRpcProvider":return new providers_1$1.JsonRpcProvider({...e.args});default:throw new Error("Unknown provider type "+e.type)}}function getSigner(e){switch(e.type){case void 0:return e;case"InMemorySigner":return new signer_1.InMemorySigner(e.keyStore);default:throw new Error("Unknown signer type "+e.type)}}class Connection{constructor(e,t,r){this.networkId=e,this.provider=t,this.signer=r}static fromConfig(e){var t=getProvider(e.provider),r=getSigner(e.signer);return new Connection(e.networkId,t,r)}}connection.Connection=Connection;var contract={},__importDefault$4=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(contract,"__esModule",{value:!0}),contract.Contract=void 0;const bn_js_1$1=__importDefault$4(bn.exports),depd_1$1=__importDefault$4(depd_1$5),providers_1=providers,errors_1=errors;function nameFunction(e,t){return{[e](...e){return t(...e)}}[e]}const isUint8Array=e=>e&&void 0!==e.byteLength&&e.byteLength===e.length,isObject=e=>"[object Object]"===Object.prototype.toString.call(e);class Contract{constructor(e,t,r){this.account=e,this.contractId=t;const{viewMethods:n=[],changeMethods:o=[]}=r;n.forEach(n=>{Object.defineProperty(this,n,{writable:!1,enumerable:!0,value:nameFunction(n,async(e={},t={},...r)=>{if(r.length||!isObject(e)&&!isUint8Array(e)||!isObject(t))throw new errors_1.PositionalArgsError;return this.account.viewFunction(this.contractId,n,e,t)})})}),o.forEach(r=>{Object.defineProperty(this,r,{writable:!1,enumerable:!0,value:nameFunction(r,async(...e)=>{if(e.length&&(3<e.length||!isObject(e[0])&&!isUint8Array(e[0])))throw new errors_1.PositionalArgsError;if(1<e.length||!e[0]||!e[0].args){const t=depd_1$1.default("contract.methodName(args, gas, amount)");return t("use `contract.methodName({ args, gas?, amount?, callbackUrl?, meta? })` instead"),this._changeMethod({methodName:r,args:e[0],gas:e[1],amount:e[2]})}return this._changeMethod({methodName:r,...e[0]})})})})}async _changeMethod({args:e,methodName:t,gas:r,amount:n,meta:o,callbackUrl:i}){validateBNLike({gas:r,amount:n});t=await this.account.functionCall({contractId:this.contractId,methodName:t,args:e,gas:r,attachedDeposit:n,walletMeta:o,walletCallbackUrl:i});return providers_1.getTransactionLastResult(t)}}function validateBNLike(e){for(const r of Object.keys(e)){var t=e[r];if(t&&!bn_js_1$1.default.isBN(t)&&isNaN(t))throw new errors_1.ArgumentTypeError(r,"number, decimal string or BN",t)}}contract.Contract=Contract;var near={},__importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(near,"__esModule",{value:!0}),near.Near=void 0;const bn_js_1=__importDefault$3(bn.exports),account_1$1=account,connection_1=connection,contract_1=contract,account_creator_1=account_creator;class Near{constructor(e){var t;this.config=e,this.connection=connection_1.Connection.fromConfig({networkId:e.networkId,provider:{type:"JsonRpcProvider",args:{url:e.nodeUrl,headers:e.headers}},signer:e.signer||{type:"InMemorySigner",keyStore:e.keyStore||e.deps&&e.deps.keyStore}}),e.masterAccount?(t=e.initialBalance?new bn_js_1.default(e.initialBalance):new bn_js_1.default("500000000000000000000000000"),this.accountCreator=new account_creator_1.LocalAccountCreator(new account_1$1.Account(this.connection,e.masterAccount),t)):e.helperUrl?this.accountCreator=new account_creator_1.UrlAccountCreator(this.connection,e.helperUrl):this.accountCreator=null}async account(e){return new account_1$1.Account(this.connection,e)}async createAccount(e,t){if(this.accountCreator)return await this.accountCreator.createAccount(e,t),new account_1$1.Account(this.connection,e);throw new Error("Must specify account creator, either via masterAccount or helperUrl configuration settings.")}async loadContract(e,t){var r=new account_1$1.Account(this.connection,t.sender);return new contract_1.Contract(r,e,t)}async sendTokens(e,t,r){console.warn("near.sendTokens is deprecated. Use `yourAccount.sendMoney` instead.");const n=new account_1$1.Account(this.connection,t);return(await n.sendMoney(r,e)).transaction_outcome.id}}near.Near=Near;var walletAccount={},__importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(walletAccount,"__esModule",{value:!0}),walletAccount.ConnectedWalletAccount=walletAccount.WalletAccount=walletAccount.WalletConnection=void 0;const depd_1=__importDefault$2(depd_1$5),account_1=account,transaction_1=transaction,utils_1$1=utils,borsh_1=lib$1,borsh_2=lib$1,LOGIN_WALLET_URL_SUFFIX="/login/",MULTISIG_HAS_METHOD="add_request_and_confirm",LOCAL_STORAGE_KEY_SUFFIX="_wallet_auth_key",PENDING_ACCESS_KEY_PREFIX="pending_key";class WalletConnection{constructor(e,t){this._near=e;var r=t+LOCAL_STORAGE_KEY_SUFFIX,n=JSON.parse(window.localStorage.getItem(r));this._networkId=e.config.networkId,this._walletBaseUrl=e.config.walletUrl,t=t||e.config.contractName||"default",this._keyStore=e.connection.signer.keyStore,this._authData=n||{allKeys:[]},this._authDataKey=r,this.isSignedIn()||this._completeSignInWithAccessKey()}isSignedIn(){return!!this._authData.accountId}getAccountId(){return this._authData.accountId||""}async requestSignIn(e={},t,r,n){let o;if("string"==typeof e){const a=depd_1.default("requestSignIn(contractId, title)");a("`title` ignored; use `requestSignIn({ contractId, methodNames, successUrl, failureUrl })` instead"),o={contractId:e,successUrl:r,failureUrl:n}}else o=e;r=new URL(window.location.href);const i=new URL(this._walletBaseUrl+LOGIN_WALLET_URL_SUFFIX);if(i.searchParams.set("success_url",o.successUrl||r.href),i.searchParams.set("failure_url",o.failureUrl||r.href),o.contractId){const s=await this._near.account(o.contractId),c=(await s.state(),i.searchParams.set("contract_id",o.contractId),utils_1$1.KeyPair.fromRandom("ed25519"));i.searchParams.set("public_key",c.getPublicKey().toString()),await this._keyStore.setKey(this._networkId,PENDING_ACCESS_KEY_PREFIX+c.getPublicKey(),c)}o.methodNames&&o.methodNames.forEach(e=>{i.searchParams.append("methodNames",e)}),window.location.assign(i.toString())}async requestSignTransactions(...e){if(Array.isArray(e[0])){const t=depd_1.default("WalletConnection.requestSignTransactions(transactions, callbackUrl, meta)");return t("use `WalletConnection.requestSignTransactions(RequestSignTransactionsOptions)` instead"),this._requestSignTransactions({transactions:e[0],callbackUrl:e[1],meta:e[2]})}return this._requestSignTransactions(e[0])}async _requestSignTransactions({transactions:e,meta:t,callbackUrl:r}){var n=new URL(window.location.href);const o=new URL("sign",this._walletBaseUrl);o.searchParams.set("transactions",e.map(e=>borsh_2.serialize(transaction_1.SCHEMA,e)).map(e=>Buffer.from(e).toString("base64")).join(",")),o.searchParams.set("callbackUrl",r||n.href),t&&o.searchParams.set("meta",t),window.location.assign(o.toString())}async _completeSignInWithAccessKey(){const e=new URL(window.location.href);var t=e.searchParams.get("public_key")||"",r=(e.searchParams.get("all_keys")||"").split(","),n=e.searchParams.get("account_id")||"";n&&(this._authData={accountId:n,allKeys:r},window.localStorage.setItem(this._authDataKey,JSON.stringify(this._authData)),t&&await this._moveKeyFromTempToPermanent(n,t)),e.searchParams.delete("public_key"),e.searchParams.delete("all_keys"),e.searchParams.delete("account_id"),e.searchParams.delete("meta"),e.searchParams.delete("transactionHashes"),window.history.replaceState({},document.title,e.toString())}async _moveKeyFromTempToPermanent(e,t){var r=await this._keyStore.getKey(this._networkId,PENDING_ACCESS_KEY_PREFIX+t);await this._keyStore.setKey(this._networkId,e,r),await this._keyStore.removeKey(this._networkId,PENDING_ACCESS_KEY_PREFIX+t)}signOut(){this._authData={},window.localStorage.removeItem(this._authDataKey)}account(){return this._connectedAccount||(this._connectedAccount=new ConnectedWalletAccount(this,this._near.connection,this._authData.accountId)),this._connectedAccount}}walletAccount.WalletConnection=WalletConnection,walletAccount.WalletAccount=WalletConnection;class ConnectedWalletAccount extends account_1.Account{constructor(e,t,r){super(t,r),this.walletConnection=e}signAndSendTransaction(...e){return"string"==typeof e[0]?this._signAndSendTransaction({receiverId:e[0],actions:e[1]}):this._signAndSendTransaction(e[0])}async _signAndSendTransaction({receiverId:t,actions:r,walletMeta:e,walletCallbackUrl:n=window.location.href}){const o=await this.connection.signer.getPublicKey(this.accountId,this.connection.networkId);let i=await this.accessKeyForTransaction(t,r,o);if(!i)throw new Error("Cannot find matching key for transaction sent to "+t);if(o&&o.toString()===i.public_key)try{return await super.signAndSendTransaction({receiverId:t,actions:r})}catch(e){if("NotEnoughAllowance"!==e.type)throw e;i=await this.accessKeyForTransaction(t,r)}var a=await this.connection.provider.block({finality:"final"}),a=borsh_1.baseDecode(a.header.hash),s=utils_1$1.PublicKey.from(i.public_key),c=i.access_key.nonce+1,s=transaction_1.createTransaction(this.accountId,s,t,c,r,a);return await this.walletConnection.requestSignTransactions({transactions:[s],meta:e,callbackUrl:n}),new Promise((e,t)=>{setTimeout(()=>{t(new Error("Failed to redirect to sign transaction"))},1e3)})}async accessKeyMatchesTransaction(e,t,r){var e=e["access_key"]["permission"];if("FullAccess"===e)return!0;if(e.FunctionCall){const{receiver_id:n,method_names:o}=e.FunctionCall;if(n===this.accountId&&o.includes(MULTISIG_HAS_METHOD))return!0;if(n===t){if(1!==r.length)return!1;const[{functionCall:i}]=r;return i&&(!i.deposit||"0"===i.deposit.toString())&&(0===o.length||o.includes(i.methodName))}}return!1}async accessKeyForTransaction(e,t,r){const n=await this.getAccessKeys();if(r){var o=n.find(e=>e.public_key.toString()===r.toString());if(o&&await this.accessKeyMatchesTransaction(o,e,t))return o}const i=this.walletConnection._authData.allKeys;for(const a of n)if(-1!==i.indexOf(a.public_key)&&await this.accessKeyMatchesTransaction(a,e,t))return a;return null}}walletAccount.ConnectedWalletAccount=ConnectedWalletAccount,!function(e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),o=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},r=(Object.defineProperty(e,"__esModule",{value:!0}),e.WalletConnection=e.WalletAccount=e.ConnectedWalletAccount=e.Near=e.KeyPair=e.Signer=e.InMemorySigner=e.Contract=e.Connection=e.Account=e.multisig=e.validators=e.transactions=e.utils=e.providers=e.accountCreator=void 0,t(providers)),r=(e.providers=r,t(utils)),r=(e.utils=r,t(transaction)),r=(e.transactions=r,t(validators));e.validators=r;const i=account;Object.defineProperty(e,"Account",{enumerable:!0,get:function(){return i.Account}});r=t(account_multisig),e.multisig=r,r=t(account_creator);e.accountCreator=r;const a=connection,s=(Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return a.Connection}}),signer),c=(Object.defineProperty(e,"Signer",{enumerable:!0,get:function(){return s.Signer}}),Object.defineProperty(e,"InMemorySigner",{enumerable:!0,get:function(){return s.InMemorySigner}}),contract),u=(Object.defineProperty(e,"Contract",{enumerable:!0,get:function(){return c.Contract}}),key_pair),l=(Object.defineProperty(e,"KeyPair",{enumerable:!0,get:function(){return u.KeyPair}}),near),h=(Object.defineProperty(e,"Near",{enumerable:!0,get:function(){return l.Near}}),walletAccount);Object.defineProperty(e,"ConnectedWalletAccount",{enumerable:!0,get:function(){return h.ConnectedWalletAccount}}),Object.defineProperty(e,"WalletAccount",{enumerable:!0,get:function(){return h.WalletAccount}}),Object.defineProperty(e,"WalletConnection",{enumerable:!0,get:function(){return h.WalletConnection}})}(commonIndex);var connect$1={},setupNodeFetch={};const Readable=Stream__default.default.Readable,BUFFER=Symbol("buffer"),TYPE=Symbol("type");class Blob{constructor(){this[TYPE]="";var e=arguments[0],t=arguments[1];const r=[];let n=0;if(e){var o=e,i=Number(o.length);for(let t=0;t<i;t++){var a=o[t];let e;e=a instanceof Buffer?a:ArrayBuffer.isView(a)?Buffer.from(a.buffer,a.byteOffset,a.byteLength):a instanceof ArrayBuffer?Buffer.from(a):a instanceof Blob?a[BUFFER]:Buffer.from("string"==typeof a?a:String(a)),n+=e.length,r.push(e)}}this[BUFFER]=Buffer.concat(r);e=t&&void 0!==t.type&&String(t.type).toLowerCase();e&&!/[^\u0020-\u007E]/.test(e)&&(this[TYPE]=e)}get size(){return this[BUFFER].length}get type(){return this[TYPE]}text(){return Promise.resolve(this[BUFFER].toString())}arrayBuffer(){const e=this[BUFFER];var t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){const e=new Readable;return e._read=function(){},e.push(this[BUFFER]),e.push(null),e}toString(){return"[object Blob]"}slice(){var e=this.size,t=arguments[0],r=arguments[1];let n,o;n=void 0===t?0:t<0?Math.max(e+t,0):Math.min(t,e),o=void 0===r?e:r<0?Math.max(e+r,0):Math.min(r,e);t=Math.max(o-n,0);const i=this[BUFFER];r=i.slice(n,n+t);const a=new Blob([],{type:arguments[2]});return a[BUFFER]=r,a}}function FetchError(e,t,r){Error.call(this,e),this.message=e,this.type=t,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(Blob.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(Blob.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),FetchError.prototype=Object.create(Error.prototype),FetchError.prototype.constructor=FetchError,FetchError.prototype.name="FetchError";let convert;try{convert=require("encoding").convert}catch(e){}const INTERNALS=Symbol("Body internals"),PassThrough=Stream__default.default.PassThrough;function Body(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=r.size,n=void 0===n?0:n,r=r.timeout,r=void 0===r?0:r;null==e?e=null:isURLSearchParams(e)?e=Buffer.from(e.toString()):isBlob(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof Stream__default.default||(e=Buffer.from(String(e)))),this[INTERNALS]={body:e,disturbed:!1,error:null},this.size=n,this.timeout=r,e instanceof Stream__default.default&&e.on("error",function(e){e="AbortError"===e.name?e:new FetchError(`Invalid response body while trying to fetch ${t.url}: `+e.message,"system",e);t[INTERNALS].error=e})}function consumeBody(){var n=this;if(this[INTERNALS].disturbed)return Body.Promise.reject(new TypeError("body used already for: "+this.url));if(this[INTERNALS].disturbed=!0,this[INTERNALS].error)return Body.Promise.reject(this[INTERNALS].error);let o=this.body;if(null===o)return Body.Promise.resolve(Buffer.alloc(0));if(isBlob(o)&&(o=o.stream()),Buffer.isBuffer(o))return Body.Promise.resolve(o);if(!(o instanceof Stream__default.default))return Body.Promise.resolve(Buffer.alloc(0));let i=[],a=0,s=!1;return new Body.Promise(function(e,t){let r;n.timeout&&(r=setTimeout(function(){s=!0,t(new FetchError(`Response timeout while trying to fetch ${n.url} (over ${n.timeout}ms)`,"body-timeout"))},n.timeout)),o.on("error",function(e){"AbortError"===e.name?(s=!0,t(e)):t(new FetchError(`Invalid response body while trying to fetch ${n.url}: `+e.message,"system",e))}),o.on("data",function(e){if(!s&&null!==e){if(n.size&&a+e.length>n.size)return s=!0,void t(new FetchError(`content size at ${n.url} over limit: `+n.size,"max-size"));a+=e.length,i.push(e)}}),o.on("end",function(){if(!s){clearTimeout(r);try{e(Buffer.concat(i,a))}catch(e){t(new FetchError(`Could not create Buffer from response body for ${n.url}: `+e.message,"system",e))}}})})}function convertBody(e,t){if("function"!=typeof convert)throw new Error("The package `encoding` must be installed to use the textConverted() function");t=t.get("content-type");let r="utf-8",n,o;return t&&(n=/charset=([^;]*)/i.exec(t)),o=e.slice(0,1024).toString(),!(n=!n&&o?/<meta.+?charset=(['"])(.+?)\1/i.exec(o):n)&&o&&((n=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o))||(n=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o))&&n.pop(),n=n&&/charset=(.*)/i.exec(n.pop())),!(n=!n&&o?/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o):n)||"gb2312"!==(r=n.pop())&&"gbk"!==r||(r="gb18030"),convert(e,"UTF-8",r).toString()}function isURLSearchParams(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function isBlob(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function clone(e){var t,r;let n=e.body;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof Stream__default.default&&"function"!=typeof n.getBoundary&&(t=new PassThrough,r=new PassThrough,n.pipe(t),n.pipe(r),e[INTERNALS].body=t,n=r),n}function extractContentType(e){return null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":isURLSearchParams(e)?"application/x-www-form-urlencoded;charset=UTF-8":isBlob(e)?e.type||null:Buffer.isBuffer(e)||"[object ArrayBuffer]"===Object.prototype.toString.call(e)||ArrayBuffer.isView(e)?null:"function"==typeof e.getBoundary?"multipart/form-data;boundary="+e.getBoundary():e instanceof Stream__default.default?null:"text/plain;charset=UTF-8"}function getTotalBytes(e){const t=e.body;return null===t?0:isBlob(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}function writeToStream(e,t){const r=t.body;null===r?e.end():isBlob(r)?r.stream().pipe(e):Buffer.isBuffer(r)?(e.write(r),e.end()):r.pipe(e)}Body.prototype={get body(){return this[INTERNALS].body},get bodyUsed(){return this[INTERNALS].disturbed},arrayBuffer(){return consumeBody.call(this).then(function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)})},blob(){let t=this.headers&&this.headers.get("content-type")||"";return consumeBody.call(this).then(function(e){return Object.assign(new Blob([],{type:t.toLowerCase()}),{[BUFFER]:e})})},json(){var t=this;return consumeBody.call(this).then(function(e){try{return JSON.parse(e.toString())}catch(e){return Body.Promise.reject(new FetchError(`invalid json response body at ${t.url} reason: `+e.message,"invalid-json"))}})},text(){return consumeBody.call(this).then(function(e){return e.toString()})},buffer(){return consumeBody.call(this)},textConverted(){var t=this;return consumeBody.call(this).then(function(e){return convertBody(e,t.headers)})}},Object.defineProperties(Body.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),Body.mixIn=function(e){for(const r of Object.getOwnPropertyNames(Body.prototype)){var t;r in e||(t=Object.getOwnPropertyDescriptor(Body.prototype,r),Object.defineProperty(e,r,t))}},Body.Promise=global.Promise;const invalidTokenRegex=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,invalidHeaderCharRegex=/[^\t\x20-\x7e\x80-\xff]/;function validateName(e){if(e=""+e,invalidTokenRegex.test(e)||""===e)throw new TypeError(e+" is not a legal HTTP header name")}function validateValue(e){if(e=""+e,invalidHeaderCharRegex.test(e))throw new TypeError(e+" is not a legal HTTP header value")}function find(e,t){t=t.toLowerCase();for(const r in e)if(r.toLowerCase()===t)return r}const MAP=Symbol("map");class Headers{constructor(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;if(this[MAP]=Object.create(null),e instanceof Headers){var t=e.raw();for(const o of Object.keys(t))for(const i of t[o])this.append(o,i)}else if(null!=e){if("object"!=typeof e)throw new TypeError("Provided initializer must be an object");var r=e[Symbol.iterator];if(null!=r){if("function"!=typeof r)throw new TypeError("Header pairs must be iterable");const a=[];for(const s of e){if("object"!=typeof s||"function"!=typeof s[Symbol.iterator])throw new TypeError("Each header pair must be iterable");a.push(Array.from(s))}for(const c of a){if(2!==c.length)throw new TypeError("Each header pair must be a name/value tuple");this.append(c[0],c[1])}}else for(const u of Object.keys(e)){var n=e[u];this.append(u,n)}}}get(e){validateName(e=""+e);e=find(this[MAP],e);return void 0===e?null:this[MAP][e].join(", ")}forEach(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;let r=getHeaders(this),n=0;for(;n<r.length;){var o=r[n],i=o[0],o=o[1];e.call(t,o,i,this),r=getHeaders(this),n++}}set(e,t){t=""+t,validateName(e=""+e),validateValue(t);var r=find(this[MAP],e);this[MAP][void 0!==r?r:e]=[t]}append(e,t){t=""+t,validateName(e=""+e),validateValue(t);var r=find(this[MAP],e);void 0!==r?this[MAP][r].push(t):this[MAP][e]=[t]}has(e){return validateName(e=""+e),void 0!==find(this[MAP],e)}delete(e){validateName(e=""+e);e=find(this[MAP],e);void 0!==e&&delete this[MAP][e]}raw(){return this[MAP]}keys(){return createHeadersIterator(this,"key")}values(){return createHeadersIterator(this,"value")}[Symbol.iterator](){return createHeadersIterator(this,"key+value")}}function getHeaders(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"key+value";const r=Object.keys(t[MAP]).sort();return r.map("key"===e?function(e){return e.toLowerCase()}:"value"===e?function(e){return t[MAP][e].join(", ")}:function(e){return[e.toLowerCase(),t[MAP][e].join(", ")]})}Headers.prototype.entries=Headers.prototype[Symbol.iterator],Object.defineProperty(Headers.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(Headers.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const INTERNAL=Symbol("internal");function createHeadersIterator(e,t){const r=Object.create(HeadersIteratorPrototype);return r[INTERNAL]={target:e,kind:t,index:0},r}const HeadersIteratorPrototype=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==HeadersIteratorPrototype)throw new TypeError("Value of `this` is not a HeadersIterator");var e=this[INTERNAL],t=e.target,r=e.kind,e=e.index,t=getHeaders(t,r);return t.length<=e?{value:void 0,done:!0}:(this[INTERNAL].index=e+1,{value:t[e],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function exportNodeCompatibleHeaders(e){const t=Object.assign({__proto__:null},e[MAP]);e=find(e[MAP],"Host");return void 0!==e&&(t[e]=t[e][0]),t}function createHeadersLenient(e){const t=new Headers;for(const r of Object.keys(e))if(!invalidTokenRegex.test(r))if(Array.isArray(e[r]))for(const n of e[r])invalidHeaderCharRegex.test(n)||(void 0===t[MAP][r]?t[MAP][r]=[n]:t[MAP][r].push(n));else invalidHeaderCharRegex.test(e[r])||(t[MAP][r]=[e[r]]);return t}Object.defineProperty(HeadersIteratorPrototype,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});const INTERNALS$1=Symbol("Response internals"),STATUS_CODES=http__default.default.STATUS_CODES;class Response{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=(Body.call(this,e,t),t.status||200);const n=new Headers(t.headers);null==e||n.has("Content-Type")||(e=extractContentType(e))&&n.append("Content-Type",e),this[INTERNALS$1]={url:t.url,status:r,statusText:t.statusText||STATUS_CODES[r],headers:n,counter:t.counter}}get url(){return this[INTERNALS$1].url||""}get status(){return this[INTERNALS$1].status}get ok(){return 200<=this[INTERNALS$1].status&&this[INTERNALS$1].status<300}get redirected(){return 0<this[INTERNALS$1].counter}get statusText(){return this[INTERNALS$1].statusText}get headers(){return this[INTERNALS$1].headers}clone(){return new Response(clone(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}Body.mixIn(Response.prototype),Object.defineProperties(Response.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(Response.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const INTERNALS$2=Symbol("Request internals"),parse_url=Url__default.default.parse,format_url=Url__default.default.format,streamDestructionSupported="destroy"in Stream__default.default.Readable.prototype;function isRequest(e){return"object"==typeof e&&"object"==typeof e[INTERNALS$2]}function isAbortSignal(e){e=e&&"object"==typeof e&&Object.getPrototypeOf(e);return e&&"AbortSignal"===e.constructor.name}class Request{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};let r,n=(isRequest(e)?r=parse_url(e.url):(r=e&&e.href?parse_url(e.href):parse_url(""+e),e={}),t.method||e.method||"GET");if(n=n.toUpperCase(),(null!=t.body||isRequest(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw new TypeError("Request with GET/HEAD method cannot have body");var o=null!=t.body?t.body:isRequest(e)&&null!==e.body?clone(e):null;Body.call(this,o,{timeout:t.timeout||e.timeout||0,size:t.size||e.size||0});const i=new Headers(t.headers||e.headers||{});null==o||i.has("Content-Type")||(o=extractContentType(o))&&i.append("Content-Type",o);let a=isRequest(e)?e.signal:null;if(null!=(a="signal"in t?t.signal:a)&&!isAbortSignal(a))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[INTERNALS$2]={method:n,redirect:t.redirect||e.redirect||"follow",headers:i,parsedURL:r,signal:a},this.follow=void 0!==t.follow?t.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==t.compress?t.compress:void 0===e.compress||e.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent}get method(){return this[INTERNALS$2].method}get url(){return format_url(this[INTERNALS$2].parsedURL)}get headers(){return this[INTERNALS$2].headers}get redirect(){return this[INTERNALS$2].redirect}get signal(){return this[INTERNALS$2].signal}clone(){return new Request(this)}}function getNodeRequestOptions(e){var t,r=e[INTERNALS$2].parsedURL;const n=new Headers(e[INTERNALS$2].headers);if(n.has("Accept")||n.set("Accept","*/*"),!r.protocol||!r.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(r.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof Stream__default.default.Readable&&!streamDestructionSupported)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let o=null,i=(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(o="0"),null==e.body||"number"==typeof(t=getTotalBytes(e))&&(o=String(t)),o&&n.set("Content-Length",o),n.has("User-Agent")||n.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip,deflate"),e.agent);return"function"==typeof i&&(i=i(r)),n.has("Connection")||i||n.set("Connection","close"),Object.assign({},r,{method:e.method,headers:exportNodeCompatibleHeaders(n),agent:i})}function AbortError(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}Body.mixIn(Request.prototype),Object.defineProperty(Request.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(Request.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),AbortError.prototype=Object.create(Error.prototype),AbortError.prototype.constructor=AbortError,AbortError.prototype.name="AbortError";const PassThrough$1=Stream__default.default.PassThrough,resolve_url=Url__default.default.resolve;function fetch$1(o,i){if(fetch$1.Promise)return Body.Promise=fetch$1.Promise,new fetch$1.Promise(function(l,h){const d=new Request(o,i);var e=getNodeRequestOptions(d);const t=("https:"===e.protocol?https__default:http__default).default.request,f=d.signal;let p=null;const r=function(){var e=new AbortError("The user aborted a request.");h(e),d.body&&d.body instanceof Stream__default.default.Readable&&d.body.destroy(e),p&&p.body&&p.body.emit("error",e)};if(f&&f.aborted)r();else{const y=function(){r(),m()},n=t(e);let u;function m(){n.abort(),f&&f.removeEventListener("abort",y),clearTimeout(u)}f&&f.addEventListener("abort",y),d.timeout&&n.once("socket",function(e){u=setTimeout(function(){h(new FetchError("network timeout at: "+d.url,"request-timeout")),m()},d.timeout)}),n.on("error",function(e){h(new FetchError(`request to ${d.url} failed, reason: `+e.message,"system",e)),m()}),n.on("response",function(e){clearTimeout(u);const t=createHeadersLenient(e.headers);if(fetch$1.isRedirect(e.statusCode)){var r=t.get("Location"),n=null===r?null:resolve_url(d.url,r);switch(d.redirect){case"error":return h(new FetchError("uri requested responds with a redirect, redirect mode is set to error: "+d.url,"no-redirect")),void m();case"manual":if(null!==n)try{t.set("Location",n)}catch(e){h(e)}break;case"follow":if(null===n)break;if(d.counter>=d.follow)return h(new FetchError("maximum redirect reached at: "+d.url,"max-redirect")),void m();const s={headers:new Headers(d.headers),follow:d.follow,counter:d.counter+1,agent:d.agent,compress:d.compress,method:d.method,body:d.body,signal:d.signal,timeout:d.timeout,size:d.size};return 303!==e.statusCode&&d.body&&null===getTotalBytes(d)?(h(new FetchError("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void m()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==d.method)||(s.method="GET",s.body=void 0,s.headers.delete("content-length")),l(fetch$1(new Request(n,s))),void m())}}e.once("end",function(){f&&f.removeEventListener("abort",y)});let o=e.pipe(new PassThrough$1);const i={url:d.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:d.size,timeout:d.timeout,counter:d.counter};r=t.get("Content-Encoding");if(!d.compress||"HEAD"===d.method||null===r||204===e.statusCode||304===e.statusCode)return p=new Response(o,i),void l(p);var a={flush:zlib__default.default.Z_SYNC_FLUSH,finishFlush:zlib__default.default.Z_SYNC_FLUSH};if("gzip"==r||"x-gzip"==r)return o=o.pipe(zlib__default.default.createGunzip(a)),p=new Response(o,i),void l(p);if("deflate"==r||"x-deflate"==r){const c=e.pipe(new PassThrough$1);void c.once("data",function(e){o=8==(15&e[0])?o.pipe(zlib__default.default.createInflate()):o.pipe(zlib__default.default.createInflateRaw()),p=new Response(o,i),l(p)})}else{if("br"==r&&"function"==typeof zlib__default.default.createBrotliDecompress)return o=o.pipe(zlib__default.default.createBrotliDecompress()),p=new Response(o,i),void l(p);p=new Response(o,i),l(p)}}),writeToStream(n,d)}});throw new Error("native promise missing, set fetch.Promise to your favorite alternative")}fetch$1.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},fetch$1.Promise=global.Promise;var lib=Object.freeze({__proto__:null,default:fetch$1,Headers:Headers,Request:Request,Response:Response,FetchError:FetchError}),require$$0=getAugmentedNamespace(lib),__importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(setupNodeFetch,"__esModule",{value:!0});const node_fetch_1=__importDefault$1(require$$0),http_1=__importDefault$1(http__default.default),https_1=__importDefault$1(https__default.default),httpAgent=new http_1.default.Agent({keepAlive:!0}),httpsAgent=new https_1.default.Agent({keepAlive:!0});function agent(e){return"http:"===e.protocol?httpAgent:httpsAgent}function default_1(e,t){return node_fetch_1.default(e,{agent:agent(new URL(e.toString())),...t})}setupNodeFetch.default=default_1;var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(connect$1,"__esModule",{value:!0}),connect$1.connect=void 0;const unencrypted_file_system_keystore_1=unencrypted_file_system_keystore,key_stores_1=key_stores,near_1=near,setup_node_fetch_1=__importDefault(setupNodeFetch),utils_1=utils;async function connect(t){if(t.keyPath&&(t.keyStore||t.deps&&t.deps.keyStore))try{var e=await unencrypted_file_system_keystore_1.readKeyFile(t.keyPath);if(e[0]){const r=e[1],n=new key_stores_1.InMemoryKeyStore;await n.setKey(t.networkId,e[0],r),t.masterAccount||(t.masterAccount=e[0]),t.keyStore=new key_stores_1.MergeKeyStore([n,t.keyStore||t.deps.keyStore],{writeKeyStoreIndex:1}),process.env.NEAR_NO_LOGS||console.log(`Loaded master account ${e[0]} key from ${t.keyPath} with public key = `+r.getPublicKey())}}catch(e){utils_1.logWarning(`Failed to load master account key from ${t.keyPath}: `+e)}return new near_1.Near(t)}commonjsGlobal.fetch=setup_node_fetch_1.default,connect$1.connect=connect,!function(e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),o=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},r=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.keyStores=t(key_stores),r(commonIndex,e),r(connect$1,e),r(constants,e)}(lib$2);var index=getDefaultExportFromCjs(lib$2);return index});